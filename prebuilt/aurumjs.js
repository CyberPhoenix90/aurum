var t=function(){this.subscribeChannel=[],this.onAfterFire=[]},e={subscriptions:{configurable:!0}};e.subscriptions.get=function(){return this.subscribeChannel.length},t.prototype.subscribe=function(t,e){return this.createSubscription(t,this.subscribeChannel,e).facade},t.prototype.hasSubscriptions=function(){return this.subscriptions>0},t.prototype.cancelAll=function(){var t=this;this.isFiring?this.onAfterFire.push(function(){return t.subscribeChannel.length=0}):this.subscribeChannel.length=0},t.prototype.fireFiltered=function(t,e){this.isFiring=!0;for(var o=this.subscribeChannel.length,n=0;n<o;n++)this.subscribeChannel[n].callback!==e&&this.subscribeChannel[n].callback(t);this.isFiring=!1,this.afterFire()},t.prototype.afterFire=function(){this.onAfterFire.length>0&&(this.onAfterFire.forEach(function(t){return t()}),this.onAfterFire.length=0)},t.prototype.fire=function(t){this.isFiring=!0;for(var e=this.subscribeChannel.length,o=0;o<e;o++)this.subscribeChannel[o].callback(t);this.isFiring=!1,this.afterFire()},t.prototype.createSubscription=function(t,e,o){var n=this,r={callback:t},i={cancel:function(){n.cancel(r,e)}};return void 0!==o&&o.addCancelable(function(){return n.cancel(r,e)}),e.push(r),{subscription:r,facade:i}},t.prototype.cancel=function(t,e){var o=this,n=e.indexOf(t);n>=0&&(this.isFiring?this.onAfterFire.push(function(){return o.cancel(t,e)}):e.splice(n,1))},Object.defineProperties(t.prototype,e);var o=function(e){this.value=e,this.updateEvent=new t};o.prototype.update=function(t){if(this.updating)throw new Error("Problem in datas source: Unstable value propagation, when updating a value the stream was updated back as a direct response. This can lead to infinite loops and is therefore not allowed");this.updating=!0,this.value=t,this.updateEvent.fire(t),this.updating=!1},o.prototype.backPropagate=function(t,e){this.value=e,this.updating=!0,this.updateEvent.fireFiltered(e,t),this.updating=!1},o.prototype.listenAndRepeat=function(t,e){return t(this.value),this.listen(t,e)},o.prototype.listen=function(t,e){return this.updateEvent.subscribe(t,e).cancel},o.prototype.filter=function(t,e){var n=new o;return this.listen(function(e){t(e)&&n.update(e)},e),n},o.prototype.filterDuplex=function(t,e){var n=this,r=new o,i=function(e){t(e)&&r.backPropagate(a,e)},a=function(e){t(e)&&n.backPropagate(i,e)};return this.listen(i,e),r.listen(a,e),r},o.prototype.pipe=function(t,e){this.listen(function(e){return t.update(e)},e)},o.prototype.pipeDuplex=function(t,e){var o=this,n=function(e){return t.backPropagate(r,e)},r=function(t){return o.backPropagate(n,t)};this.listen(n,e),t.listen(r,e)},o.prototype.map=function(t,e){var n=new o(t(this.value));return this.listen(function(e){n.update(t(e))},e),n},o.prototype.mapDuplex=function(t,e,n){var r=this,i=new o(t(this.value)),a=function(e){return i.backPropagate(s,t(e))},s=function(t){return r.backPropagate(a,e(t))};return this.listen(a,n),i.listen(s,n),i},o.prototype.unique=function(t){var e=new o(this.value);return this.listen(function(t){t!==e.value&&e.update(t)},t),e},o.prototype.uniqueDuplex=function(t){var e=this,n=new o(this.value),r=function(t){t!==n.value&&n.backPropagate(i,t)},i=function(t){t!==e.value&&e.backPropagate(r,t)};return this.listen(r,t),n.listen(i,t),n},o.prototype.reduce=function(t,e,n){var r=new o(e);return this.listen(function(e){return r.update(t(r.value,e))},n),r},o.prototype.aggregate=function(t,e,n){var r=this,i=new o(e(this.value,t.value));return this.listen(function(){return i.update(e(r.value,t.value))},n),t.listen(function(){return i.update(e(r.value,t.value))},n),i},o.prototype.combine=function(t,e){var n=new o;return this.pipe(n,e),t.pipe(n,e),n},o.prototype.debounce=function(t,e){var n,r=new o;return this.listen(function(e){clearTimeout(n),n=setTimeout(function(){r.update(e)},t)},e),r},o.prototype.buffer=function(t,e){var n,r=new o,i=[];return this.listen(function(e){i.push(e),n||(n=setTimeout(function(){n=void 0,r.update(i),i=[]},t))},e),r},o.prototype.queue=function(t){var e=new n;return this.listen(function(t){e.push(t)},t),e},o.prototype.pick=function(t,e){var n,r=new o(null===(n=this.value)||void 0===n?void 0:n[t]);return this.listen(function(e){r.update(null!=e?e[t]:e)},e),r},o.prototype.cancelAll=function(){this.updateEvent.cancelAll()};var n=function(e){this.data=e?e.slice():[],this.lengthSource=new o(this.data.length).unique(),this.updateEvent=new t},r={length:{configurable:!0}};n.prototype.listenAndRepeat=function(t,e){return t({operation:"add",operationDetailed:"append",index:0,items:this.data,newState:this.data,count:this.data.length}),this.listen(t,e)},n.prototype.listen=function(t,e){return this.updateEvent.subscribe(t,e).cancel},r.length.get=function(){return this.lengthSource},n.prototype.getData=function(){return this.data.slice()},n.prototype.get=function(t){return this.data[t]},n.prototype.set=function(t,e){var o=this.data[t];o!==e&&(this.data[t]=e,this.update({operation:"replace",operationDetailed:"replace",target:o,count:1,index:t,items:[e],newState:this.data}),this.lengthSource.update(this.data.length))},n.prototype.swap=function(t,e){if(t!==e){var o=this.data[t],n=this.data[e];this.data[e]=o,this.data[t]=n,this.update({operation:"swap",operationDetailed:"swap",index:t,index2:e,items:[o,n],newState:this.data}),this.lengthSource.update(this.data.length)}},n.prototype.swapItems=function(t,e){if(t!==e){var o=this.data.indexOf(t),n=this.data.indexOf(e);-1!==o&&-1!==n&&(this.data[n]=t,this.data[o]=e),this.update({operation:"swap",operationDetailed:"swap",index:o,index2:n,items:[t,e],newState:this.data}),this.lengthSource.update(this.data.length)}},n.prototype.appendArray=function(t){var e=this.data;this.data=new Array(e.length);var o=0;for(o=0;o<e.length;o++)this.data[o]=e[o];for(var n=0;n<t.length;n++)this.data[o+n]=t[n];this.update({operation:"add",operationDetailed:"append",count:t.length,index:this.data.length-t.length,items:t,newState:this.data}),this.lengthSource.update(this.data.length)},n.prototype.push=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];this.appendArray(t),this.lengthSource.update(this.data.length)},n.prototype.unshift=function(){for(var t,e=[],o=arguments.length;o--;)e[o]=arguments[o];(t=this.data).unshift.apply(t,e),this.update({operation:"add",operationDetailed:"prepend",count:e.length,items:e,index:0,newState:this.data}),this.lengthSource.update(this.data.length)},n.prototype.pop=function(){var t=this.data.pop();return this.update({operation:"remove",operationDetailed:"removeRight",count:1,index:this.data.length,items:[t],newState:this.data}),this.lengthSource.update(this.data.length),t},n.prototype.merge=function(t){for(var e=0;e<t.length;e++)this.data[e]!==t[e]&&(this.data.length>e?this.set(e,t[e]):this.push(t[e]));this.data.length>t.length&&this.removeRight(this.data.length-t.length),this.lengthSource.update(this.data.length)},n.prototype.removeRight=function(t){var e=this.data.length,o=this.data.splice(e-t,t);this.update({operation:"remove",operationDetailed:"removeRight",count:t,index:e-t,items:o,newState:this.data}),this.lengthSource.update(this.data.length)},n.prototype.removeLeft=function(t){var e=this.data.splice(0,t);this.update({operation:"remove",operationDetailed:"removeLeft",count:t,index:0,items:e,newState:this.data}),this.lengthSource.update(this.data.length)},n.prototype.remove=function(t){var e=this.data.indexOf(t);-1!==e&&(this.data.splice(e,1),this.update({operation:"remove",operationDetailed:"remove",count:1,index:e,items:[t],newState:this.data}),this.lengthSource.update(this.data.length))},n.prototype.clear=function(){var t=this.data;this.data=[],this.update({operation:"remove",operationDetailed:"clear",count:t.length,index:0,items:t,newState:this.data}),this.lengthSource.update(this.data.length)},n.prototype.shift=function(){var t=this.data.shift();return this.update({operation:"remove",operationDetailed:"removeLeft",items:[t],count:1,index:0,newState:this.data}),this.lengthSource.update(this.data.length),t},n.prototype.toArray=function(){return this.data.slice()},n.prototype.sort=function(t,e){return new a(this,t,e)},n.prototype.map=function(t,e){return new i(this,t,e)},n.prototype.filter=function(t,e){return new s(this,t,e)},n.prototype.forEach=function(t,e){return this.data.forEach(t,e)},n.prototype.toDataSource=function(){var t=new o(this.data);return this.listen(function(e){t.update(e.newState)}),t},n.prototype.update=function(t){this.updateEvent.fire(t)},Object.defineProperties(n.prototype,r);var i=function(t){function e(e,o,n){var r=this,i=e.getData().map(o);t.call(this,i),this.mapper=o,e.listen(function(t){var e;switch(t.operationDetailed){case"removeLeft":r.removeLeft(t.count);break;case"removeRight":r.removeRight(t.count);break;case"remove":r.remove(r.data[t.index]);break;case"clear":r.clear();break;case"prepend":(e=r).unshift.apply(e,t.items.map(r.mapper));break;case"append":r.appendArray(t.items.map(r.mapper));break;case"swap":r.swap(t.index,t.index2);break;case"replace":r.set(t.index,r.mapper(t.items[0]))}},n)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(n),a=function(t){function e(e,o,n){var r=this,i=e.getData().sort(o);t.call(this,i),this.comparator=o,e.listen(function(t){var e,o;switch(t.operationDetailed){case"removeLeft":r.removeLeft(t.count);break;case"removeRight":r.removeRight(t.count);break;case"remove":r.remove(t.items[0]);break;case"clear":r.data.length=0;break;case"prepend":(e=r).unshift.apply(e,t.items),r.data.sort(r.comparator);break;case"append":(o=r).push.apply(o,t.items),r.data.sort(r.comparator);break;case"swap":break;case"replace":r.set(t.index,t.items[0]),r.data.sort(r.comparator)}},n)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(n),s=function(t){function e(e,o,n){var r=this;Array.isArray(e)&&(e=new t(e));var i=e.data.filter(o=null!=o?o:function(){return!0});t.call(this,i),this.parent=e,this.viewFilter=o,e.listen(function(t){var e,o,n;switch(t.operationDetailed){case"clear":r.clear();break;case"removeLeft":case"removeRight":case"remove":for(var i=0,a=t.items;i<a.length;i+=1)r.remove(a[i]);break;case"prepend":n=t.items.filter(r.viewFilter),(e=r).unshift.apply(e,n);break;case"append":n=t.items.filter(r.viewFilter),(o=r).push.apply(o,n);break;case"swap":var s=r.data.indexOf(t.items[0]),c=r.data.indexOf(t.items[1]);-1!==s&&-1!==c&&r.swap(s,c);break;case"replace":var p=r.data.indexOf(t.target);-1!==p&&(r.viewFilter(t.items[0])?r.set(p,t.items[0]):r.remove(t.target))}},n)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.updateFilter=function(t){if(this.viewFilter!==t)return this.viewFilter=t,this.refresh(),this.data.length},e.prototype.refresh=function(){var t;this.clear();var e=this.parent.data.filter(this.viewFilter);(t=this).push.apply(t,e)},e}(n),c=function(t){this.data=t};c.prototype.deleteNext=function(){if(this.next){var t=this.next.next;this.next.next=void 0,this.next.previous=void 0,this.next=t,this.next&&(this.next.previous=this)}},c.prototype.deletePrevious=function(){if(this.previous){var t=this.previous.previous;this.previous.next=void 0,this.previous.previous=void 0,this.previous=t,this.previous&&(this.previous.next=this)}};var p=function(t){var e=this;void 0===t&&(t=[]),this.length=0,t.forEach(function(t){return e.append(t)})};p.prototype.find=function(t){for(var e=this.rootNode;e&&!t(e);)e=e.next;return e},p.prototype.append=function(t){return this.rootNode||this.lastNode?(this.lastNode.next=new c(t),this.lastNode.next.previous=this.lastNode,this.lastNode=this.lastNode.next):this.rootNode=this.lastNode=new c(t),this.length++,t},p.prototype.forEach=function(t){this.find(function(e){return t(e.data),!1})},p.prototype.prepend=function(t){return this.rootNode||this.lastNode?(this.rootNode.previous=new c(t),this.rootNode.previous.next=this.rootNode,this.rootNode=this.rootNode.previous):this.rootNode=this.lastNode=new c(t),this.length++,t},p.prototype.remove=function(t){if(t===this.rootNode.data)this.rootNode=this.rootNode===this.lastNode?this.lastNode=void 0:this.rootNode.next,this.length--;else{var e=this.find(function(e){return e.next&&e.next.data===t});e&&(e.next===this.lastNode&&(this.lastNode=e),e.deleteNext(),this.length--)}};var u=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];this.cancelables=new p(t),this._isCancelled=!1},l={isCanceled:{configurable:!0}};l.isCanceled.get=function(){return this._isCancelled},u.prototype.addCancelable=function(t){return this.throwIfCancelled("attempting to add cancellable to token that is already cancelled"),this.cancelables.append(t),this.cancelables.length>200&&console.log("potential memory leak: cancellation token has over 200 clean up calls"),this},u.prototype.removeCancelable=function(t){return this.throwIfCancelled("attempting to remove cancellable from token that is already cancelled"),this.cancelables.remove(t),this},u.prototype.addDisposable=function(t){return this.addCancelable(function(){return t.dispose()}),this},u.prototype.callIfNotCancelled=function(t){this.isCanceled||t()},u.prototype.setTimeout=function(t,e){var o=this;void 0===e&&(e=0);var n=setTimeout(function(){o.removeCancelable(r),t()},e),r=function(){return clearTimeout(n)};this.addCancelable(r)},u.prototype.setInterval=function(t,e){var o=setInterval(t,e);this.addCancelable(function(){return clearInterval(o)})},u.prototype.requestAnimationFrame=function(t){var e=requestAnimationFrame(t);this.addCancelable(function(){return cancelAnimationFrame(e)})},u.prototype.animationLoop=function(t){var e=requestAnimationFrame(function o(n){t(n),e=requestAnimationFrame(o)});this.addCancelable(function(){return cancelAnimationFrame(e)})},u.prototype.throwIfCancelled=function(t){if(this.isCanceled)throw new Error(t||"cancellation token is cancelled")},u.prototype.chain=function(t,e){return void 0===e&&(e=!1),e&&t.chain(this,!1),this.addCancelable(function(){return t.cancel()}),this},u.prototype.registerDomEvent=function(t,e,o){return t.addEventListener(e,o),this.addCancelable(function(){return t.removeEventListener(e,o)}),this},u.prototype.cancel=function(){this.isCanceled||(this._isCancelled=!0,this.cancelables.forEach(function(t){return t()}),this.cancelables=void 0)},Object.defineProperties(u.prototype,l);var h=Symbol("owner"),d=function(t){var e=this;this.node=this.create(t),t instanceof o&&(this.subscription=t.listen(function(t){e.node&&(e.node.textContent=t)}))};d.prototype.resolveStringSource=function(t){return"string"==typeof t?t:t.value},d.prototype.create=function(t){var e=document.createTextNode(this.resolveStringSource(t));return e[h]=this,e},d.prototype.remove=function(){this.hasParent()&&this.node.parentElement[h].removeChild(this.node)},d.prototype.hasParent=function(){return!!this.node.parentElement},d.prototype.dispose=function(){var t;null===(t=this.subscription)||void 0===t||t.call(this),delete this.node[h],delete this.node};var f={drag:"onDrag",dragstart:"onDragStart",dragend:"onDragEnd",dragexit:"onDragExit",dragover:"onDragOver",dragenter:"onDragEnter",dragleave:"onDragLeave",blur:"onBlur",focus:"onFocus",click:"onClick",dblclick:"onDblClick",keydown:"onKeyDown",keyhit:"onKeyHit",keyup:"onKeyUp",mousedown:"onMouseDown",mouseup:"onMouseUp",mousemove:"onMouseMove",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel"},y=["id","name","draggable","tabindex","style","role","contentEditable"],v=function(t,e,o){var n,r;this.cancellationToken=new u,this.node=this.create(o),this.children=[],null!==t&&(this.onDispose=t.onDispose,t.onAttach&&(this.onAttach=t.onAttach,this.needAttach=!0),this.onDetach=t.onDetach,this.template=t.template,this.initialize(t),null===(r=(n=t).onCreate)||void 0===r||r.call(n,this)),e&&this.addChildren(e)};v.prototype.initialize=function(t){this.createEventHandlers(f,t);var e=Object.keys(t).filter(function(t){return t.includes("-")});this.bindProps(y,t,e),t.class&&this.handleClass(t.class)},v.prototype.bindProps=function(t,e,o){for(var n=0,r=t;n<r.length;n+=1){var i=r[n];e[i]&&this.assignStringSourceToAttribute(e[i],i)}if(o)for(var a=0,s=o;a<s.length;a+=1){var c=s[a];e[c]&&this.assignStringSourceToAttribute(e[c],c)}},v.prototype.createEventHandlers=function(t,e){var n=this,r=function(r){e[t[r]]&&(e[t[r]]instanceof o?n.node.addEventListener(r,function(o){return e[t[r]].update(o)}):"function"==typeof e[t[r]]&&n.node.addEventListener(r,function(o){return e[t[r]](o)}))};for(var i in t)r(i)},v.prototype.render=function(){if(!this.cancellationToken.isCanceled){for(var t=0,e=0;e<this.children.length;e++,t++)if(this.children[e]instanceof b){for(var o=this.children[e],n=0;n<o.children.length;n++,t++)this.renderChild(o.children[n],t);t--}else this.renderChild(this.children[e],t);for(;this.node.childNodes.length>t;){var r=this.node.childNodes[this.node.childNodes.length-1];this.node.removeChild(r),r[h].dispose()}}},v.prototype.renderChild=function(t,e){if(this.node.childNodes.length<=e)return this.addChildDom(t);if(this.node.childNodes[e][h]!==t){var o=this.getChildIndex(t.node);-1!==o?this.swapChildrenDom(e,o):this.addDomNodeAt(t.node,e)}},v.prototype.assignStringSourceToAttribute=function(t,e){var o=this;"string"==typeof t?this.node.setAttribute(e,t):(t.value&&this.node.setAttribute(e,t.value),t.unique(this.cancellationToken).listen(function(t){return o.node.setAttribute(e,t)},this.cancellationToken))},v.prototype.handleAttach=function(t){var e,o,n,r;if(this.needAttach)if(t.isConnected()){null===(e=this.onAttach)||void 0===e||e.call(this,this);for(var i=0,a=this.node.childNodes;i<a.length;i+=1)null===(r=null===(o=a[i][h])||void 0===o?void 0:(n=o).handleAttach)||void 0===r||r.call(n,this)}else t.needAttach=!0},v.prototype.handleDetach=function(){var t,e,o;if(!this.node.isConnected){null===(t=this.onDetach)||void 0===t||t.call(this,this);for(var n=0,r=this.node.childNodes;n<r.length;n+=1){var i=r[n];i[h]&&(null===(o=(e=i[h]).handleDetach)||void 0===o||o.call(e))}}},v.prototype.handleClass=function(t){var e=this;if("string"==typeof t)this.node.className=t;else if(t instanceof o)t.value&&(Array.isArray(t.value)?(this.node.className=t.value.join(" "),t.unique(this.cancellationToken).listen(function(){e.node.className=t.value.join(" ")},this.cancellationToken)):(this.node.className=t.value,t.unique(this.cancellationToken).listen(function(){e.node.className=t.value},this.cancellationToken))),t.unique(this.cancellationToken).listen(function(t){return e.node.className=t},this.cancellationToken);else{var n=t.reduce(function(t,e){return"string"==typeof e?t+" "+e:e.value?t+" "+e.value:t},"");this.node.className=n;for(var r=0,i=t;r<i.length;r+=1){var a=i[r];a instanceof o&&a.unique(this.cancellationToken).listen(function(o){var n=t.reduce(function(t,e){return"string"==typeof e?t+" "+e:e.value?t+" "+e.value:t},"");e.node.className=n},this.cancellationToken)}}},v.prototype.resolveStringSource=function(t){return"string"==typeof t?t:t.value},v.prototype.create=function(t){var e=document.createElement(t);return e[h]=this,e},v.prototype.getChildIndex=function(t){for(var e=0,o=0,n=this.node.childNodes;o<n.length;o+=1){if(n[o]===t)return e;e++}return-1},v.prototype.hasChild=function(t){for(var e=0,o=t.children;e<o.length;e+=1)if(o[e]===t)return!0;return!1},v.prototype.addChildDom=function(t){var e,o;this.node.appendChild(t.node),null===(o=(e=t).handleAttach)||void 0===o||o.call(e,this)},v.prototype.swapChildrenDom=function(t,e){if(t!==e){var o=this.node.children[t],n=this.node.children[e];o.remove(),n.remove(),t<e?(this.addDomNodeAt(n,t),this.addDomNodeAt(o,e)):(this.addDomNodeAt(o,e),this.addDomNodeAt(n,t))}},v.prototype.addDomNodeAt=function(t,e){var o,n,r,i;e>=this.node.childElementCount?(this.node.appendChild(t),null===(n=(o=t[h]).handleAttach)||void 0===n||n.call(o,this)):(this.node.insertBefore(t,this.node.children[e]),null===(i=(r=t[h]).handleAttach)||void 0===i||i.call(r,this))},v.prototype.remove=function(){this.hasParent()&&this.node.parentElement[h].removeChild(this.node)},v.prototype.hasParent=function(){return!!this.node.parentElement},v.prototype.isConnected=function(){return this.node.isConnected},v.prototype.removeChild=function(t){var e=this.children.indexOf(t);-1!==e&&this.children.splice(e,1),this.render()},v.prototype.removeChildAt=function(t){this.children.splice(t,1),this.render()},v.prototype.swapChildren=function(t,e){if(t!==e){var o=this.children[t];this.children[t]=this.children[e],this.children[e]=o,this.render()}},v.prototype.clearChildren=function(){this.children.length=0,this.render()},v.prototype.addChild=function(t){t instanceof _||(this.children.push(this.childNodeToAurum(t)),this.render())},v.prototype.childNodeToAurum=function(t){var e=this;if(t instanceof n){var r=new b({repeatModel:t});return r.onChange.subscribe(function(){return e.render()},this.cancellationToken),r}return"string"==typeof t||t instanceof o?t=new d(t):t instanceof v||(t=new d(t.toString())),t},v.prototype.addChildAt=function(t,e){t instanceof _||(this.children.splice(e,0,this.childNodeToAurum(t)),this.render())},v.prototype.addChildren=function(t){if(0!==t.length)for(var e=0,o=t;e<o.length;e+=1)this.addChild(o[e])},v.prototype.dispose=function(){this.internalDispose(!0)},v.prototype.internalDispose=function(t){var e;if(!this.cancellationToken.isCanceled){this.cancellationToken.cancel(),t&&this.remove();for(var o=0,n=this.node.childNodes;o<n.length;o+=1){var r=n[o];r[h]&&r[h].dispose(!1)}delete this.node[h],delete this.node,null===(e=this.onDispose)||void 0===e||e.call(this,this)}};var _=function(t){function e(e,o){t.call(this,e,o,"template"),this.ref=e.ref,this.generate=e.generator}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),b=function(e){this.onChange=new t,this.children=[],e.repeatModel&&this.handleRepeat(e.repeatModel)};b.prototype.handleRepeat=function(t){var e=this;t.listenAndRepeat(function(t){var o;switch(t.operationDetailed){case"swap":var n=e.children[t.index2];e.children[t.index2]=e.children[t.index],e.children[t.index]=n;break;case"append":e.children=e.children.concat(t.items);break;case"prepend":(o=e.children).unshift.apply(o,t.items);break;case"remove":case"removeLeft":case"removeRight":e.children.splice(t.index,t.count);break;case"clear":e.children=[];break;default:throw new Error("unhandled operation")}e.onChange.fire()})};var m=function(t){function e(e,o){t.call(this,e,o,"a"),null!==e&&this.bindProps(["href","target"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),g=function(t){function e(e,o){t.call(this,e,o,"abbr")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),x=function(t){function e(e,o){t.call(this,e,o,"area")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),w=function(t){function e(e,o){t.call(this,e,o,"article")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),O=function(t){function e(e,o){t.call(this,e,o,"aside")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),S=function(t){function e(e,o){t.call(this,e,o,"audio"),null!==e&&this.bindProps(["controls","autoplay","loop","muted","preload","src"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),C=function(t){function e(e,o){t.call(this,e,o,"b")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),j=function(t){function e(e,o){t.call(this,e,o,"br")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),k=function(t){function e(e,o){t.call(this,e,o,"button"),null!==e&&this.bindProps(["disabled"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),A=function(t){function e(e,o){t.call(this,e,o,"canvas"),null!==e&&this.bindProps(["width","height"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),D=function(t){function e(e,o){t.call(this,e,o,"data"),null!==e&&this.bindProps(["datalue"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),N=function(t){function e(e,o){t.call(this,e,o,"details")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),E=function(t){function e(e,o){t.call(this,e,o,"div")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),T=function(t){function e(e,o){t.call(this,e,o,"em")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),P=function(t){function e(e,o){t.call(this,e,o,"footer")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),F=function(t){function e(e,o){t.call(this,e,o,"form")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),I=function(t){function e(e,o){t.call(this,e,o,"h1")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),L=function(t){function e(e,o){t.call(this,e,o,"h2")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),V=function(t){function e(e,o){t.call(this,e,o,"h3")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),M=function(t){function e(e,o){t.call(this,e,o,"h4")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),R=function(t){function e(e,o){t.call(this,e,o,"h5")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),q=function(t){function e(e,o){t.call(this,e,o,"h6")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),H=function(t){function e(e,o){t.call(this,e,o,"header")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),K=function(t){function e(e,o){t.call(this,e,o,"heading")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),B=function(t){function e(e,o){t.call(this,e,o,"i")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),z=function(t){function e(e,o){t.call(this,e,o,"iframe"),null!==e&&this.bindProps(["src","srcdoc","width","height","allow","allowFullscreen","allowPaymentRequest"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),U=function(t){function e(e,o){t.call(this,e,o,"img"),null!==e&&this.bindProps(["src","alt","width","height","referrerPolicy","sizes","srcset","useMap"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),Q={input:"onInput",change:"onChange"},W=["placeholder","readonly","disabled","accept","alt","autocomplete","autofocus","checked","defaultChecked","formAction","formEnctype","formMethod","formNoValidate","formTarget","max","maxLength","min","minLength","pattern","multiple","required","type"],G=function(t){function e(e,o){var n,r=this;t.call(this,e,o,"input"),null!==e&&(e.inputValueSource?e.inputValueSource.unique().listenAndRepeat(function(t){return r.node.value=t},this.cancellationToken):this.node.value=null!=(n=e.initialValue)?n:"",this.bindProps(W,e),this.createEventHandlers(Q,e),e.inputValueSource&&this.node.addEventListener("input",function(){e.inputValueSource.update(r.node.value)}))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),J=function(t){function e(e,o){t.call(this,e,o,"label"),null!==e&&this.bindProps(["for"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),X=function(t){function e(e,o){t.call(this,e,o,"li")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),Y=function(t){function e(e,o){t.call(this,e,o,"link"),null!==e&&this.bindProps(["href","rel","media","as","disabled","type"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),Z=function(t){function e(e,o){t.call(this,e,o,"nav")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),$=function(t){function e(e,o){t.call(this,e,o,"noscript")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),tt=function(t){function e(e,o){t.call(this,e,o,"ol")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),et=function(t){function e(e,o){t.call(this,e,o,"option")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),ot=function(t){function e(e,o){t.call(this,e,o,"p")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),nt=function(t){function e(e,o){t.call(this,e,o,"pre")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),rt=function(t){function e(e,o){t.call(this,e,o,"progress"),null!==e&&this.bindProps(["max","value"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),it=function(t){function e(e,o){t.call(this,e,o,"q")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),at=function(t){function e(e,o){t.call(this,e,o,"script"),null!==e&&this.bindProps(["src","async","defer","integrity","noModule","type"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),st={change:"onChange"},ct=function(t){function e(e,o){var n,r=this;t.call(this,e,o,"select"),null!==e&&(this.createEventHandlers(st,e),this.initialSelection=e.initialSelection,e.selectedIndexSource?(this.selectedIndexSource=e.selectedIndexSource,e.selectedIndexSource.unique().listenAndRepeat(function(t){return r.node.selectedIndex=t},this.cancellationToken)):this.node.selectedIndex=null!=(n=e.initialSelection)?n:-1,e.selectedIndexSource&&(this.needAttach=!0,this.node.addEventListener("change",function(){e.selectedIndexSource.update(r.node.selectedIndex)})))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.handleAttach=function(e){t.prototype.handleAttach.call(this,e),this.node.isConnected&&(this.selectedIndexSource?this.node.selectedIndex=this.selectedIndexSource.value:void 0!==this.initialSelection&&(this.node.selectedIndex=this.initialSelection))},e}(v),pt=function(t){function e(e,o){t.call(this,e,o,"source"),null!==e&&this.bindProps(["src","srcSet","media","sizes","type"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),ut=function(t){function e(e,o){t.call(this,e,o,"span")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),lt=function(t){function e(e,o){t.call(this,e,o,"style"),null!==e&&this.bindProps(["media"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),ht=function(t){function e(e,o){t.call(this,e,o,"sub")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),dt=function(t){function e(e,o){t.call(this,e,o,"summary")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),ft=function(t){function e(e,o){t.call(this,e,o,"sup")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),yt=function(t){function e(e,o){t.call(this,e,o,"svg"),null!==e&&this.bindProps(["width","height"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),vt=function(t){function e(e,o){t.call(this,e,o,"table")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),_t=function(t){function e(e,o){t.call(this,e,o,"tbody")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),bt=function(t){function e(e,o){t.call(this,e,o,"td")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),mt={input:"onInput",change:"onChange"},gt=["placeholder","readonly","disabled","rows","wrap","autocomplete","autofocus","max","maxLength","min","minLength","required","type"],xt=function(t){function e(e,o){var n,r,i,a=this;t.call(this,e,o,"textArea"),null!==e&&(e.inputValueSource?(this.node.value=null!=(r=null!=(n=e.initialValue)?n:e.inputValueSource.value)?r:"",e.inputValueSource.unique().listen(function(t){return a.node.value=t},this.cancellationToken)):this.node.value=null!=(i=e.initialValue)?i:"",this.bindProps(gt,e),this.createEventHandlers(mt,e),e.inputValueSource&&this.node.addEventListener("input",function(){e.inputValueSource.update(a.node.value)}))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),wt=function(t){function e(e,o){t.call(this,e,o,"tfoot")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),Ot=function(t){function e(e,o){t.call(this,e,o,"th")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),St=function(t){function e(e,o){t.call(this,e,o,"thead")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),Ct=function(t){function e(e,o){t.call(this,e,o,"time"),null!==e&&this.bindProps(["datetime"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),jt=function(t){function e(e,o){t.call(this,e,o,"title")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),kt=function(t){function e(e,o){t.call(this,e,o,"tr")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),At=function(t){function e(e,o){t.call(this,e,o,"ul")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),Dt=function(t){function e(e,o){t.call(this,e,o,"video"),null!==e&&this.bindProps(["controls","autoplay","loop","muted","preload","src","poster","width","height"],e)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),Nt=function(t){function e(e,o){t.call(this,e,o,"body")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),Et=function(t){function e(e,o){t.call(this,e,o,"head")}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),Tt=function(e){e&&(this.data=e),this.updateEvent=new t,this.updateEventOnKey=new Map};Tt.prototype.pick=function(t,e){var n,r=new o(null===(n=this.data)||void 0===n?void 0:n[t]);return this.listenOnKey(t,function(t){r.update(t.newValue)},e),r},Tt.prototype.listen=function(t,e){return this.updateEvent.subscribe(t,e).cancel},Tt.prototype.listenOnKeyAndRepeat=function(t,e,o){return e({key:t,newValue:this.data[t],oldValue:void 0}),this.listenOnKey(t,e,o)},Tt.prototype.listenOnKey=function(e,o,n){return this.updateEventOnKey.has(e)||this.updateEventOnKey.set(e,new t),this.updateEventOnKey.get(e).subscribe(o,n).cancel},Tt.prototype.get=function(t){return this.data[t]},Tt.prototype.set=function(t,e){if(this.data[t]!==e){var o=this.data[t];this.data[t]=e,this.updateEvent.fire({oldValue:o,key:t,newValue:this.data[t]}),this.updateEventOnKey.has(t)&&this.updateEventOnKey.get(t).fire({oldValue:o,key:t,newValue:this.data[t]})}},Tt.prototype.assign=function(t){for(var e=0,o=Object.keys(t);e<o.length;e+=1){var n=o[e];this.set(n,t[n])}},Tt.prototype.toObject=function(){return Object.assign({},this.data)},Tt.prototype.toDataSource=function(){var t=this,e=new o(this.data);return this.listen(function(o){e.update(t.data)}),e};var Pt={button:k,div:E,input:G,li:X,span:ut,style:lt,ul:At,p:ot,img:U,link:Y,canvas:A,a:m,article:w,br:j,form:F,label:J,ol:tt,pre:nt,progress:rt,table:vt,td:bt,tr:kt,th:Ot,textarea:xt,h1:I,h2:L,h3:V,h4:M,h5:R,h6:q,header:H,footer:P,nav:Z,b:C,i:B,script:at,abbr:g,area:x,aside:O,audio:S,em:T,heading:K,iframe:z,noscript:$,option:et,q:it,select:ct,source:pt,title:jt,video:Dt,tbody:_t,tfoot:wt,thead:St,summary:dt,details:N,sub:ht,sup:ft,svg:yt,data:D,time:Ct,template:_},Ft=function(){};Ft.attach=function(t,e){if(e[h])throw new Error("This node is already managed by aurum and cannot be used");e.appendChild(t.node),t.handleAttach(t),e[h]=t},Ft.isAttached=function(t){return void 0!==t[h]},Ft.detach=function(t){t[h]&&(t[h].node.remove(),t[h].handleDetach(),t[h].dispose(),t[h]=void 0)},Ft.factory=function(t,e){for(var o,n,r=[],i=arguments.length-2;i-- >0;)r[i]=arguments[i+2];if("string"==typeof t){var a=t;if(void 0===(t=Pt[t]))throw new Error("Node "+a+" does not exist or is not supported")}for(var s,c={},p=!1,u=0,l=n=r.length&&Array.isArray(r[0])?(o=[]).concat.apply(o,r).filter(function(t){return t}):r.filter(function(t){return t});u<l.length;u+=1){var h=l[u];"string"!=typeof h&&(h instanceof _&&(void 0===h.ref||"default"===h.ref)&&(s=h),void 0!==h.ref&&(c[h.ref]=h,p=!0))}return s&&((e=null!=e?e:{}).template=s),p&&((e=null!=e?e:{}).templateMap=c),t.prototype?new t(e,n):t(e,n)};var It=function(t){function e(e,o){t.call(this,e,o,e.tag),e.attributes&&null!==e&&this.bindProps(Object.keys(e.attributes),e.attributes)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v),Lt=function(t){function e(e,o){var n=this;t.call(this,e,o,"switch"),this.firstRender=!0,this.templateMap=e.templateMap,this.renderSwitch(e.state.value),e.state.listen(function(t){n.renderSwitch(t)},this.cancellationToken)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.selectTemplate=function(t){var e;return null==t?this.template:null!=(e=this.templateMap[t])?e:this.template},e.prototype.renderSwitch=function(t){var e;if(t!==this.lastValue||this.firstRender){this.lastValue=t,this.firstRender=!1;var o=this.selectTemplate(null===(e=t)||void 0===e?void 0:e.toString());if(o!==this.lastTemplate&&(this.lastTemplate=o,this.clearChildren(),o)){var n=o.generate();this.addChild(n)}}},e}(v),Vt=function(t){function e(e,n){var r=new o(location.hash.substring(1));t.call(this,Object.assign(Object.assign({},e),{state:r}),n),window.addEventListener("hashchange",function(){var t=location.hash.substring(1);t.includes("?")?r.update(t.substring(0,t.indexOf("?"))):r.update(t)})}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.selectTemplate=function(t){if(null==t)return this.template;if(this.templateMap[t])return this.templateMap[t];var e=t.split("/");for(e.pop();e.length;){var o=e.join("/");if(this.templateMap[o])return this.templateMap[o];e.pop()}return this.template},e}(Lt),Mt=function(t){function e(e,o){var n=this;t.call(this,e,o,"suspense"),e.loader().then(function(t){n.clearChildren(),n.addChild(t)})}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(v);exports.A=m,exports.Abbr=g,exports.Area=x,exports.Article=w,exports.Aside=O,exports.Audio=S,exports.AurumElement=v,exports.Template=_,exports.AurumFragment=b,exports.B=C,exports.Br=j,exports.Button=k,exports.Canvas=A,exports.Data=D,exports.Details=N,exports.Div=E,exports.Em=T,exports.Footer=P,exports.Form=F,exports.H1=I,exports.H2=L,exports.H3=V,exports.H4=M,exports.H5=R,exports.H6=q,exports.Header=H,exports.Heading=K,exports.I=B,exports.IFrame=z,exports.Img=U,exports.Input=G,exports.Label=J,exports.Li=X,exports.Link=Y,exports.Nav=Z,exports.NoScript=$,exports.Ol=tt,exports.Option=et,exports.P=ot,exports.Pre=nt,exports.Progress=rt,exports.Q=it,exports.Script=at,exports.Select=ct,exports.Source=pt,exports.Span=ut,exports.Style=lt,exports.Sub=ht,exports.Summary=dt,exports.Sup=ft,exports.Svg=yt,exports.Table=vt,exports.Tbody=_t,exports.Td=bt,exports.TextArea=xt,exports.Tfoot=wt,exports.Th=Ot,exports.Thead=St,exports.Time=Ct,exports.Title=jt,exports.Tr=kt,exports.Ul=At,exports.Video=Dt,exports.Body=Nt,exports.Head=Et,exports.DataSource=o,exports.ArrayDataSource=n,exports.MappedArrayView=i,exports.SortedArrayView=a,exports.FilteredArrayView=s,exports.ObjectDataSource=Tt,exports.Aurum=Ft,exports.CancellationToken=u,exports.Custom=It,exports.AurumRouter=Vt,exports.Suspense=Mt,exports.Switch=Lt;
//# sourceMappingURL=aurumjs.js.map
