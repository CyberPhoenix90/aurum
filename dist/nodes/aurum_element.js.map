{"version":3,"file":"aurum_element.js","sourceRoot":"src/","sources":["nodes/aurum_element.ts"],"names":[],"mappings":"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","sourcesContent":["import { DataSource } from '../stream/data_source';\nimport { CancellationToken } from '../utilities/cancellation_token';\nimport { DataDrain } from '../utilities/common';\nimport { ArrayDataSource } from '../stream/array_data_source';\n\nexport type StringSource = string | DataSource<string>;\nexport type ClassType = string | DataSource<string> | DataSource<string[]> | Array<string | DataSource<string>>;\n\nexport interface AurumElementProps {\n\tid?: StringSource;\n\tclass?: ClassType;\n\trepeatModel?: ArrayDataSource<any> | any[];\n\n\tonClick?: DataDrain<MouseEvent>;\n\tonKeydown?: DataDrain<KeyboardEvent>;\n\tonKeyup?: DataDrain<KeyboardEvent>;\n\tonMousedown?: DataDrain<KeyboardEvent>;\n\tonMouseup?: DataDrain<KeyboardEvent>;\n\tonMouseenter?: DataDrain<KeyboardEvent>;\n\tonMouseleave?: DataDrain<KeyboardEvent>;\n\n\tonAttach?: (node: AurumElement) => void;\n\ttemplate?: Template<any>;\n}\n\nexport abstract class AurumElement {\n\tprotected cancellationToken: CancellationToken;\n\tprivate cachedChildren: AurumElement[];\n\tprotected repeatData: ArrayDataSource<any>;\n\tprivate rerenderPending: boolean;\n\n\tpublic readonly node: HTMLElement;\n\tpublic readonly domNodeName: string;\n\n\tpublic template: Template<any>;\n\tpublic onClick: DataSource<MouseEvent>;\n\tpublic onKeydown: DataSource<KeyboardEvent>;\n\tpublic onKeyup: DataSource<KeyboardEvent>;\n\tpublic onMousedown: DataSource<KeyboardEvent>;\n\tpublic onMouseup: DataSource<KeyboardEvent>;\n\tpublic onMouseenter: DataSource<KeyboardEvent>;\n\tpublic onMouseleave: DataSource<KeyboardEvent>;\n\n\tconstructor(props: AurumElementProps, domNodeName: string) {\n\t\tthis.domNodeName = domNodeName;\n\t\tthis.template = props.template;\n\t\tthis.cancellationToken = new CancellationToken();\n\t\tthis.node = this.create(props);\n\t\tthis.initialize(props);\n\n\t\tif (props.onAttach) {\n\t\t\tprops.onAttach(this);\n\t\t}\n\t}\n\n\tprotected createEventHandlers(keys: string[], props: any) {\n\t\tfor (const key of keys) {\n\t\t\tconst computedEventName = 'on' + key[0].toUpperCase() + key.slice(1);\n\n\t\t\tlet eventEmitter;\n\t\t\tObject.defineProperty(this, computedEventName, {\n\t\t\t\tget() {\n\t\t\t\t\tif (!eventEmitter) {\n\t\t\t\t\t\teventEmitter = new DataSource();\n\t\t\t\t\t}\n\t\t\t\t\treturn eventEmitter;\n\t\t\t\t},\n\t\t\t\tset() {\n\t\t\t\t\tthrow new Error(computedEventName + ' is read only');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (props[computedEventName]) {\n\t\t\t\tif (props[computedEventName] instanceof DataSource) {\n\t\t\t\t\tthis[computedEventName].listen(props[computedEventName].update.bind(props.onClick), this.cancellationToken);\n\t\t\t\t} else if (typeof props[computedEventName] === 'function') {\n\t\t\t\t\tthis[computedEventName].listen(props[computedEventName], this.cancellationToken);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cancellationToken.registerDomEvent(this.node, key, (e: MouseEvent) => this[computedEventName].update(e));\n\t\t}\n\t}\n\n\tprivate initialize(props: AurumElementProps) {\n\t\t//@ts-ignore\n\t\tthis.node.owner = this;\n\n\t\tthis.createEventHandlers(['click', 'keydown', 'keyhit', 'keyup', 'mousedown, mouseup', 'mouseenter', 'mouseleave'], props);\n\n\t\tif (props.id) {\n\t\t\tthis.assignStringSourceToAttribute(props.id, 'id');\n\t\t}\n\t\tif (props.class) {\n\t\t\tthis.handleClass(props.class);\n\t\t}\n\n\t\tif (props.repeatModel) {\n\t\t\tthis.cachedChildren = [];\n\t\t\tthis.handleRepeat(props.repeatModel);\n\t\t}\n\t}\n\n\tprivate handleRepeat(dataSource: ArrayDataSource<any> | any[]): void {\n\t\tif (dataSource instanceof ArrayDataSource) {\n\t\t\tthis.repeatData = dataSource;\n\t\t} else {\n\t\t\tthis.repeatData = new ArrayDataSource<any>(dataSource);\n\t\t}\n\n\t\tif (this.repeatData.length) {\n\t\t\tthis.cachedChildren.push(...(this.repeatData as ArrayDataSource<any>).toArray().map((i) => this.template.generate(i)));\n\t\t\tthis.renderRepeat();\n\t\t}\n\n\t\tthis.repeatData.onChange.subscribe((change) => {\n\t\t\tswitch (change.operation) {\n\t\t\t\tcase 'append':\n\t\t\t\t\tthis.cachedChildren.push(...change.items.map((i) => this.template.generate(i)));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'removeLeft':\n\t\t\t\t\tthis.cachedChildren.splice(0, change.count);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'removeRight':\n\t\t\t\t\tthis.cachedChildren.splice(this.node.childElementCount - change.count, change.count);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'remove':\n\t\t\t\t\tthis.cachedChildren.splice(change.index, change.count);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.cachedChildren.length = 0;\n\t\t\t\t\tthis.cachedChildren.push(...(this.repeatData as ArrayDataSource<any>).toArray().map((i) => this.template.generate(i)));\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.renderRepeat();\n\t\t});\n\t}\n\n\tprotected renderRepeat(): void {\n\t\tif (this.rerenderPending) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tfor (let i = 0; i < this.cachedChildren.length; i++) {\n\t\t\t\tif (this.node.childElementCount <= i) {\n\t\t\t\t\tthis.addChildren(this.cachedChildren.slice(i, this.cachedChildren.length));\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (((this.node.children[i] as any).owner as AurumElement) !== this.cachedChildren[i]) {\n\t\t\t\t\tif (!this.cachedChildren.includes((this.node.children[i] as any).owner as AurumElement)) {\n\t\t\t\t\t\tthis.node.children[i].remove();\n\t\t\t\t\t\ti--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst index = this.getChildIndex(this.cachedChildren[i].node);\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tthis.swapChildren(i, index);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.addChildAt(this.cachedChildren[i], i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (this.node.childElementCount > this.cachedChildren.length) {\n\t\t\t\tthis.node.removeChild(this.node.lastChild);\n\t\t\t}\n\t\t\t// this.onUpdate.fire(this);\n\t\t\tthis.rerenderPending = false;\n\t\t});\n\t\tthis.rerenderPending = true;\n\t}\n\n\tprotected assignStringSourceToAttribute(data: StringSource, key: string) {\n\t\tif (typeof data === 'string') {\n\t\t\tthis.node[key] = data;\n\t\t} else {\n\t\t\tif (data.value) {\n\t\t\t\tthis.node[key] = data.value;\n\t\t\t}\n\t\t\tdata.unique(this.cancellationToken).listen((v) => (this.node.id = v), this.cancellationToken);\n\t\t}\n\t}\n\n\tprivate handleClass(data: ClassType) {\n\t\tif (typeof data === 'string') {\n\t\t\tthis.node.className = data;\n\t\t} else if (data instanceof DataSource) {\n\t\t\tif (data.value) {\n\t\t\t\tif (Array.isArray(data.value)) {\n\t\t\t\t\tthis.node.className = data.value.join(' ');\n\t\t\t\t\tdata.unique(this.cancellationToken).listen(() => {\n\t\t\t\t\t\tthis.node.className = (data.value as string[]).join(' ');\n\t\t\t\t\t}, this.cancellationToken);\n\t\t\t\t} else {\n\t\t\t\t\tthis.node.className = data.value;\n\t\t\t\t\tdata.unique(this.cancellationToken).listen(() => {\n\t\t\t\t\t\tthis.node.className = data.value as string;\n\t\t\t\t\t}, this.cancellationToken);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdata.unique(this.cancellationToken).listen((v) => (this.node.className = v), this.cancellationToken);\n\t\t} else {\n\t\t\tconst value: string = data.reduce<string>((p, c) => {\n\t\t\t\tif (typeof c === 'string') {\n\t\t\t\t\treturn `${p} ${c}`;\n\t\t\t\t} else {\n\t\t\t\t\tif (c.value) {\n\t\t\t\t\t\treturn `${p} ${c.value}`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn p;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, '');\n\t\t\tthis.node.className = value;\n\t\t\tfor (const i of data) {\n\t\t\t\tif (i instanceof DataSource) {\n\t\t\t\t\ti.unique(this.cancellationToken).listen((v) => {\n\t\t\t\t\t\tconst value: string = data.reduce<string>((p, c) => {\n\t\t\t\t\t\t\tif (typeof c === 'string') {\n\t\t\t\t\t\t\t\treturn `${p} ${c}`;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (c.value) {\n\t\t\t\t\t\t\t\t\treturn `${p} ${c.value}`;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn p;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, '');\n\t\t\t\t\t\tthis.node.className = value;\n\t\t\t\t\t}, this.cancellationToken);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic create(props: AurumElementProps): HTMLElement {\n\t\tconst node = document.createElement(this.domNodeName);\n\t\treturn node;\n\t}\n\n\tprotected getChildIndex(node: HTMLElement): number {\n\t\tlet i = 0;\n\t\tfor (const child of node.children) {\n\t\t\tif (child === node) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tprotected hasChild(node: HTMLElement): boolean {\n\t\tfor (const child of node.children) {\n\t\t\tif (child === node) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic setInnerText(value: string) {\n\t\tthis.node.innerText = value;\n\t}\n\n\tpublic swapChildren(indexA: number, indexB: number) {\n\t\tif (indexA === indexB) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst nodeA = this.node.children[indexA];\n\t\tconst nodeB = this.node.children[indexB];\n\t\tnodeA.remove();\n\t\tnodeB.remove();\n\t\tif (indexA < indexB) {\n\t\t\tthis.addDomNodeAt(nodeB as HTMLElement, indexA);\n\t\t\tthis.addDomNodeAt(nodeA as HTMLElement, indexB);\n\t\t} else {\n\t\t\tthis.addDomNodeAt(nodeA as HTMLElement, indexB);\n\t\t\tthis.addDomNodeAt(nodeB as HTMLElement, indexA);\n\t\t}\n\t}\n\n\tprotected addDomNodeAt(node: HTMLElement, index: number) {\n\t\tif (index >= this.node.childElementCount) {\n\t\t\tthis.node.appendChild(node);\n\t\t} else {\n\t\t\tthis.node.insertBefore(node, this.node.children[index]);\n\t\t}\n\t}\n\n\tpublic addChildAt(child: AurumElement, index: number) {\n\t\tif (child instanceof Template) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn this.addDomNodeAt(child.node, index);\n\t}\n\n\tpublic addChildren(nodes: AurumElement[]) {\n\t\tif (nodes.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tlet dataSegments: Array<string | DataSource<any>> = [];\n\t\tfor (const c of nodes) {\n\t\t\tif (c instanceof Template) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (typeof c === 'string') {\n\t\t\t\tdataSegments.push(c);\n\t\t\t} else if (c instanceof DataSource) {\n\t\t\t\tdataSegments.push(c);\n\t\t\t\tthis.setInnerText(c.value);\n\t\t\t\tc.listen((v) => {\n\t\t\t\t\tconst value: string = dataSegments.reduce<string>((p, c) => p + (c instanceof DataSource ? (c.value ?? '').toString() : c), '');\n\t\t\t\t\tthis.setInnerText(value);\n\t\t\t\t}, this.cancellationToken);\n\t\t\t} else {\n\t\t\t\tthis.node.appendChild(c.node);\n\t\t\t}\n\t\t}\n\t\tif (dataSegments.length) {\n\t\t\tconst value: string = dataSegments.reduce<string>((p, c) => p + (c instanceof DataSource ? (c.value ?? '').toString() : c), '');\n\t\t\tthis.setInnerText(value);\n\t\t}\n\t}\n}\n\nexport interface TemplateProps<T> extends AurumElementProps {\n\tonAttach?(entity: Template<T>): void;\n\tonDetach?(entity: Template<T>): void;\n\tgenerator(model: T): AurumElement;\n\tref?: string;\n}\n\nexport class Template<T> extends AurumElement {\n\tpublic generate: (model: T) => AurumElement;\n\tref: string;\n\n\tconstructor(props: TemplateProps<T>) {\n\t\tsuper(props, 'template');\n\t\tthis.ref = props.ref;\n\t\tthis.generate = props.generator;\n\t}\n}\n"]}