{"version":3,"file":"switch.js","sourceRoot":"","sources":["../../../src/nodes/special/switch.ts"],"names":[],"mappings":"AAAA,OAAO,EAAgC,SAAS,EAAE,MAAM,iBAAiB,CAAC;AAO1E,MAAM,kBAAkB,GAAG,MAAM,CAAC,YAAY,CAAC,CAAC;AAShD,MAAM,UAAU,MAAM,CAAc,KAAqB,EAAE,QAAQ;IAClE,QAAQ,GAAG,QAAQ,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;IACnC,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,EAAE;QACjD,MAAM,IAAI,KAAK,CAAC,4CAA4C,CAAC,CAAC;KAC9D;IACD,IAAI,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;QACjD,MAAM,IAAI,KAAK,CAAC,mDAAmD,CAAC,CAAC;KACrE;IAED,OAAO,KAAK,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,UAAU,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC,CAAC;AACzE,CAAC;AAED,SAAS,UAAU,CAAI,KAAQ,EAAE,QAAiC;;IACjE,mBAAO,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,KAAK,KAAK,KAAK,CAAC,0CAAE,OAAO,yCAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,0CAAE,OAAO,CAAC;AACrG,CAAC;AAMD,MAAM,UAAU,UAAU,CAAI,KAAyB,EAAE,QAAQ;IAChE,OAAO;QACN,CAAC,kBAAkB,CAAC,EAAE,IAAI;QAC1B,OAAO,EAAE,QAAQ;QACjB,OAAO,EAAE,KAAK;QACd,KAAK,EAAE,KAAK,CAAC,IAAI;KACjB,CAAC;AACH,CAAC;AAED,MAAM,UAAU,iBAAiB,CAAC,KAAS,EAAE,QAAQ;IACpD,OAAO;QACN,CAAC,kBAAkB,CAAC,EAAE,IAAI;QAC1B,OAAO,EAAE,QAAQ;QACjB,OAAO,EAAE,IAAI;QACb,KAAK,EAAE,SAAS;KAChB,CAAC;AACH,CAAC","sourcesContent":["import { AurumElementProps, ChildNode, prerender } from './aurum_element';\r\nimport { DataSource } from '../../stream/data_source';\r\n\r\nexport interface SwitchProps<T = boolean> extends AurumElementProps {\r\n\tstate: DataSource<T>;\r\n}\r\n\r\nconst switchCaseIdentity = Symbol('switchCase');\r\n\r\nexport interface SwitchCaseInstance<T> {\r\n\t[switchCaseIdentity]: boolean;\r\n\tvalue: T;\r\n\tdefault: boolean;\r\n\tcontent: ChildNode[];\r\n}\r\n\r\nexport function Switch<T = boolean>(props: SwitchProps<T>, children) {\r\n\tchildren = children.map(prerender);\r\n\tif (children.some((c) => !c[switchCaseIdentity])) {\r\n\t\tthrow new Error('Switch only accepts SwitchCase as children');\r\n\t}\r\n\tif (children.filter((c) => c.default).length > 1) {\r\n\t\tthrow new Error('Too many default switch cases only 0 or 1 allowed');\r\n\t}\r\n\r\n\treturn props.state.unique().map((state) => selectCase(state, children));\r\n}\r\n\r\nfunction selectCase<T>(state: T, children: SwitchCaseInstance<T>[]) {\r\n\treturn children.find((c) => c.value === state)?.content ?? children.find((p) => p.default)?.content;\r\n}\r\n\r\nexport interface SwitchCaseProps<T> {\r\n\twhen: T;\r\n}\r\n\r\nexport function SwitchCase<T>(props: SwitchCaseProps<T>, children): SwitchCaseInstance<T> {\r\n\treturn {\r\n\t\t[switchCaseIdentity]: true,\r\n\t\tcontent: children,\r\n\t\tdefault: false,\r\n\t\tvalue: props.when\r\n\t};\r\n}\r\n\r\nexport function DefaultSwitchCase(props: {}, children): SwitchCaseInstance<any> {\r\n\treturn {\r\n\t\t[switchCaseIdentity]: true,\r\n\t\tcontent: children,\r\n\t\tdefault: true,\r\n\t\tvalue: undefined\r\n\t};\r\n}\r\n"]}