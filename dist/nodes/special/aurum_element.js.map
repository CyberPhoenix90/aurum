{"version":3,"file":"aurum_element.js","sourceRoot":"","sources":["../../../src/nodes/special/aurum_element.ts"],"names":[],"mappings":"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","sourcesContent":["import { ArrayDataSource, DataSource } from '../../stream/data_source';\r\nimport { Callback, ClassType, DataDrain, MapLike, AttributeValue } from '../../utilities/common';\r\nimport { ownerSymbol } from '../../utilities/owner_symbol';\r\nimport { AurumTextElement } from './aurum_text';\r\nimport { EventEmitter } from '../../utilities/event_emitter';\r\nimport { DuplexDataSource } from '../../stream/duplex_data_source';\r\n\r\n/**\r\n * @inernal\r\n */\r\nexport const aurumElementModelIdentitiy = Symbol('AurumElementModel');\r\n\r\nexport interface AurumElementModel {\r\n\t[aurumElementModelIdentitiy]: boolean;\r\n\tconstructor: (props: AurumElementProps, innerNodes: ChildNode[]) => AurumElement;\r\n\tprops: AurumElementProps;\r\n\tinnerNodes: ChildNode[];\r\n}\r\n\r\nexport interface AurumElementProps {\r\n\tid?: AttributeValue;\r\n\tname?: AttributeValue;\r\n\tdraggable?: AttributeValue;\r\n\tclass?: ClassType;\r\n\ttabindex?: ClassType;\r\n\tstyle?: AttributeValue;\r\n\ttitle?: AttributeValue;\r\n\trole?: AttributeValue;\r\n\tcontentEditable?: AttributeValue;\r\n\tonDblclick?: DataDrain<MouseEvent>;\r\n\tonClick?: DataDrain<MouseEvent>;\r\n\tonKeydown?: DataDrain<KeyboardEvent>;\r\n\tonKeyup?: DataDrain<KeyboardEvent>;\r\n\tonMousedown?: DataDrain<KeyboardEvent>;\r\n\tonMouseup?: DataDrain<KeyboardEvent>;\r\n\tonMouseenter?: DataDrain<KeyboardEvent>;\r\n\tonMouseleave?: DataDrain<KeyboardEvent>;\r\n\tonMousewheel?: DataDrain<WheelEvent>;\r\n\tonBlur?: DataDrain<FocusEvent>;\r\n\tonFocus?: DataDrain<FocusEvent>;\r\n\tonDrag?: DataDrain<DragEvent>;\r\n\tonDragend?: DataDrain<DragEvent>;\r\n\tonDragenter?: DataDrain<DragEvent>;\r\n\tonDragexit?: DataDrain<DragEvent>;\r\n\tonDragleave?: DataDrain<DragEvent>;\r\n\tonDragover?: DataDrain<DragEvent>;\r\n\tonDragstart?: DataDrain<DragEvent>;\r\n\tonLoad?: DataDrain<Event>;\r\n\tonError?: DataDrain<ErrorEvent>;\r\n\r\n\tonAttach?: Callback<HTMLElement>;\r\n\tonDetach?: Callback<HTMLElement>;\r\n\tonCreate?: Callback<HTMLElement>;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nconst defaultEvents: MapLike<string> = {\r\n\tdrag: 'onDrag',\r\n\tdragstart: 'onDragStart',\r\n\tdragend: 'onDragEnd',\r\n\tdragexit: 'onDragExit',\r\n\tdragover: 'onDragOver',\r\n\tdragenter: 'onDragEnter',\r\n\tdragleave: 'onDragLeave',\r\n\tblur: 'onBlur',\r\n\tfocus: 'onFocus',\r\n\tclick: 'onClick',\r\n\tdblclick: 'onDblClick',\r\n\tkeydown: 'onKeyDown',\r\n\tkeyhit: 'onKeyHit',\r\n\tkeyup: 'onKeyUp',\r\n\tmousedown: 'onMouseDown',\r\n\tmouseup: 'onMouseUp',\r\n\tmousemove: 'onMouseMove',\r\n\tmouseenter: 'onMouseEnter',\r\n\tmouseleave: 'onMouseLeave',\r\n\tmousewheel: 'onMouseWheel',\r\n\tload: 'onLoad',\r\n\terror: 'onError'\r\n};\r\n\r\n/**\r\n * @internal\r\n */\r\nconst defaultProps: string[] = ['id', 'name', 'draggable', 'tabindex', 'style', 'role', 'contentEditable'];\r\n\r\nexport function prerender(model: any): Renderable {\r\n\tif (model && model[aurumElementModelIdentitiy]) {\r\n\t\tconst result = model.constructor(model.props, model.innerNodes);\r\n\t\treturn prerender(result as any);\r\n\t} else {\r\n\t\treturn model;\r\n\t}\r\n}\r\n\r\nexport type Renderable =\r\n\t| AurumElement\r\n\t| string\r\n\t| Promise<Renderable>\r\n\t| DataSource<string>\r\n\t| DataSource<AurumElement>\r\n\t| DataSource<AurumElement[]>\r\n\t| ArrayDataSource<AurumElement>\r\n\t| ChildNode[];\r\n\r\nexport type ChildNode =\r\n\t| AurumElementModel\r\n\t| string\r\n\t| Promise<ChildNode>\r\n\t| DataSource<string>\r\n\t| DataSource<AurumElementModel>\r\n\t| DataSource<AurumElementModel[]>\r\n\t| ArrayDataSource<AurumElementModel>\r\n\t| ChildNode[];\r\n\r\nexport abstract class AurumElement {\r\n\tprivate onAttach?: Callback<HTMLElement>;\r\n\tprivate onDetach?: Callback<HTMLElement>;\r\n\r\n\tprivate children: Array<AurumElement | AurumFragment | AurumTextElement>;\r\n\tprotected needAttach: boolean;\r\n\r\n\tpublic node: HTMLElement;\r\n\r\n\tconstructor(props: AurumElementProps, children: ChildNode[], domNodeName: string) {\r\n\t\tthis.node = this.create(domNodeName);\r\n\t\tthis.children = [];\r\n\r\n\t\tif (props != null) {\r\n\t\t\tif (props.onAttach) {\r\n\t\t\t\tthis.onAttach = props.onAttach;\r\n\t\t\t\tthis.needAttach = true;\r\n\t\t\t}\r\n\t\t\tthis.onDetach = props.onDetach;\r\n\r\n\t\t\tthis.initialize(props);\r\n\t\t\tprops.onCreate?.(this.node);\r\n\t\t}\r\n\t\tif (children) {\r\n\t\t\tthis.addChildren(children);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initialize(props: AurumElementProps) {\r\n\t\tthis.createEventHandlers(defaultEvents, props);\r\n\r\n\t\tconst dataProps = Object.keys(props).filter((e) => e.includes('-'));\r\n\t\tthis.bindProps(defaultProps, props, dataProps);\r\n\r\n\t\tif (props.class) {\r\n\t\t\tthis.handleClass(props.class);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindProps(keys: string[], props: any, dynamicProps?: string[]) {\r\n\t\tfor (const key of keys) {\r\n\t\t\tif (props[key]) {\r\n\t\t\t\tthis.assignStringSourceToAttribute(props[key], key);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (dynamicProps) {\r\n\t\t\tfor (const key of dynamicProps) {\r\n\t\t\t\tif (props[key]) {\r\n\t\t\t\t\tthis.assignStringSourceToAttribute(props[key], key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected createEventHandlers(events: MapLike<string>, props: any) {\r\n\t\tfor (const key in events) {\r\n\t\t\tif (props[events[key]]) {\r\n\t\t\t\tif (props[events[key]] instanceof DataSource) {\r\n\t\t\t\t\tthis.node.addEventListener(key, (e: MouseEvent) => props[events[key]].update(e));\r\n\t\t\t\t} else if (props[events[key]] instanceof DuplexDataSource) {\r\n\t\t\t\t\tthis.node.addEventListener(key, (e: MouseEvent) => props[events[key]].updateDownstream(e));\r\n\t\t\t\t} else if (typeof props[events[key]] === 'function') {\r\n\t\t\t\t\tthis.node.addEventListener(key, (e: MouseEvent) => props[events[key]](e));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected render(): void {\r\n\t\tlet absoluteIndex: number = 0;\r\n\t\tfor (let i = 0; i < this.children.length; i++, absoluteIndex++) {\r\n\t\t\tif (this.children[i] instanceof AurumFragment) {\r\n\t\t\t\tabsoluteIndex = this.renderFragment(this.children[i] as AurumFragment, absoluteIndex);\r\n\t\t\t} else {\r\n\t\t\t\tthis.renderChild(this.children[i] as AurumElement, absoluteIndex);\r\n\t\t\t}\r\n\t\t}\r\n\t\twhile (this.node.childNodes.length > absoluteIndex) {\r\n\t\t\tconst child = this.node.childNodes[this.node.childNodes.length - 1];\r\n\t\t\tthis.node.removeChild(child);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected renderFragment(fragment: AurumFragment, absoluteIndex: number) {\r\n\t\tfor (let j = 0; j < fragment.children.length; j++, absoluteIndex++) {\r\n\t\t\tif (fragment.children[j] instanceof AurumFragment) {\r\n\t\t\t\tabsoluteIndex = this.renderFragment(fragment.children[j] as AurumFragment, absoluteIndex);\r\n\t\t\t} else {\r\n\t\t\t\tthis.renderChild(fragment.children[j] as AurumElement | AurumTextElement, absoluteIndex);\r\n\t\t\t}\r\n\t\t}\r\n\t\tabsoluteIndex--;\r\n\t\treturn absoluteIndex;\r\n\t}\r\n\r\n\tprivate renderChild(child: AurumElement | AurumTextElement, index: number) {\r\n\t\tif (this.node.childNodes.length <= index) {\r\n\t\t\treturn this.addChildDom(child as AurumElement);\r\n\t\t}\r\n\t\tif (this.node.childNodes[index][ownerSymbol] !== child) {\r\n\t\t\tconst childIndex = this.getChildIndex(child.node as any);\r\n\t\t\tif (childIndex !== -1) {\r\n\t\t\t\tthis.swapChildrenDom(index, childIndex);\r\n\t\t\t} else {\r\n\t\t\t\tthis.addDomNodeAt(child.node, index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected assignStringSourceToAttribute(data: AttributeValue, key: string) {\r\n\t\tif (typeof data === 'string' || typeof data === 'boolean') {\r\n\t\t\tif (typeof data === 'boolean') {\r\n\t\t\t\tif (data) {\r\n\t\t\t\t\tthis.node.setAttribute(key, '');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.node.removeAttribute(key);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t(this.node as HTMLElement).setAttribute(key, data);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdata.unique().listenAndRepeat((v) => {\r\n\t\t\t\tif (typeof v === 'boolean') {\r\n\t\t\t\t\tif (v) {\r\n\t\t\t\t\t\tthis.node.setAttribute(key, '');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.node.removeAttribute(key);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t(this.node as HTMLElement).setAttribute(key, v);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected handleAttach(parent: AurumElement) {\r\n\t\tif (this.needAttach) {\r\n\t\t\tif (parent.isConnected()) {\r\n\t\t\t\tthis.onAttach?.(this.node);\r\n\t\t\t\tfor (const child of this.node.childNodes) {\r\n\t\t\t\t\tchild[ownerSymbol]?.handleAttach?.(this);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tparent.needAttach = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t//@ts-ignore\r\n\tprivate handleDetach() {\r\n\t\tif (!this.node.isConnected) {\r\n\t\t\tthis.onDetach?.(this.node);\r\n\t\t\tfor (const child of this.node.childNodes) {\r\n\t\t\t\tif (child[ownerSymbol]) {\r\n\t\t\t\t\tchild[ownerSymbol].handleDetach?.();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate handleClass(data: ClassType) {\r\n\t\tif (typeof data === 'string') {\r\n\t\t\tthis.node.className = data;\r\n\t\t} else if (data instanceof DataSource) {\r\n\t\t\tif (data.value) {\r\n\t\t\t\tif (Array.isArray(data.value)) {\r\n\t\t\t\t\tthis.node.className = data.value.join(' ');\r\n\t\t\t\t\tdata.unique().listen(() => {\r\n\t\t\t\t\t\t(this.node as HTMLElement).className = (data.value as string[]).join(' ');\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.node.className = data.value;\r\n\t\t\t\t\tdata.unique().listen(() => {\r\n\t\t\t\t\t\t(this.node as HTMLElement).className = data.value as string;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdata.unique().listen((v) => ((this.node as HTMLElement).className = v));\r\n\t\t} else {\r\n\t\t\tconst value: string = data.reduce<string>((p, c) => {\r\n\t\t\t\tif (typeof c === 'string') {\r\n\t\t\t\t\treturn `${p} ${c}`;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (c.value) {\r\n\t\t\t\t\t\treturn `${p} ${c.value}`;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn p;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, '');\r\n\t\t\tthis.node.className = value;\r\n\t\t\tfor (const i of data) {\r\n\t\t\t\tif (i instanceof DataSource) {\r\n\t\t\t\t\ti.unique().listen((v) => {\r\n\t\t\t\t\t\tconst value: string = data.reduce<string>((p, c) => {\r\n\t\t\t\t\t\t\tif (typeof c === 'string') {\r\n\t\t\t\t\t\t\t\treturn `${p} ${c}`;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (c.value) {\r\n\t\t\t\t\t\t\t\t\treturn `${p} ${c.value}`;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\treturn p;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, '');\r\n\t\t\t\t\t\t(this.node as HTMLElement).className = value;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected create(domNodeName: string): HTMLElement {\r\n\t\tconst node = document.createElement(domNodeName);\r\n\t\tnode[ownerSymbol] = this;\r\n\t\treturn node;\r\n\t}\r\n\r\n\tprotected getChildIndex(node: HTMLElement): number {\r\n\t\tlet i = 0;\r\n\t\tfor (const child of this.node.childNodes) {\r\n\t\t\tif (child === node) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t\ti++;\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n\r\n\tprotected hasChild(node: HTMLElement): boolean {\r\n\t\tfor (const child of node.children) {\r\n\t\t\tif (child === node) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprotected addChildDom(child: AurumElement): void {\r\n\t\tthis.node.appendChild(child.node);\r\n\t\tchild.handleAttach?.(this);\r\n\t}\r\n\r\n\tprotected swapChildrenDom(indexA: number, indexB: number) {\r\n\t\tif (indexA === indexB) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst nodeA = this.node.children[indexA];\r\n\t\tconst nodeB = this.node.children[indexB];\r\n\t\tnodeA.remove();\r\n\t\tnodeB.remove();\r\n\t\tif (indexA < indexB) {\r\n\t\t\tthis.addDomNodeAt(nodeB as HTMLElement, indexA);\r\n\t\t\tthis.addDomNodeAt(nodeA as HTMLElement, indexB);\r\n\t\t} else {\r\n\t\t\tthis.addDomNodeAt(nodeA as HTMLElement, indexB);\r\n\t\t\tthis.addDomNodeAt(nodeB as HTMLElement, indexA);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected addDomNodeAt(node: HTMLElement | Text, index: number): void {\r\n\t\tif (index >= this.node.childElementCount) {\r\n\t\t\tthis.node.appendChild(node);\r\n\t\t\tnode[ownerSymbol].handleAttach?.(this);\r\n\t\t} else {\r\n\t\t\tthis.node.insertBefore(node, this.node.children[index]);\r\n\t\t\tnode[ownerSymbol].handleAttach?.(this);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic remove(): void {\r\n\t\tif (this.hasParent()) {\r\n\t\t\tthis.node.parentElement[ownerSymbol].removeChild(this.node);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic hasParent(): boolean {\r\n\t\treturn !!this.node.parentElement;\r\n\t}\r\n\r\n\tpublic isConnected(): boolean {\r\n\t\treturn this.node.isConnected;\r\n\t}\r\n\r\n\tpublic removeChild(child: AurumElement): void {\r\n\t\tconst index = this.children.indexOf(child);\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.children.splice(index, 1);\r\n\t\t}\r\n\t\tthis.render();\r\n\t}\r\n\r\n\tpublic removeChildAt(index: number): void {\r\n\t\tthis.children.splice(index, 1);\r\n\t\tthis.render();\r\n\t}\r\n\r\n\tpublic swapChildren(indexA: number, indexB: number): void {\r\n\t\tif (indexA === indexB) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst nodeA = this.children[indexA];\r\n\t\tconst nodeB = this.children[indexB];\r\n\t\tthis.children[indexA] = nodeB;\r\n\t\tthis.children[indexB] = nodeA;\r\n\t\tthis.render();\r\n\t}\r\n\r\n\tpublic clearChildren(): void {\r\n\t\tthis.children.length = 0;\r\n\t\tthis.render();\r\n\t}\r\n\r\n\tpublic addChild(child: ChildNode): void {\r\n\t\tif (child === undefined || child === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (child[aurumElementModelIdentitiy]) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tchild = prerender(child as AurumElementModel);\r\n\t\t\tif (child === undefined) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (Array.isArray(child)) {\r\n\t\t\tfor (const subChild of child) {\r\n\t\t\t\tthis.addChild(subChild);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.children.push(this.childNodeToAurum(child));\r\n\t\tthis.render();\r\n\t}\r\n\r\n\tprivate childNodeToAurum(child: ChildNode): AurumElement | AurumFragment | AurumTextElement {\r\n\t\tif (child instanceof AurumElement) {\r\n\t\t\treturn child;\r\n\t\t}\r\n\r\n\t\tif (child instanceof Promise) {\r\n\t\t\tconst result = new AurumFragment({});\r\n\t\t\t//@ts-ignore\r\n\t\t\tchild.then((value) => {\r\n\t\t\t\tresult.addChildren([value]);\r\n\t\t\t\tthis.render();\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t} else if (child instanceof ArrayDataSource) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tconst result = new AurumFragment({ repeatModel: child });\r\n\t\t\tresult.onChange.subscribe(() => this.render());\r\n\t\t\treturn result;\r\n\t\t} else if (typeof child === 'string' || typeof child === 'number' || typeof child === 'boolean' || typeof child === 'bigint') {\r\n\t\t\treturn new AurumTextElement(child.toString());\r\n\t\t} else if (child instanceof DataSource) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tconst result = new AurumFragment({}, [child]);\r\n\t\t\tresult.onChange.subscribe(() => this.render());\r\n\t\t\treturn result;\r\n\t\t} else {\r\n\t\t\tthrow new Error('Unsupported child type');\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addChildAt(child: ChildNode, index: number): void {\r\n\t\tthis.children.splice(index, 0, this.childNodeToAurum(child));\r\n\t\tthis.render();\r\n\t}\r\n\r\n\tpublic addChildren(nodes: ChildNode[]): void {\r\n\t\tif (nodes.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfor (const child of nodes) {\r\n\t\t\tthis.addChild(child);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface AurumFragmentProps {\r\n\trepeatModel?: ArrayDataSource<AurumElementModel>;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport class AurumFragment {\r\n\tpublic children: Array<AurumElement | AurumTextElement | AurumFragment>;\r\n\tpublic onChange: EventEmitter<void>;\r\n\r\n\tconstructor(props: AurumFragmentProps, children?: ChildNode[]) {\r\n\t\tthis.onChange = new EventEmitter();\r\n\t\tthis.children = [];\r\n\t\tif (props.repeatModel) {\r\n\t\t\tthis.handleRepeat(props.repeatModel);\r\n\t\t} else if (children) {\r\n\t\t\tthis.addChildren(children);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addChildren(children: ChildNode[]) {\r\n\t\tfor (const child of children) {\r\n\t\t\tlet renderable;\r\n\t\t\tif (child[aurumElementModelIdentitiy]) {\r\n\t\t\t\trenderable = prerender(child as any);\r\n\t\t\t} else {\r\n\t\t\t\trenderable = child;\r\n\t\t\t}\r\n\t\t\tif (renderable instanceof AurumElement) {\r\n\t\t\t\tthis.children.push(renderable);\r\n\t\t\t} else if (renderable instanceof DataSource) {\r\n\t\t\t\tlet sourceChild = undefined;\r\n\t\t\t\tlet wasArray: boolean;\r\n\t\t\t\tconst freshnessToken = { ts: undefined };\r\n\t\t\t\trenderable.unique().listenAndRepeat((newValue) => {\r\n\t\t\t\t\tfreshnessToken.ts = Date.now();\r\n\t\t\t\t\tif ((newValue === undefined || newValue === null) && wasArray) {\r\n\t\t\t\t\t\tthis.children.length = 0;\r\n\t\t\t\t\t\tthis.onChange.fire();\r\n\t\t\t\t\t\twasArray = false;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t} else if (!Array.isArray(newValue) && wasArray) {\r\n\t\t\t\t\t\tthis.children.length = 0;\r\n\t\t\t\t\t\tthis.onChange.fire();\r\n\t\t\t\t\t\twasArray = false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (Array.isArray(newValue)) {\r\n\t\t\t\t\t\twasArray = true;\r\n\t\t\t\t\t\tthis.children.length = 0;\r\n\t\t\t\t\t\tthis.onChange.fire();\r\n\t\t\t\t\t\tfor (const newSubValue of newValue) {\r\n\t\t\t\t\t\t\tthis.handleSourceChild(newSubValue, undefined, undefined, freshnessToken, freshnessToken.ts);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsourceChild = this.handleSourceChild(newValue, sourceChild, renderable, freshnessToken, freshnessToken.ts);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error('case not yet implemented');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate handleSourceChild(newValue: any, sourceChild: any, dataSource, freshnessToken: { ts: number }, timestamp: number) {\r\n\t\tif (newValue === undefined || newValue === null) {\r\n\t\t\tif (sourceChild) {\r\n\t\t\t\tthis.children.splice(this.children.indexOf(sourceChild), 1);\r\n\t\t\t\tsourceChild = undefined;\r\n\t\t\t\tthis.onChange.fire();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newValue[aurumElementModelIdentitiy]) {\r\n\t\t\tnewValue = prerender(newValue);\r\n\t\t}\r\n\r\n\t\tif (typeof newValue === 'string' || typeof newValue === 'bigint' || typeof newValue === 'number' || typeof newValue === 'boolean') {\r\n\t\t\tif (!sourceChild) {\r\n\t\t\t\tconst textNode = new AurumTextElement(dataSource ?? newValue);\r\n\t\t\t\tthis.children.push(textNode);\r\n\t\t\t\tsourceChild = textNode;\r\n\t\t\t\tthis.onChange.fire();\r\n\t\t\t} else if (sourceChild instanceof AurumElement) {\r\n\t\t\t\tconst textNode = new AurumTextElement(dataSource ?? newValue);\r\n\t\t\t\tthis.children.splice(this.children.indexOf(sourceChild), 1, textNode);\r\n\t\t\t\tsourceChild = textNode;\r\n\t\t\t\tthis.onChange.fire();\r\n\t\t\t}\r\n\t\t} else if (newValue instanceof AurumElement) {\r\n\t\t\tif (newValue !== sourceChild) {\r\n\t\t\t\tif (sourceChild) {\r\n\t\t\t\t\tthis.children.splice(this.children.indexOf(sourceChild), 1, newValue);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.children.push(newValue);\r\n\t\t\t\t}\r\n\t\t\t\tsourceChild = newValue;\r\n\t\t\t\tthis.onChange.fire();\r\n\t\t\t}\r\n\t\t} else if (newValue instanceof Promise) {\r\n\t\t\tnewValue.then((value) => {\r\n\t\t\t\tif (freshnessToken.ts === timestamp) {\r\n\t\t\t\t\tthis.addChildren([value]);\r\n\t\t\t\t\tthis.onChange.fire();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else if (newValue instanceof DataSource) {\r\n\t\t\tif (!sourceChild) {\r\n\t\t\t\tconst result = new AurumFragment({}, [newValue]);\r\n\t\t\t\tsourceChild = result;\r\n\t\t\t\tthis.children.push(result);\r\n\t\t\t\tresult.onChange.subscribe(() => this.onChange.fire());\r\n\t\t\t\tthis.onChange.fire();\r\n\t\t\t} else if (sourceChild !== newValue) {\r\n\t\t\t\tconst result = new AurumFragment({}, [newValue]);\r\n\t\t\t\tresult.onChange.subscribe(() => this.onChange.fire());\r\n\t\t\t\tthis.children.splice(this.children.indexOf(sourceChild), 1, result);\r\n\t\t\t\tsourceChild = result;\r\n\t\t\t\tthis.onChange.fire();\r\n\t\t\t}\r\n\t\t} else if (newValue instanceof ArrayDataSource) {\r\n\t\t\tif (!sourceChild) {\r\n\t\t\t\tconst result = new AurumFragment({ repeatModel: newValue });\r\n\t\t\t\tsourceChild = result;\r\n\t\t\t\tthis.children.push(result);\r\n\t\t\t\tresult.onChange.subscribe(() => this.onChange.fire());\r\n\t\t\t\tthis.onChange.fire();\r\n\t\t\t} else if (sourceChild !== newValue) {\r\n\t\t\t\tconst result = new AurumFragment({ repeatModel: newValue });\r\n\t\t\t\tresult.onChange.subscribe(() => this.onChange.fire());\r\n\t\t\t\tthis.children.splice(this.children.indexOf(sourceChild), 1, result);\r\n\t\t\t\tsourceChild = result;\r\n\t\t\t\tthis.onChange.fire();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn sourceChild;\r\n\t}\r\n\r\n\tprivate handleRepeat(dataSource: ArrayDataSource<AurumElementModel>): void {\r\n\t\tdataSource.listenAndRepeat((change) => {\r\n\t\t\tswitch (change.operationDetailed) {\r\n\t\t\t\tcase 'replace':\r\n\t\t\t\t\t//TODO:FIX THIS\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tthis.children[change.index] = prerender(change.items[0]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'swap':\r\n\t\t\t\t\tconst itemA = this.children[change.index];\r\n\t\t\t\t\tconst itemB = this.children[change.index2];\r\n\t\t\t\t\tthis.children[change.index2] = itemA;\r\n\t\t\t\t\tthis.children[change.index] = itemB;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'append':\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tthis.children = this.children.concat(change.items.map(prerender));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'prepend':\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tthis.children.unshift(...change.items.map(prerender));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'remove':\r\n\t\t\t\tcase 'removeLeft':\r\n\t\t\t\tcase 'removeRight':\r\n\t\t\t\t\tthis.children.splice(change.index, change.count);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'clear':\r\n\t\t\t\t\tthis.children = [];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error('unhandled operation');\r\n\t\t\t}\r\n\t\t\tthis.onChange.fire();\r\n\t\t});\r\n\t}\r\n}\r\n"]}