{"version":3,"file":"aurum.js","sourceRoot":"","sources":["src/utilities/event_emitter.ts","src/stream/duplex_data_source.ts","src/utilities/common.ts","src/utilities/linkedlist/linked_list_node.ts","src/utilities/linkedlist/linked_list.ts","src/utilities/cancellation_token.ts","src/stream/data_source.ts","src/utilities/owner_symbol.ts","src/nodes/special/aurum_text.ts","src/nodes/special/aurum_element.ts","src/nodes/special/custom.ts","src/nodes/special/router.ts","src/nodes/special/suspense.ts","src/nodes/special/switch.ts","src/stream/object_data_source.ts","src/nodes/div.ts","src/nodes/button.ts","src/nodes/input.ts","src/nodes/li.ts","src/nodes/span.ts","src/nodes/style.ts","src/nodes/audio.ts","src/nodes/ul.ts","src/nodes/p.ts","src/nodes/img.ts","src/nodes/link.ts","src/nodes/canvas.ts","src/nodes/a.ts","src/nodes/article.ts","src/nodes/br.ts","src/nodes/form.ts","src/nodes/label.ts","src/nodes/ol.ts","src/nodes/pre.ts","src/nodes/progress.ts","src/nodes/table.ts","src/nodes/td.ts","src/nodes/tr.ts","src/nodes/th.ts","src/nodes/textarea.ts","src/nodes/h1.ts","src/nodes/h2.ts","src/nodes/h3.ts","src/nodes/h4.ts","src/nodes/h5.ts","src/nodes/h6.ts","src/nodes/header.ts","src/nodes/footer.ts","src/nodes/nav.ts","src/nodes/b.ts","src/nodes/i.ts","src/nodes/script.ts","src/nodes/abbr.ts","src/nodes/area.ts","src/nodes/aside.ts","src/nodes/em.ts","src/nodes/heading.ts","src/nodes/iframe.ts","src/nodes/noscript.ts","src/nodes/q.ts","src/nodes/select.ts","src/nodes/source.ts","src/nodes/title.ts","src/nodes/video.ts","src/nodes/tbody.ts","src/nodes/tfoot.ts","src/nodes/thead.ts","src/nodes/summary.ts","src/nodes/details.ts","src/nodes/sub.ts","src/nodes/sup.ts","src/nodes/svg.ts","src/nodes/data.ts","src/nodes/time.ts","src/nodes/option.ts","src/nodes/template.ts","src/nodes/body.ts","src/nodes/head.ts","src/utilities/aurum.ts","src/utilities/classname.ts","src/aurum.ts","src/nodes/address.ts","src/nodes/hr.ts"],"names":[],"mappings":"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","sourcesContent":["import { CancellationToken } from '../utilities/cancellation_token';\n\n/**\n * @internal\n */\nexport interface EventSubscriptionFacade {\n\tcancel(): void;\n}\n\n/**\n * @internal\n */\nexport type EventCallback<T> = (data: T) => void;\n\ninterface EventSubscription<T> {\n\tcallback: EventCallback<T>;\n}\n\n/**\n * @internal\n */\nexport class EventEmitter<T> {\n\tprivate isFiring: boolean;\n\tprivate onAfterFire: Array<() => void>;\n\n\tpublic get subscriptions(): number {\n\t\treturn this.subscribeChannel.length;\n\t}\n\n\tprivate subscribeChannel: EventSubscription<T>[];\n\tprivate subscribeOnceChannel: EventSubscription<T>[];\n\n\tconstructor() {\n\t\tthis.subscribeChannel = [];\n\t\tthis.subscribeOnceChannel = [];\n\t\tthis.onAfterFire = [];\n\t}\n\n\tpublic subscribe(callback: EventCallback<T>, cancellationToken?: CancellationToken): EventSubscriptionFacade {\n\t\tconst { facade } = this.createSubscription(callback, this.subscribeChannel, cancellationToken);\n\n\t\treturn facade;\n\t}\n\n\tsubscribeOnce(callback: import('./common').Callback<T>, cancellationToken: CancellationToken) {\n\t\tconst { facade } = this.createSubscription(callback, this.subscribeOnceChannel, cancellationToken);\n\n\t\treturn facade;\n\t}\n\n\tpublic hasSubscriptions(): boolean {\n\t\treturn this.subscriptions > 0;\n\t}\n\n\tpublic cancelAll(): void {\n\t\tif (!this.isFiring) {\n\t\t\tthis.subscribeChannel.length = 0;\n\t\t\tthis.subscribeOnceChannel.length = 0;\n\t\t} else {\n\t\t\tthis.onAfterFire.push(() => {\n\t\t\t\tthis.subscribeChannel.length = 0;\n\t\t\t\tthis.subscribeOnceChannel.length = 0;\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate afterFire() {\n\t\tif (this.onAfterFire.length > 0) {\n\t\t\tthis.onAfterFire.forEach((cb) => cb());\n\t\t\tthis.onAfterFire.length = 0;\n\t\t}\n\t}\n\n\tpublic fire(data?: T): void {\n\t\tthis.isFiring = true;\n\n\t\tlet length = this.subscribeChannel.length;\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.subscribeChannel[i].callback(data);\n\t\t}\n\n\t\tif (this.subscribeOnceChannel.length > 0) {\n\t\t\tlength = this.subscribeOnceChannel.length;\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tthis.subscribeOnceChannel[i].callback(data);\n\t\t\t}\n\t\t\tthis.subscribeOnceChannel.length = 0;\n\t\t}\n\n\t\tthis.isFiring = false;\n\t\tthis.afterFire();\n\t}\n\n\tprivate createSubscription(\n\t\tcallback: EventCallback<T>,\n\t\tchannel: EventSubscription<T>[],\n\t\tcancellationToken?: CancellationToken\n\t): { subscription: EventSubscription<T>; facade: EventSubscriptionFacade } {\n\t\tconst that: this = this;\n\n\t\tconst subscription: EventSubscription<T> = {\n\t\t\tcallback\n\t\t};\n\n\t\tconst facade: EventSubscriptionFacade = {\n\t\t\tcancel() {\n\t\t\t\tthat.cancel(subscription, channel);\n\t\t\t}\n\t\t};\n\n\t\tif (cancellationToken !== undefined) {\n\t\t\tcancellationToken.addCancelable(() => that.cancel(subscription, channel));\n\t\t}\n\t\tchannel.push(subscription);\n\n\t\treturn { subscription, facade };\n\t}\n\n\tprivate cancel(subscription: EventSubscription<T>, channel: EventSubscription<T>[]): void {\n\t\tlet index: number = channel.indexOf(subscription);\n\t\tif (index >= 0) {\n\t\t\tif (!this.isFiring) {\n\t\t\t\tchannel.splice(index, 1);\n\t\t\t} else {\n\t\t\t\tthis.onAfterFire.push(() => this.cancel(subscription, channel));\n\t\t\t}\n\t\t}\n\t}\n}\n","import { CancellationToken } from '../utilities/cancellation_token';\nimport { Callback } from '../utilities/common';\nimport { EventEmitter } from '../utilities/event_emitter';\nimport { DataSource, ReadOnlyDataSource } from './data_source';\n\nexport enum DataFlow {\n\tUPSTREAM,\n\tDOWNSTREAM\n}\n\n/**\n * Same as DataSource except data can flow in both directions\n */\nexport class DuplexDataSource<T> implements ReadOnlyDataSource<T> {\n\t/**\n\t * The current value of this data source, can be changed through update\n\t */\n\tpublic value: T;\n\n\tprivate updatingUpstream: boolean;\n\tprivate updatingDownstream: boolean;\n\tprivate updateDownstreamEvent: EventEmitter<T>;\n\tprivate updateUpstreamEvent: EventEmitter<T>;\n\tprivate propagateWritesToReadStream: boolean;\n\n\t/**\n\t *\n\t * @param initialValue\n\t * @param propagateWritesToReadStream If a write is done propagate this update back down to all the consumers. Useful at the root node\n\t */\n\tconstructor(initialValue?: T, propagateWritesToReadStream: boolean = true) {\n\t\tthis.value = initialValue;\n\t\tthis.updateDownstreamEvent = new EventEmitter();\n\t\tthis.updateUpstreamEvent = new EventEmitter();\n\t\tthis.propagateWritesToReadStream = propagateWritesToReadStream;\n\t}\n\n\t/**\n\t * Makes it possible to have 2 completely separate data flow pipelines for each direction\n\t * @param downStream stream to pipe downstream data to\n\t * @param upstream  stream to pipe upstream data to\n\t */\n\tpublic static fromTwoDataSource<T>(\n\t\tdownStream: DataSource<T>,\n\t\tupstream: DataSource<T>,\n\t\tinitialValue?: T,\n\t\tpropagateWritesToReadStream: boolean = true\n\t): DuplexDataSource<T> {\n\t\tconst result = new DuplexDataSource<T>(initialValue, propagateWritesToReadStream);\n\t\t//@ts-ignore\n\t\tresult.updateDownstreamEvent = downStream.updateEvent;\n\t\t//@ts-ignore\n\t\tresult.updateUpstreamEvent = upstream.updateEvent;\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * Allows creating a duplex stream that blocks data in one direction. Useful for plugging into code that uses two way flow but only one way is desired\n\t * @param direction direction of the dataflow that is allowed\n\t */\n\tpublic static createOneWay<T>(direction: DataFlow = DataFlow.DOWNSTREAM, initialValue?: T): DuplexDataSource<T> {\n\t\treturn new DuplexDataSource(initialValue, false).oneWayFlow(direction);\n\t}\n\t/**\n\t * Updates the value in the data source and calls the listen callback for all listeners\n\t * @param newValue new value for the data source\n\t */\n\tpublic updateDownstream(newValue: T): void {\n\t\tif (this.updatingDownstream) {\n\t\t\tthrow new Error(\n\t\t\t\t'Problem in datas source: Unstable value propagation, when updating a value the stream was updated back as a direct response. This can lead to infinite loops and is therefore not allowed'\n\t\t\t);\n\t\t}\n\t\tthis.updatingDownstream = true;\n\t\tthis.value = newValue;\n\t\tthis.updateDownstreamEvent.fire(newValue);\n\t\tthis.updatingDownstream = false;\n\t}\n\n\t/**\n\t * Updates the value in the data source and calls the listen callback for all listeners\n\t * @param newValue new value for the data source\n\t */\n\tpublic updateUpstream(newValue: T): void {\n\t\tif (this.updatingUpstream) {\n\t\t\tthrow new Error(\n\t\t\t\t'Problem in datas source: Unstable value propagation, when updating a value the stream was updated back as a direct response. This can lead to infinite loops and is therefore not allowed'\n\t\t\t);\n\t\t}\n\t\tthis.updatingUpstream = true;\n\t\tthis.value = newValue;\n\t\tthis.updateUpstreamEvent.fire(newValue);\n\t\tif (this.propagateWritesToReadStream) {\n\t\t\tthis.updateDownstreamEvent.fire(newValue);\n\t\t}\n\t\tthis.updatingUpstream = false;\n\t}\n\n\t/**\n\t * Same as listen but will immediately call the callback with the current value first\n\t * @param callback Callback to call when value is updated\n\t * @param cancellationToken Optional token to control the cancellation of the subscription\n\t * @returns Cancellation callback, can be used to cancel subscription without a cancellation token\n\t */\n\tpublic listenAndRepeat(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void> {\n\t\tcallback(this.value);\n\t\treturn this.listen(callback, cancellationToken);\n\t}\n\n\t/**\n\t * alias for listenDownstream\n\t * @param callback Callback to call when value is updated\n\t * @param cancellationToken Optional token to control the cancellation of the subscription\n\t * @returns Cancellation callback, can be used to cancel subscription without a cancellation token\n\t */\n\tpublic listen(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void> {\n\t\treturn this.updateDownstreamEvent.subscribe(callback, cancellationToken).cancel;\n\t}\n\n\t/**\n\t * Subscribes exclusively to updates of the data stream that occur due to an update flowing upstream\n\t * @param callback Callback to call when value is updated\n\t * @param cancellationToken Optional token to control the cancellation of the subscription\n\t * @returns Cancellation callback, can be used to cancel subscription without a cancellation token\n\t */\n\tpublic listenUpstream(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void> {\n\t\treturn this.updateUpstreamEvent.subscribe(callback, cancellationToken).cancel;\n\t}\n\n\t/**\n\t * Subscribes exclusively to one update of the data stream that occur due to an update flowing upstream\n\t * @param callback Callback to call when value is updated\n\t * @param cancellationToken Optional token to control the cancellation of the subscription\n\t * @returns Cancellation callback, can be used to cancel subscription without a cancellation token\n\t */\n\tpublic listenUpstreamOnce(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void> {\n\t\treturn this.updateUpstreamEvent.subscribeOnce(callback, cancellationToken).cancel;\n\t}\n\n\t/**\n\t * Subscribes exclusively to updates of the data stream that occur due to an update flowing downstream\n\t * @param callback Callback to call when value is updated\n\t * @param cancellationToken Optional token to control the cancellation of the subscription\n\t * @returns Cancellation callback, can be used to cancel subscription without a cancellation token\n\t */\n\tpublic listenDownstream(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void> {\n\t\treturn this.updateDownstreamEvent.subscribe(callback, cancellationToken).cancel;\n\t}\n\n\tpublic downStreamToDataSource(cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst downStreamDatasource = new DataSource<T>(this.value);\n\t\tthis.listenDownstream((newVal) => {\n\t\t\tdownStreamDatasource.update(newVal);\n\t\t}, cancellationToken);\n\n\t\treturn downStreamDatasource;\n\t}\n\n\t/**\n\t * Creates a new datasource that listenes to updates of this datasource but only propagates the updates from this source if they pass a predicate check\n\t * @param callback predicate check to decide if the update from the parent data source is passed down or not\n\t * @param cancellationToken  Cancellation token to cancel the subscriptions added to the datasources by this operation\n\t */\n\tpublic filter(downStreamFilter: (value: T, oldValue: T) => boolean, cancellationToken?: CancellationToken): DataSource<T>;\n\tpublic filter(\n\t\tdownStreamFilter: (value: T, oldValue: T) => boolean,\n\t\tupstreamFilter?: (value: T) => boolean,\n\t\tcancellationToken?: CancellationToken\n\t): DuplexDataSource<T>;\n\tpublic filter(\n\t\tdownStreamFilter: (value: T, oldValue: T) => boolean,\n\t\tupstreamFilter?: ((value: T, oldValue: T) => boolean) | CancellationToken,\n\t\tcancellationToken?: CancellationToken\n\t): DuplexDataSource<T> | DataSource<T> {\n\t\tif (typeof upstreamFilter === 'function') {\n\t\t\tconst filteredSource = new DuplexDataSource<T>(undefined, false);\n\t\t\tthis.listenDownstream((newVal) => {\n\t\t\t\tif (downStreamFilter(newVal, filteredSource.value)) {\n\t\t\t\t\tfilteredSource.updateDownstream(newVal);\n\t\t\t\t}\n\t\t\t}, cancellationToken);\n\n\t\t\tfilteredSource.listenUpstream((newVal) => {\n\t\t\t\tif ((upstreamFilter as any)(newVal, this.value)) {\n\t\t\t\t\tthis.updateUpstream(newVal);\n\t\t\t\t}\n\t\t\t}, cancellationToken);\n\n\t\t\treturn filteredSource;\n\t\t} else {\n\t\t\tconst filteredSource = new DataSource<T>();\n\t\t\tthis.listenDownstream((newVal) => {\n\t\t\t\tif (downStreamFilter(newVal, filteredSource.value)) {\n\t\t\t\t\tfilteredSource.update(newVal);\n\t\t\t\t}\n\t\t\t}, upstreamFilter as any);\n\n\t\t\treturn filteredSource;\n\t\t}\n\t}\n\n\t/**\n\t * Forwards all updates from this source to another\n\t * @param targetDataSource datasource to pipe the updates to\n\t * @param cancellationToken  Cancellation token to cancel the subscriptions added to the datasources by this operation\n\t */\n\tpublic pipe(targetDataSource: DuplexDataSource<T>, cancellationToken?: CancellationToken): void {\n\t\tthis.listenDownstream((newVal) => targetDataSource.updateDownstream(newVal), cancellationToken);\n\t\ttargetDataSource.listenUpstream((newVal) => this.updateUpstream(newVal), cancellationToken);\n\t}\n\n\t/**\n\t * Creates a new datasource that is listening to updates from this datasource and transforms them with a mapper function before fowarding them to itself\n\t * @param mapper mapper function that transforms the data when it flows downwards\n\t * @param reverseMapper mapper function that transforms the data when it flows upwards\n\t * @param cancellationToken  Cancellation token to cancel the subscriptions added to the datasources by this operation\n\t */\n\tpublic map<D>(mapper: (value: T) => D, cancellationToken?: CancellationToken): DataSource<D>;\n\tpublic map<D>(mapper: (value: T) => D, reverseMapper: (value: D) => T, cancellationToken?: CancellationToken): DuplexDataSource<D>;\n\tpublic map<D>(\n\t\tmapper: (value: T) => D,\n\t\treverseMapper?: ((value: D) => T) | CancellationToken,\n\t\tcancellationToken?: CancellationToken\n\t): DataSource<D> | DuplexDataSource<D> {\n\t\tif (typeof reverseMapper === 'function') {\n\t\t\tconst mappedSource = new DuplexDataSource<D>(mapper(this.value), false);\n\n\t\t\tthis.listenDownstream((v) => mappedSource.updateDownstream(mapper(v)), cancellationToken);\n\t\t\tmappedSource.listenUpstream((v) => this.updateUpstream((reverseMapper as any)(v)), cancellationToken);\n\n\t\t\treturn mappedSource;\n\t\t} else {\n\t\t\tconst mappedSource = new DataSource<D>(mapper(this.value));\n\n\t\t\tthis.listenDownstream((v) => mappedSource.update(mapper(v)), reverseMapper as any);\n\n\t\t\treturn mappedSource;\n\t\t}\n\t}\n\n\tpublic listenOnce(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void> {\n\t\treturn this.updateDownstreamEvent.subscribeOnce(callback, cancellationToken).cancel;\n\t}\n\n\t/**\n\t * Returns a promise that resolves when the next update occurs\n\t * @param cancellationToken\n\t */\n\tpublic awaitNextUpdate(cancellationToken?: CancellationToken): Promise<T> {\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.listenOnce((value) => resolve(value), cancellationToken);\n\t\t});\n\t}\n\n\tpublic debounceUpstream(time: number, cancellationToken?: CancellationToken): DuplexDataSource<T> {\n\t\tconst debouncedDataSource = new DuplexDataSource<T>(this.value);\n\t\tlet timeout;\n\n\t\tdebouncedDataSource.listenUpstream((v) => {\n\t\t\tclearTimeout(timeout);\n\t\t\ttimeout = setTimeout(() => {\n\t\t\t\tthis.updateUpstream(v);\n\t\t\t}, time);\n\t\t}, cancellationToken);\n\n\t\tthis.listenDownstream((v) => {\n\t\t\tdebouncedDataSource.updateDownstream(v);\n\t\t}, cancellationToken);\n\n\t\treturn debouncedDataSource;\n\t}\n\n\tpublic debounceDownstream(time: number, cancellationToken?: CancellationToken): DuplexDataSource<T> {\n\t\tconst debouncedDataSource = new DuplexDataSource<T>(this.value);\n\t\tlet timeout;\n\n\t\tthis.listenDownstream((v) => {\n\t\t\tclearTimeout(timeout);\n\t\t\ttimeout = setTimeout(() => {\n\t\t\t\tdebouncedDataSource.updateDownstream(v);\n\t\t\t}, time);\n\t\t}, cancellationToken);\n\n\t\tdebouncedDataSource.listenUpstream((v) => {\n\t\t\tthis.updateUpstream(v);\n\t\t}, cancellationToken);\n\n\t\treturn debouncedDataSource;\n\t}\n\n\t/**\n\t * Creates a new datasource that listens to this one and forwards updates if they are not the same as the last update\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic unique(cancellationToken?: CancellationToken): DuplexDataSource<T> {\n\t\tconst uniqueSource = new DuplexDataSource<T>(this.value, false);\n\n\t\tthis.listenDownstream((v) => {\n\t\t\tif (uniqueSource.value !== v) {\n\t\t\t\tuniqueSource.updateDownstream(v);\n\t\t\t}\n\t\t}, cancellationToken);\n\n\t\tuniqueSource.listenUpstream((v) => {\n\t\t\tif (this.value !== v) {\n\t\t\t\tthis.updateUpstream(v);\n\t\t\t}\n\t\t}, cancellationToken);\n\n\t\treturn uniqueSource;\n\t}\n\n\t/**\n\t * Allows flow of data only in one direction\n\t * @param direction direction of the dataflow that is allowed\n\t * @param cancellationToken  Cancellation token to cancel the subscriptions the new datasource has to the two parent datasources\n\t */\n\tpublic oneWayFlow(direction: DataFlow = DataFlow.DOWNSTREAM, cancellationToken?: CancellationToken): DuplexDataSource<T> {\n\t\tconst oneWaySource = new DuplexDataSource(this.value, false);\n\n\t\tif (direction === DataFlow.DOWNSTREAM) {\n\t\t\tthis.listenDownstream((v) => oneWaySource.updateDownstream(v), cancellationToken);\n\t\t\toneWaySource.updateUpstream = () => void 0;\n\t\t} else {\n\t\t\toneWaySource.listenUpstream((v) => this.updateUpstream(v));\n\t\t\toneWaySource.updateDownstream = () => void 0;\n\t\t}\n\n\t\treturn oneWaySource;\n\t}\n\n\t/**\n\t * Creates a new datasource that listens to this source and combines all updates into a single value\n\t * @param reducer  function that aggregates an update with the previous result of aggregation\n\t * @param initialValue initial value given to the new source\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic reduce(reducer: (p: T, c: T) => T, initialValue: T, cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst reduceSource = new DataSource<T>(initialValue);\n\t\tthis.listen((v) => reduceSource.update(reducer(reduceSource.value, v)), cancellationToken);\n\n\t\treturn reduceSource;\n\t}\n\n\t/**\n\t * Remove all listeners\n\t */\n\tpublic cancelAll(): void {\n\t\tthis.updateDownstreamEvent.cancelAll();\n\t\tthis.updateUpstreamEvent.cancelAll();\n\t}\n}\n","import { DataSource, ReadOnlyDataSource } from '../stream/data_source';\nimport { DuplexDataSource } from '../stream/duplex_data_source';\n\nexport type AttributeValue = string | ReadOnlyDataSource<string> | ReadOnlyDataSource<boolean> | boolean;\nexport type StringSource = string | ReadOnlyDataSource<string>;\nexport type ClassType = string | ReadOnlyDataSource<string> | ReadOnlyDataSource<string[]> | Array<string | ReadOnlyDataSource<string>>;\n/**\n * Type alias for a generic calback taking a parameter and not returning anything\n */\nexport type Callback<T> = (data?: T) => void;\nexport type Delegate = () => void;\nexport type Predicate<T> = (data: T) => boolean;\nexport type Provider<T> = () => T;\nexport type Comparator<T1, T2> = (value1: T1, value2: T2) => boolean;\nexport type Constructor<T> = new (...args: any[]) => T;\nexport type MapLike<T> = { [key: string]: T };\n\nexport type DataDrain<T> = Callback<T> | DataSource<T> | DuplexDataSource<T>;\nexport type ThenArg<T> = T extends PromiseLike<infer U> ? U : T;\n","/**\n * @internal\n */\nexport class LinkedListNode<T> {\n\tpublic next: LinkedListNode<T>;\n\tpublic previous: LinkedListNode<T>;\n\tpublic data: T;\n\n\tconstructor(data: T) {\n\t\tthis.data = data;\n\t}\n\n\tpublic deleteNext() {\n\t\tif (this.next) {\n\t\t\tconst overNext = this.next.next;\n\t\t\tthis.next.next = undefined;\n\t\t\tthis.next.previous = undefined;\n\t\t\tthis.next = overNext;\n\t\t\tif (this.next) {\n\t\t\t\tthis.next.previous = this;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic deletePrevious() {\n\t\tif (this.previous) {\n\t\t\tconst overPrevious = this.previous.previous;\n\t\t\tthis.previous.next = undefined;\n\t\t\tthis.previous.previous = undefined;\n\t\t\tthis.previous = overPrevious;\n\t\t\tif (this.previous) {\n\t\t\t\tthis.previous.next = this;\n\t\t\t}\n\t\t}\n\t}\n}\n","import { LinkedListNode } from './linked_list_node';\nimport { Predicate } from '../common';\n\n/**\n * @internal\n */\nexport class LinkedList<T> {\n\tpublic rootNode: LinkedListNode<T>;\n\tpublic lastNode: LinkedListNode<T>;\n\tpublic length: number;\n\n\tconstructor(data: T[] = []) {\n\t\tthis.length = 0;\n\t\tdata.forEach((d) => this.append(d));\n\t}\n\n\tpublic find(predicate: Predicate<LinkedListNode<T>>): LinkedListNode<T> {\n\t\tlet ptr: LinkedListNode<T> = this.rootNode;\n\t\twhile (ptr && !predicate(ptr)) {\n\t\t\tptr = ptr.next;\n\t\t}\n\n\t\treturn ptr;\n\t}\n\n\tpublic append(element: T): T {\n\t\tif (!this.rootNode && !this.lastNode) {\n\t\t\tthis.rootNode = this.lastNode = new LinkedListNode(element);\n\t\t} else {\n\t\t\tthis.lastNode.next = new LinkedListNode(element);\n\t\t\tthis.lastNode.next.previous = this.lastNode;\n\t\t\tthis.lastNode = this.lastNode.next;\n\t\t}\n\n\t\tthis.length++;\n\t\treturn element;\n\t}\n\n\tpublic forEach(cb: (d: T) => void) {\n\t\tthis.find((n) => {\n\t\t\tcb(n.data);\n\t\t\treturn false;\n\t\t});\n\t}\n\tpublic remove(element: T) {\n\t\tif (element === this.rootNode.data) {\n\t\t\tif (this.rootNode === this.lastNode) {\n\t\t\t\tthis.rootNode = this.lastNode = undefined;\n\t\t\t} else {\n\t\t\t\tthis.rootNode = this.rootNode.next;\n\t\t\t}\n\t\t\tthis.length--;\n\t\t} else {\n\t\t\tconst result = this.find((e) => e.next && e.next.data === element);\n\t\t\tif (result) {\n\t\t\t\tif (result.next === this.lastNode) {\n\t\t\t\t\tthis.lastNode = result;\n\t\t\t\t}\n\t\t\t\tresult.deleteNext();\n\t\t\t\tthis.length--;\n\t\t\t}\n\t\t}\n\t}\n}\n","import { Delegate, Callback } from './common';\nimport { LinkedList } from './linkedlist/linked_list';\n\nexport class CancellationToken {\n\tprivate cancelables: LinkedList<Delegate>;\n\tprivate _isCancelled: boolean;\n\n\tpublic get isCanceled(): boolean {\n\t\treturn this._isCancelled;\n\t}\n\n\tconstructor(...cancellables: Delegate[]) {\n\t\tthis.cancelables = new LinkedList(cancellables);\n\t\tthis._isCancelled = false;\n\t}\n\n\t/**\n\t * Attaches a new cancelable to this token\n\t * @param delegate\n\t */\n\tpublic addCancelable(delegate: Delegate): this {\n\t\tthis.throwIfCancelled('attempting to add cancellable to token that is already cancelled');\n\n\t\tthis.cancelables.append(delegate);\n\n\t\tif (this.cancelables.length > 200) {\n\t\t\tconsole.log('potential memory leak: cancellation token has over 200 clean up calls');\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tpublic removeCancelable(delegate: Delegate): this {\n\t\tthis.throwIfCancelled('attempting to remove cancellable from token that is already cancelled');\n\n\t\tthis.cancelables.remove(delegate);\n\n\t\treturn this;\n\t}\n\n\tpublic addDisposable(disposable: { dispose(): any }): this {\n\t\tthis.addCancelable(() => disposable.dispose());\n\n\t\treturn this;\n\t}\n\n\tpublic callIfNotCancelled(action: Delegate): void {\n\t\tif (!this.isCanceled) {\n\t\t\taction();\n\t\t}\n\t}\n\n\tpublic setTimeout(cb: Delegate, time: number = 0): void {\n\t\tconst id = setTimeout(() => {\n\t\t\tthis.removeCancelable(cancelable);\n\t\t\tcb();\n\t\t}, time);\n\t\tconst cancelable = () => clearTimeout(id);\n\t\tthis.addCancelable(cancelable);\n\t}\n\n\tpublic setInterval(cb: Delegate, time: number): void {\n\t\tconst id = setInterval(cb, time);\n\t\tthis.addCancelable(() => clearInterval(id));\n\t}\n\n\tpublic requestAnimationFrame(cb: Callback<number>): void {\n\t\tconst id: number = requestAnimationFrame(() => {\n\t\t\tthis.removeCancelable(cancelable);\n\t\t\tcb();\n\t\t});\n\t\tconst cancelable = () => cancelAnimationFrame(id);\n\t\tthis.addCancelable(cancelable);\n\t}\n\n\tpublic animationLoop(cb: Callback<number>): void {\n\t\tlet id: number = requestAnimationFrame(function f(time: number) {\n\t\t\tcb(time);\n\t\t\tid = requestAnimationFrame(f);\n\t\t});\n\n\t\tthis.addCancelable(() => cancelAnimationFrame(id));\n\t}\n\n\tpublic throwIfCancelled(msg: string): void {\n\t\tif (this.isCanceled) {\n\t\t\tthrow new Error(msg || 'cancellation token is cancelled');\n\t\t}\n\t}\n\n\tpublic chain(target: CancellationToken, twoWays: boolean = false): CancellationToken {\n\t\tif (twoWays) {\n\t\t\ttarget.chain(this, false);\n\t\t}\n\n\t\tthis.addCancelable(() => target.cancel());\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Registers an event using addEventListener and if you cancel the token the event will be canceled as well\n\t */\n\tpublic registerDomEvent(eventEmitter: HTMLElement | Document, event: string, callback: (e: Event) => void): this {\n\t\t(eventEmitter as HTMLElement).addEventListener(event, callback);\n\t\tthis.addCancelable(() => eventEmitter.removeEventListener(event, callback));\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Cancels everything attached to this token\n\t */\n\tpublic cancel(): void {\n\t\tif (this.isCanceled) {\n\t\t\treturn;\n\t\t}\n\t\tthis._isCancelled = true;\n\t\tthis.cancelables.forEach((c) => c());\n\t\tthis.cancelables = undefined;\n\t}\n}\n","import { CancellationToken } from '../utilities/cancellation_token';\nimport { Callback, ThenArg, Predicate } from '../utilities/common';\nimport { EventEmitter } from '../utilities/event_emitter';\n\nexport interface ReadOnlyDataSource<T> {\n\treadonly value: T;\n\tlistenAndRepeat(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void>;\n\tlisten(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void>;\n\tlistenOnce(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void>;\n\tfilter(callback: (newValue: T, oldValue: T) => boolean, cancellationToken?: CancellationToken): ReadOnlyDataSource<T>;\n\tunique(cancellationToken?: CancellationToken): ReadOnlyDataSource<T>;\n\tmap<D>(callback: (value: T) => D, cancellationToken?: CancellationToken): ReadOnlyDataSource<D>;\n\treduce(reducer: (p: T, c: T) => T, initialValue: T, cancellationToken?: CancellationToken): ReadOnlyDataSource<T>;\n\tawaitNextUpdate(cancellationToken?: CancellationToken): Promise<T>;\n}\n\n/**\n * Datasources wrap a value and allow you to update it in an observable way. Datasources can be manipulated like streams and can be bound directly in the JSX syntax and will update the html whenever the value changes\n */\nexport class DataSource<T> implements ReadOnlyDataSource<T> {\n\t/**\n\t * The current value of this data source, can be changed through update\n\t */\n\tpublic value: T;\n\tprivate primed: boolean;\n\tprivate updating: boolean;\n\tprivate updateEvent: EventEmitter<T>;\n\n\tconstructor(initialValue?: T) {\n\t\tthis.value = initialValue;\n\t\tthis.primed = initialValue !== undefined;\n\t\tthis.updateEvent = new EventEmitter();\n\t}\n\n\t/**\n\t * Updates the value in the data source and calls the listen callback for all listeners\n\t * @param newValue new value for the data source\n\t */\n\tpublic update(newValue: T): void {\n\t\tthis.primed = true;\n\t\tif (this.updating) {\n\t\t\tthrow new Error(\n\t\t\t\t'Problem in datas source: Unstable value propagation, when updating a value the stream was updated back as a direct response. This can lead to infinite loops and is therefore not allowed'\n\t\t\t);\n\t\t}\n\t\tthis.updating = true;\n\t\tthis.value = newValue;\n\t\tthis.updateEvent.fire(newValue);\n\t\tthis.updating = false;\n\t}\n\n\t/**\n\t * Same as listen but will immediately call the callback with the current value first\n\t * @param callback Callback to call when value is updated\n\t * @param cancellationToken Optional token to control the cancellation of the subscription\n\t * @returns Cancellation callback, can be used to cancel subscription without a cancellation token\n\t */\n\tpublic listenAndRepeat(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void> {\n\t\tcallback(this.value);\n\t\treturn this.listen(callback, cancellationToken);\n\t}\n\n\t/**\n\t * Subscribes to the updates of the data stream\n\t * @param callback Callback to call when value is updated\n\t * @param cancellationToken Optional token to control the cancellation of the subscription\n\t * @returns Cancellation callback, can be used to cancel subscription without a cancellation token\n\t */\n\tpublic listen(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void> {\n\t\treturn this.updateEvent.subscribe(callback, cancellationToken).cancel;\n\t}\n\n\t/**\n\t * Subscribes to the updates of the data stream for a single update\n\t * @param callback Callback to call when value is updated\n\t * @param cancellationToken Optional token to control the cancellation of the subscription\n\t * @returns Cancellation callback, can be used to cancel subscription without a cancellation token\n\t */\n\tpublic listenOnce(callback: Callback<T>, cancellationToken?: CancellationToken): Callback<void> {\n\t\treturn this.updateEvent.subscribeOnce(callback, cancellationToken).cancel;\n\t}\n\n\t/**\n\t * Creates a new datasource that listenes to updates of this datasource but only propagates the updates from this source if they pass a predicate check\n\t * @param callback predicate check to decide if the update from the parent data source is passed down or not\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic filter(callback: (newValue: T, oldValue: T) => boolean, cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst filteredSource = new DataSource<T>();\n\t\tthis.listen((value) => {\n\t\t\tif (callback(value, filteredSource.value)) {\n\t\t\t\tfilteredSource.update(value);\n\t\t\t}\n\t\t}, cancellationToken);\n\t\treturn filteredSource;\n\t}\n\n\t/**\n\t * Creates a new datasource that listenes to updates of this datasource but only propagates the updates from this source if they are larger than the previous value\n\t * In case of strings it checks alphabetical order when deciding what is bigger or smaller\n\t * @param callback predicate check to decide if the update from the parent data source is passed down or not\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic max(cancellationToken?: CancellationToken): DataSource<T> {\n\t\treturn this.filter((newValue, oldValue) => {\n\t\t\tif (typeof newValue === 'string' && typeof oldValue === 'string') {\n\t\t\t\treturn newValue.localeCompare(oldValue) > 0;\n\t\t\t} else {\n\t\t\t\treturn newValue > oldValue;\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Creates a new datasource that listenes to updates of this datasource but only propagates the updates from this source if they are smaller than the previous value\n\t * In case of strings it checks alphabetical order when deciding what is bigger or smaller\n\t * @param callback predicate check to decide if the update from the parent data source is passed down or not\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic min(cancellationToken?: CancellationToken): DataSource<T> {\n\t\treturn this.filter((newValue, oldValue) => {\n\t\t\tif (typeof newValue === 'string' && typeof oldValue === 'string') {\n\t\t\t\treturn newValue.localeCompare(oldValue) < 0;\n\t\t\t} else {\n\t\t\t\treturn newValue < oldValue;\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Forwards all updates from this source to another\n\t * @param targetDataSource datasource to pipe the updates to\n\t * @param cancellationToken  Cancellation token to cancel the subscription the target datasource has to this datasource\n\t */\n\tpublic pipe(targetDataSource: DataSource<T>, cancellationToken?: CancellationToken): void {\n\t\tthis.listen((v) => targetDataSource.update(v), cancellationToken);\n\t}\n\n\t/**\n\t * Creates a new datasource that is listening to updates from this datasource and transforms them with a mapper function before fowarding them to itself\n\t * @param callback mapper function that transforms the updates of this source\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic map<D>(callback: (value: T) => D, cancellationToken?: CancellationToken): DataSource<D> {\n\t\tlet mappedSource;\n\t\tif (this.primed) {\n\t\t\tmappedSource = new DataSource<D>(callback(this.value));\n\t\t} else {\n\t\t\tmappedSource = new DataSource<D>();\n\t\t}\n\t\tthis.listen((value) => {\n\t\t\tmappedSource.update(callback(value));\n\t\t}, cancellationToken);\n\t\treturn mappedSource;\n\t}\n\n\t/**\n\t * Allows tapping into the stream and calls a function for each value.\n\t */\n\tpublic tap(callback: (value: T) => void, cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst tapSource = new DataSource<T>(this.value);\n\t\tthis.listen((value) => {\n\t\t\tcallback(value);\n\t\t\ttapSource.update(value);\n\t\t}, cancellationToken);\n\t\treturn tapSource;\n\t}\n\n\t/**\n\t * Creates a new datasource that is listening to updates from this datasource and transforms them with a mapper function before fowarding them to itself\n\t * @param callback mapper function that transforms the updates of this source\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic await<R extends ThenArg<T>>(cancellationToken?: CancellationToken): DataSource<R> {\n\t\tconst mappedSource = new DataSource<R>();\n\t\tthis.listen(async (value) => {\n\t\t\tmappedSource.update(await (value as any));\n\t\t}, cancellationToken);\n\t\treturn mappedSource;\n\t}\n\n\t/**\n\t * Creates a new datasource that listens to this one and forwards updates if they are not the same as the last update\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic unique(cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst uniqueSource = new DataSource<T>(this.value);\n\t\tthis.listen((value) => {\n\t\t\tif (value !== uniqueSource.value) {\n\t\t\t\tuniqueSource.update(value);\n\t\t\t}\n\t\t}, cancellationToken);\n\t\treturn uniqueSource;\n\t}\n\n\t/**\n\t * Creates a new datasource that listens to this one and forwards updates revealing the previous value on each update\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic diff(cancellationToken?: CancellationToken): DataSource<{ new: T; old: T }> {\n\t\tconst diffingSource = new DataSource({\n\t\t\tnew: this.value,\n\t\t\told: undefined\n\t\t});\n\t\tthis.listen((value) => {\n\t\t\tdiffingSource.update({\n\t\t\t\tnew: value,\n\t\t\t\told: diffingSource.value\n\t\t\t});\n\t\t}, cancellationToken);\n\t\treturn diffingSource;\n\t}\n\n\t/**\n\t * Creates a new datasource that listens to this source and combines all updates into a single value\n\t * @param reducer  function that aggregates an update with the previous result of aggregation\n\t * @param initialValue initial value given to the new source\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic reduce(reducer: (p: T, c: T) => T, initialValue: T, cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst reduceSource = new DataSource<T>(initialValue);\n\t\tthis.listen((v) => reduceSource.update(reducer(reduceSource.value, v)), cancellationToken);\n\n\t\treturn reduceSource;\n\t}\n\n\t/**\n\t * Combines two sources into a third source that listens to updates from both parent sources.\n\t * @param otherSource Second parent for the new source\n\t * @param combinator Method allowing you to combine the data from both parents on update. Called each time a parent is updated with the latest values of both parents\n\t * @param cancellationToken  Cancellation token to cancel the subscriptions the new datasource has to the two parent datasources\n\t */\n\tpublic aggregate<D, E>(otherSource: DataSource<D>, combinator: (self: T, other: D) => E, cancellationToken?: CancellationToken): DataSource<E> {\n\t\tconst aggregatedSource = new DataSource<E>(combinator(this.value, otherSource.value));\n\n\t\tthis.listen(() => aggregatedSource.update(combinator(this.value, otherSource.value)), cancellationToken);\n\t\totherSource.listen(() => aggregatedSource.update(combinator(this.value, otherSource.value)), cancellationToken);\n\n\t\treturn aggregatedSource;\n\t}\n\n\t/**\n\t * Combines three sources into a fourth source that listens to updates from all parent sources.\n\t * @param second Second parent for the new source\n\t * @param third Third parent for the new source\n\t * @param combinator Method allowing you to combine the data from all parents on update. Called each time a parent is updated with the latest values of all parents\n\t * @param cancellationToken  Cancellation token to cancel the subscriptions the new datasource has to the parent datasources\n\t */\n\tpublic aggregateThree<D, E, F>(\n\t\tsecond: DataSource<D>,\n\t\tthird: DataSource<E>,\n\t\tcombinator: (self: T, second: D, third: E) => F,\n\t\tcancellationToken?: CancellationToken\n\t): DataSource<F> {\n\t\tconst aggregatedSource = new DataSource<F>(combinator(this.value, second.value, third.value));\n\n\t\tthis.listen(() => aggregatedSource.update(combinator(this.value, second.value, third.value)), cancellationToken);\n\t\tsecond.listen(() => aggregatedSource.update(combinator(this.value, second.value, third.value)), cancellationToken);\n\t\tthird.listen(() => aggregatedSource.update(combinator(this.value, second.value, third.value)), cancellationToken);\n\n\t\treturn aggregatedSource;\n\t}\n\n\t/**\n\t * Combines four sources into a fifth source that listens to updates from all parent sources.\n\t * @param second Second parent for the new source\n\t * @param third Third parent for the new source\n\t * @param fourth Fourth parent for the new source\n\t * @param combinator Method allowing you to combine the data from all parents on update. Called each time a parent is updated with the latest values of all parents\n\t * @param cancellationToken  Cancellation token to cancel the subscriptions the new datasource has to the parent datasources\n\t */\n\tpublic aggregateFour<D, E, F, G>(\n\t\tsecond: DataSource<D>,\n\t\tthird: DataSource<E>,\n\t\tfourth: DataSource<F>,\n\t\tcombinator: (self: T, second: D, third: E, fourth: F) => G,\n\t\tcancellationToken?: CancellationToken\n\t): DataSource<G> {\n\t\tconst aggregatedSource = new DataSource<G>(combinator(this.value, second.value, third.value, fourth.value));\n\n\t\tthis.listen(() => aggregatedSource.update(combinator(this.value, second.value, third.value, fourth.value)), cancellationToken);\n\t\tsecond.listen(() => aggregatedSource.update(combinator(this.value, second.value, third.value, fourth.value)), cancellationToken);\n\t\tthird.listen(() => aggregatedSource.update(combinator(this.value, second.value, third.value, fourth.value)), cancellationToken);\n\t\tfourth.listen(() => aggregatedSource.update(combinator(this.value, second.value, third.value, fourth.value)), cancellationToken);\n\n\t\treturn aggregatedSource;\n\t}\n\n\t/**\n\t * Creates a new datasource that listens to this source and creates a string that contains all the updates with a seperator\n\t * @param seperator string to be placed between all the values\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic stringJoin(seperator: string, cancellationToken?: CancellationToken): DataSource<string> {\n\t\tconst joinSource = new DataSource<string>('');\n\t\tthis.listen((v) => joinSource.update(joinSource.value + seperator + v.toString()), cancellationToken);\n\n\t\treturn joinSource;\n\t}\n\n\t/**\n\t * Like aggregate except that no combination method is needed as a result both parents must have the same type and the new stream just exposes the last update recieved from either parent\n\t * @param otherSource Second parent for the new source\n\t * @param cancellationToken  Cancellation token to cancel the subscriptions the new datasource has to the two parent datasources\n\t */\n\tpublic combine(otherSources: DataSource<T>[], cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst combinedDataSource = new DataSource<T>();\n\t\tthis.pipe(combinedDataSource, cancellationToken);\n\t\tfor (const otherSource of otherSources) {\n\t\t\totherSource.pipe(combinedDataSource, cancellationToken);\n\t\t}\n\n\t\treturn combinedDataSource;\n\t}\n\n\t/**\n\t * Creates a datasource that forwards all the updates after a certain time has passed, useful to introduce a delay before something triggers. Does not debounce\n\t * @param time\n\t * @param cancellationToken\n\t */\n\tpublic delay(time: number, cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst delayedDataSource = new DataSource<T>(this.value);\n\n\t\tthis.listen((v) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tdelayedDataSource.update(v);\n\t\t\t}, time);\n\t\t}, cancellationToken);\n\n\t\treturn delayedDataSource;\n\t}\n\n\t/**\n\t * Creates a datasource that forwards all the updates after a certain amount of updates have been ignored, Useful to create a stream that ignores some initialization noise\n\t * @param amount\n\t * @param cancellationToken\n\t */\n\tpublic skip(amount: number, cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst delayedDataSource = new DataSource<T>(this.value);\n\n\t\tthis.listen((v) => {\n\t\t\tif (amount === 0) {\n\t\t\t\tdelayedDataSource.update(v);\n\t\t\t} else {\n\t\t\t\tamount--;\n\t\t\t}\n\t\t}, cancellationToken);\n\n\t\treturn delayedDataSource;\n\t}\n\n\t/**\n\t * Creates a datasource that forwards up to a certain amount of updates, Useful to create a stream that shuts down after a cap has been reached\n\t * @param amount\n\t * @param cancellationToken\n\t */\n\tpublic cutoff(amount: number, cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst delayedDataSource = new DataSource<T>(this.value);\n\n\t\tthis.listen((v) => {\n\t\t\tif (amount-- > 0) {\n\t\t\t\tdelayedDataSource.update(v);\n\t\t\t}\n\t\t}, cancellationToken);\n\n\t\treturn delayedDataSource;\n\t}\n\n\t/**\n\t * Returns a promise that resolves when the next update occurs\n\t * @param cancellationToken\n\t */\n\tpublic awaitNextUpdate(cancellationToken?: CancellationToken): Promise<T> {\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.listenOnce((value) => resolve(value), cancellationToken);\n\t\t});\n\t}\n\n\t/**\n\t * Creates a new source that listens to the updates of this source and forwards them to itself with a delay, in case many updates happen during this delay only the last update will be taken into account, effectively allowing to skip short lived values. Useful for optimizations\n\t * @param time Milliseconds to wait before updating\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic debounce(time: number, cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst debouncedDataSource = new DataSource<T>(this.value);\n\t\tlet timeout;\n\n\t\tthis.listen((v) => {\n\t\t\tclearTimeout(timeout);\n\t\t\ttimeout = setTimeout(() => {\n\t\t\t\tdebouncedDataSource.update(v);\n\t\t\t}, time);\n\t\t}, cancellationToken);\n\n\t\treturn debouncedDataSource;\n\t}\n\n\t/**\n\t * Creates a new source that listens to the updates of this source and forwards them to itself at most once per <time> milliseconds. In case many updates happen during the delay time only at most one update per delay will be taken into account,\n\t * effectively allowing to reduce load on the next stream. Useful for optimizations\n\t * @param time Milliseconds of cooldown after an update before another update can happen\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic throttle(time: number, cancellationToken?: CancellationToken): DataSource<T> {\n\t\tconst throttledDataSource = new DataSource<T>(this.value);\n\t\tlet cooldown = false;\n\n\t\tthis.listen((v) => {\n\t\t\tif (!cooldown) {\n\t\t\t\tthrottledDataSource.update(v);\n\t\t\t\tcooldown = true;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tcooldown = false;\n\t\t\t\t}, time);\n\t\t\t}\n\t\t}, cancellationToken);\n\n\t\treturn throttledDataSource;\n\t}\n\n\t/**\n\t * Creates a new source that listens to the updates of this source. The updates are collected in an array for a period of time and then the new source updates with an array of all the updates collected in the timespan. Useful to take a rapidly changing source and process it a buffered manner. Can be used for things like batching network requests\n\t * @param time Milliseconds to wait before updating the returned source\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic buffer(time: number, cancellationToken?: CancellationToken): DataSource<T[]> {\n\t\tconst bufferedDataSource = new DataSource<T[]>();\n\t\tlet timeout;\n\t\tlet buffer = [];\n\n\t\tthis.listen((v) => {\n\t\t\tbuffer.push(v);\n\t\t\tif (!timeout) {\n\t\t\t\ttimeout = setTimeout(() => {\n\t\t\t\t\ttimeout = undefined;\n\t\t\t\t\tbufferedDataSource.update(buffer);\n\t\t\t\t\tbuffer = [];\n\t\t\t\t}, time);\n\t\t\t}\n\t\t}, cancellationToken);\n\n\t\treturn bufferedDataSource;\n\t}\n\n\t/**\n\t * Creates a new datasource that listens to the updates of this one. The datasource will accumulate all the updates from this source in form of an array data source. Useful to keep a history of all values from a source\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic accumulate(cancellationToken?: CancellationToken): ArrayDataSource<T> {\n\t\tconst queueDataSource = new ArrayDataSource<T>();\n\n\t\tthis.listen((v) => {\n\t\t\tqueueDataSource.push(v);\n\t\t}, cancellationToken);\n\n\t\treturn queueDataSource;\n\t}\n\n\t/**\n\t * Creates a new datasource that listens to the updates of this source and forwards only a single key from the object that is held by this data source\n\t * @param key key to take from the object\n\t * @param cancellationToken  Cancellation token to cancel the subscription the new datasource has to this datasource\n\t */\n\tpublic pick(key: keyof T, cancellationToken?: CancellationToken): DataSource<T[typeof key]> {\n\t\tconst subDataSource: DataSource<T[typeof key]> = new DataSource(this.value?.[key]);\n\n\t\tthis.listen((v) => {\n\t\t\tif (v !== undefined && v !== null) {\n\t\t\t\tsubDataSource.update(v[key]);\n\t\t\t} else {\n\t\t\t\tsubDataSource.update(v as null | undefined);\n\t\t\t}\n\t\t}, cancellationToken);\n\n\t\treturn subDataSource;\n\t}\n\n\t/**\n\t * Remove all listeners\n\t */\n\tpublic cancelAll(): void {\n\t\tthis.updateEvent.cancelAll();\n\t}\n}\n\nexport interface CollectionChange<T> {\n\toperation: 'replace' | 'swap' | 'add' | 'remove' | 'merge';\n\toperationDetailed: 'replace' | 'append' | 'prepend' | 'removeRight' | 'removeLeft' | 'remove' | 'swap' | 'clear' | 'merge';\n\tcount?: number;\n\tindex: number;\n\tindex2?: number;\n\ttarget?: T;\n\titems: T[];\n\tnewState: T[];\n\tpreviousState?: T[];\n}\nexport class ArrayDataSource<T> {\n\tprotected data: T[];\n\tprivate updateEvent: EventEmitter<CollectionChange<T>>;\n\tprivate lengthSource: DataSource<number>;\n\n\tconstructor(initialData?: T[]) {\n\t\tif (initialData) {\n\t\t\tthis.data = initialData.slice();\n\t\t} else {\n\t\t\tthis.data = [];\n\t\t}\n\t\tthis.lengthSource = new DataSource(this.data.length).unique();\n\t\tthis.updateEvent = new EventEmitter();\n\t}\n\n\t/**\n\t * Same as listen but will immediately call the callback with an append of all existing elements first\n\t */\n\tpublic listenAndRepeat(callback: Callback<CollectionChange<T>>, cancellationToken?: CancellationToken): Callback<void> {\n\t\tcallback({\n\t\t\toperation: 'add',\n\t\t\toperationDetailed: 'append',\n\t\t\tindex: 0,\n\t\t\titems: this.data,\n\t\t\tnewState: this.data,\n\t\t\tcount: this.data.length\n\t\t});\n\t\treturn this.listen(callback, cancellationToken);\n\t}\n\n\tpublic listen(callback: Callback<CollectionChange<T>>, cancellationToken?: CancellationToken): Callback<void> {\n\t\treturn this.updateEvent.subscribe(callback, cancellationToken).cancel;\n\t}\n\n\tpublic listenOnce(callback: Callback<CollectionChange<T>>, cancellationToken?: CancellationToken): Callback<void> {\n\t\treturn this.updateEvent.subscribeOnce(callback, cancellationToken).cancel;\n\t}\n\n\t/**\n\t * Returns a promise that resolves when the next update occurs\n\t * @param cancellationToken\n\t */\n\tpublic awaitNextUpdate(cancellationToken?: CancellationToken): Promise<CollectionChange<T>> {\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.listenOnce((value) => resolve(value), cancellationToken);\n\t\t});\n\t}\n\n\tpublic get length(): DataSource<number> {\n\t\treturn this.lengthSource;\n\t}\n\n\tpublic getData(): T[] {\n\t\treturn this.data.slice();\n\t}\n\n\tpublic get(index: number): T {\n\t\treturn this.data[index];\n\t}\n\n\tpublic set(index: number, item: T): void {\n\t\tconst old = this.data[index];\n\t\tif (old === item) {\n\t\t\treturn;\n\t\t}\n\t\tthis.data[index] = item;\n\t\tthis.update({ operation: 'replace', operationDetailed: 'replace', target: old, count: 1, index, items: [item], newState: this.data });\n\t\tthis.lengthSource.update(this.data.length);\n\t}\n\n\tpublic swap(indexA: number, indexB: number): void {\n\t\tif (indexA === indexB) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemA = this.data[indexA];\n\t\tconst itemB = this.data[indexB];\n\t\tthis.data[indexB] = itemA;\n\t\tthis.data[indexA] = itemB;\n\n\t\tthis.update({ operation: 'swap', operationDetailed: 'swap', index: indexA, index2: indexB, items: [itemA, itemB], newState: this.data });\n\t\tthis.lengthSource.update(this.data.length);\n\t}\n\n\tpublic swapItems(itemA: T, itemB: T): void {\n\t\tif (itemA === itemB) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst indexA = this.data.indexOf(itemA);\n\t\tconst indexB = this.data.indexOf(itemB);\n\t\tif (indexA !== -1 && indexB !== -1) {\n\t\t\tthis.data[indexB] = itemA;\n\t\t\tthis.data[indexA] = itemB;\n\t\t}\n\n\t\tthis.update({ operation: 'swap', operationDetailed: 'swap', index: indexA, index2: indexB, items: [itemA, itemB], newState: this.data });\n\t\tthis.lengthSource.update(this.data.length);\n\t}\n\n\tpublic appendArray(items: T[]) {\n\t\tconst old = this.data;\n\t\tthis.data = new Array(old.length);\n\t\tlet i = 0;\n\t\tfor (i = 0; i < old.length; i++) {\n\t\t\tthis.data[i] = old[i];\n\t\t}\n\n\t\tfor (let n = 0; n < items.length; n++) {\n\t\t\tthis.data[i + n] = items[n];\n\t\t}\n\n\t\tthis.update({\n\t\t\toperation: 'add',\n\t\t\toperationDetailed: 'append',\n\t\t\tcount: items.length,\n\t\t\tindex: this.data.length - items.length,\n\t\t\titems,\n\t\t\tnewState: this.data\n\t\t});\n\t\tthis.lengthSource.update(this.data.length);\n\t}\n\n\tpublic push(...items: T[]) {\n\t\tthis.appendArray(items);\n\t}\n\n\tpublic unshift(...items: T[]) {\n\t\tthis.data.unshift(...items);\n\t\tthis.update({ operation: 'add', operationDetailed: 'prepend', count: items.length, items, index: 0, newState: this.data });\n\t\tthis.lengthSource.update(this.data.length);\n\t}\n\n\tpublic pop(): T {\n\t\tconst item = this.data.pop();\n\n\t\tthis.update({\n\t\t\toperation: 'remove',\n\t\t\toperationDetailed: 'removeRight',\n\t\t\tcount: 1,\n\t\t\tindex: this.data.length,\n\t\t\titems: [item],\n\t\t\tnewState: this.data\n\t\t});\n\n\t\tthis.lengthSource.update(this.data.length);\n\t\treturn item;\n\t}\n\n\tpublic merge(newData: T[]): void {\n\t\tconst old = this.data;\n\t\tthis.data = newData.slice();\n\n\t\tthis.update({\n\t\t\toperation: 'merge',\n\t\t\toperationDetailed: 'merge',\n\t\t\tpreviousState: old,\n\t\t\tindex: 0,\n\t\t\titems: this.data,\n\t\t\tnewState: this.data\n\t\t});\n\t\tthis.lengthSource.update(this.data.length);\n\t}\n\n\tpublic removeRight(count: number): void {\n\t\tconst length = this.data.length;\n\t\tconst result = this.data.splice(length - count, count);\n\t\tthis.update({ operation: 'remove', operationDetailed: 'removeRight', count, index: length - count, items: result, newState: this.data });\n\t\tthis.lengthSource.update(this.data.length);\n\t}\n\n\tpublic removeLeft(count: number): void {\n\t\tconst result = this.data.splice(0, count);\n\t\tthis.update({ operation: 'remove', operationDetailed: 'removeLeft', count, index: 0, items: result, newState: this.data });\n\t\tthis.lengthSource.update(this.data.length);\n\t}\n\tpublic remove(item: T): void {\n\t\tconst index = this.data.indexOf(item);\n\t\tif (index !== -1) {\n\t\t\tthis.data.splice(index, 1);\n\t\t\tthis.update({ operation: 'remove', operationDetailed: 'remove', count: 1, index, items: [item], newState: this.data });\n\t\t\tthis.lengthSource.update(this.data.length);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tconst items = this.data;\n\t\tthis.data = [];\n\t\tthis.update({\n\t\t\toperation: 'remove',\n\t\t\toperationDetailed: 'clear',\n\t\t\tcount: items.length,\n\t\t\tindex: 0,\n\t\t\titems,\n\t\t\tnewState: this.data\n\t\t});\n\t\tthis.lengthSource.update(this.data.length);\n\t}\n\n\tpublic shift(): T {\n\t\tconst item = this.data.shift();\n\t\tthis.update({ operation: 'remove', operationDetailed: 'removeLeft', items: [item], count: 1, index: 0, newState: this.data });\n\t\tthis.lengthSource.update(this.data.length);\n\n\t\treturn item;\n\t}\n\n\tpublic toArray(): T[] {\n\t\treturn this.data.slice();\n\t}\n\n\tpublic sort(comparator: (a: T, b: T) => number, dependencies: ReadOnlyDataSource<any>[] = [], cancellationToken?: CancellationToken): SortedArrayView<T> {\n\t\tconst view = new SortedArrayView(this, comparator, cancellationToken);\n\t\tdependencies.forEach((dep) => {\n\t\t\tdep.listen(() => view.refresh());\n\t\t});\n\n\t\treturn view;\n\t}\n\n\tpublic map<D>(mapper: (data: T) => D, dependencies: ReadOnlyDataSource<any>[] = [], cancellationToken?: CancellationToken): MappedArrayView<T, D> {\n\t\tconst view = new MappedArrayView<T, D>(this, mapper, cancellationToken);\n\t\tdependencies.forEach((dep) => {\n\t\t\tdep.listen(() => view.refresh());\n\t\t});\n\n\t\treturn view;\n\t}\n\n\tpublic filter(callback: Predicate<T>, dependencies: ReadOnlyDataSource<any>[] = [], cancellationToken?: CancellationToken): FilteredArrayView<T> {\n\t\tconst view = new FilteredArrayView(this, callback, cancellationToken);\n\t\tdependencies.forEach((dep) => {\n\t\t\tdep.listen(() => view.refresh());\n\t\t});\n\n\t\treturn view;\n\t}\n\n\tpublic forEach(callbackfn: (value: T, index: number, array: T[]) => void): void {\n\t\treturn this.data.forEach(callbackfn);\n\t}\n\n\tprotected update(change: CollectionChange<T>) {\n\t\tthis.updateEvent.fire(change);\n\t}\n}\n\nexport class MappedArrayView<D, T> extends ArrayDataSource<T> {\n\tprivate parent: ArrayDataSource<D>;\n\tprivate mapper: (a: D) => T;\n\n\tconstructor(parent: ArrayDataSource<D>, mapper: (a: D) => T, cancellationToken?: CancellationToken) {\n\t\tconst initial = parent.getData().map(mapper);\n\t\tsuper(initial);\n\t\tthis.parent = parent;\n\t\tthis.mapper = mapper;\n\n\t\tparent.listen((change) => {\n\t\t\tswitch (change.operationDetailed) {\n\t\t\t\tcase 'removeLeft':\n\t\t\t\t\tthis.removeLeft(change.count);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'removeRight':\n\t\t\t\t\tthis.removeRight(change.count);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'remove':\n\t\t\t\t\tthis.remove(this.data[change.index]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'clear':\n\t\t\t\t\tthis.clear();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'prepend':\n\t\t\t\t\tthis.unshift(...change.items.map(this.mapper));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'append':\n\t\t\t\t\tthis.appendArray(change.items.map(this.mapper));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'swap':\n\t\t\t\t\tthis.swap(change.index, change.index2);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'replace':\n\t\t\t\t\tthis.set(change.index, this.mapper(change.items[0]));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'merge':\n\t\t\t\t\tconst old = this.data.slice();\n\t\t\t\t\tconst source = change.previousState.slice();\n\t\t\t\t\tfor (let i = 0; i < change.newState.length; i++) {\n\t\t\t\t\t\tif (this.data.length <= i) {\n\t\t\t\t\t\t\tthis.data.push(this.mapper(change.newState[i]));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (source[i] !== change.newState[i]) {\n\t\t\t\t\t\t\tconst index = source.indexOf(change.newState[i]);\n\t\t\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\t\t\tconst a = this.data[i];\n\t\t\t\t\t\t\t\tconst b = this.data[index];\n\t\t\t\t\t\t\t\tthis.data[i] = b;\n\t\t\t\t\t\t\t\tthis.data[index] = a;\n\t\t\t\t\t\t\t\tconst c = source[i];\n\t\t\t\t\t\t\t\tconst d = source[index];\n\t\t\t\t\t\t\t\tsource[i] = d;\n\t\t\t\t\t\t\t\tsource[index] = c;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\t\tthis.data.splice(i, 0, this.mapper(change.newState[i]));\n\t\t\t\t\t\t\t\tsource.splice(i, 0, change.newState[i]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (this.data.length > change.newState.length) {\n\t\t\t\t\t\tthis.data.length = change.newState.length;\n\t\t\t\t\t}\n\t\t\t\t\tthis.update({\n\t\t\t\t\t\toperation: 'merge',\n\t\t\t\t\t\toperationDetailed: 'merge',\n\t\t\t\t\t\tpreviousState: old,\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\titems: this.data,\n\t\t\t\t\t\tnewState: this.data\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}, cancellationToken);\n\t}\n\n\tpublic refresh() {\n\t\t//@ts-ignore\n\t\tthis.merge(this.parent.data.map(this.mapper));\n\t}\n}\n\nexport class SortedArrayView<T> extends ArrayDataSource<T> {\n\tprivate comparator: (a: T, b: T) => number;\n\tprivate parent: ArrayDataSource<T>;\n\n\tconstructor(parent: ArrayDataSource<T>, comparator: (a: T, b: T) => number, cancellationToken?: CancellationToken) {\n\t\tconst initial = parent.getData().sort(comparator);\n\t\tsuper(initial);\n\t\tthis.parent = parent;\n\t\tthis.comparator = comparator;\n\n\t\tparent.listen((change) => {\n\t\t\tswitch (change.operationDetailed) {\n\t\t\t\tcase 'removeLeft':\n\t\t\t\tcase 'removeRight':\n\t\t\t\t\tfor (const item of change.items) {\n\t\t\t\t\t\tthis.remove(item);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'remove':\n\t\t\t\t\tthis.remove(change.items[0]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'clear':\n\t\t\t\t\tthis.clear();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'prepend':\n\t\t\t\t\tthis.unshift(...change.items);\n\t\t\t\t\tthis.data.sort(this.comparator);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'append':\n\t\t\t\t\tthis.appendSorted(change.items);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'merge':\n\t\t\t\t\tthis.merge(change.items.slice().sort(this.comparator));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'swap':\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'replace':\n\t\t\t\t\tthis.remove(change.target);\n\t\t\t\t\tthis.appendSorted(change.items);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}, cancellationToken);\n\t}\n\n\tprivate appendSorted(items: T[]) {\n\t\tthis.merge(this.data.concat(items).sort(this.comparator));\n\t}\n\n\tpublic refresh() {\n\t\tthis.merge(this.parent.getData().sort(this.comparator));\n\t}\n}\n\nexport class FilteredArrayView<T> extends ArrayDataSource<T> {\n\tprivate viewFilter: Predicate<T>;\n\tprivate parent: ArrayDataSource<T>;\n\tconstructor(parent: ArrayDataSource<T> | T[], filter?: Predicate<T>, cancellationToken?: CancellationToken) {\n\t\tif (Array.isArray(parent)) {\n\t\t\tparent = new ArrayDataSource(parent);\n\t\t}\n\t\tfilter = filter ?? (() => true);\n\t\tconst initial = (parent as FilteredArrayView<T>).data.filter(filter);\n\t\tsuper(initial);\n\n\t\tthis.parent = parent;\n\t\tthis.viewFilter = filter;\n\t\tparent.listen((change) => {\n\t\t\tlet filteredItems;\n\t\t\tswitch (change.operationDetailed) {\n\t\t\t\tcase 'clear':\n\t\t\t\t\tthis.clear();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'removeLeft':\n\t\t\t\tcase 'removeRight':\n\t\t\t\tcase 'remove':\n\t\t\t\t\tfor (const item of change.items) {\n\t\t\t\t\t\tthis.remove(item);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'prepend':\n\t\t\t\t\tfilteredItems = change.items.filter(this.viewFilter);\n\t\t\t\t\tthis.unshift(...filteredItems);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'append':\n\t\t\t\t\tfilteredItems = change.items.filter(this.viewFilter);\n\t\t\t\t\tthis.appendArray(filteredItems);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'merge':\n\t\t\t\t\tthis.merge(change.items.filter(this.viewFilter));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'swap':\n\t\t\t\t\tconst indexA = this.data.indexOf(change.items[0]);\n\t\t\t\t\tconst indexB = this.data.indexOf(change.items[1]);\n\t\t\t\t\tif (indexA !== -1 && indexB !== -1) {\n\t\t\t\t\t\tthis.swap(indexA, indexB);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'replace':\n\t\t\t\t\tconst index = this.data.indexOf(change.target);\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tconst acceptNew = this.viewFilter(change.items[0]);\n\t\t\t\t\t\tif (acceptNew) {\n\t\t\t\t\t\t\tthis.set(index, change.items[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.remove(change.target);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}, cancellationToken);\n\t}\n\n\t/**\n\t * Replaces the filter function\n\t * @param filter\n\t * @returns returns new size of array view after applying filter\n\t */\n\tpublic updateFilter(filter: Predicate<T>): number {\n\t\tif (this.viewFilter === filter) {\n\t\t\treturn;\n\t\t}\n\t\tthis.viewFilter = filter;\n\t\tthis.refresh();\n\t\treturn this.data.length;\n\t}\n\n\t/**\n\t * Recalculates the filter. Only needed if your filter function isn't pure and you know the result would be different if run again compared to before\n\t */\n\tpublic refresh() {\n\t\tthis.merge((this.parent as FilteredArrayView<T>).data.filter(this.viewFilter));\n\t}\n}\n","/**\n * @internal\n */\nexport const ownerSymbol = Symbol('owner');\n","import { DataSource } from '../../stream/data_source';\nimport { ownerSymbol } from '../../utilities/owner_symbol';\nimport { StringSource } from '../../utilities/common';\n\n/**\n * @internal\n */\nexport class AurumTextElement {\n\tpublic node: Text;\n\n\tconstructor(text?: StringSource) {\n\t\tthis.node = this.create(text);\n\n\t\tif (text instanceof DataSource) {\n\t\t\ttext.listen((v) => {\n\t\t\t\tif (this.node) {\n\t\t\t\t\tthis.node.textContent = v;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected resolveStringSource(source: StringSource): string {\n\t\tif (typeof source === 'string') {\n\t\t\treturn source;\n\t\t} else {\n\t\t\treturn source.value;\n\t\t}\n\t}\n\n\tprotected create(text?: StringSource): Text {\n\t\tconst node = document.createTextNode(this.resolveStringSource(text));\n\t\tnode[ownerSymbol] = this;\n\t\treturn node;\n\t}\n\n\tpublic remove(): void {\n\t\tif (this.hasParent()) {\n\t\t\tthis.node.parentElement[ownerSymbol].removeChild(this.node);\n\t\t}\n\t}\n\n\tpublic hasParent(): boolean {\n\t\treturn !!this.node.parentElement;\n\t}\n}\n","import { ArrayDataSource, DataSource, ReadOnlyDataSource } from '../../stream/data_source';\nimport { Callback, ClassType, DataDrain, MapLike, AttributeValue } from '../../utilities/common';\nimport { ownerSymbol } from '../../utilities/owner_symbol';\nimport { AurumTextElement } from './aurum_text';\nimport { EventEmitter } from '../../utilities/event_emitter';\nimport { DuplexDataSource } from '../../stream/duplex_data_source';\nimport { CancellationToken } from '../../utilities/cancellation_token';\n\n/**\n * @inernal\n */\nexport const aurumElementModelIdentitiy = Symbol('AurumElementModel');\n\nexport interface AurumElementModel {\n\t[aurumElementModelIdentitiy]: boolean;\n\tconstructor: (props: AurumElementProps<HTMLElement>, innerNodes: ChildNode[]) => AurumElement;\n\tprops: AurumElementProps<HTMLElement>;\n\tinnerNodes: ChildNode[];\n}\n\nexport interface AurumElementProps<T extends HTMLElement> {\n\tid?: AttributeValue;\n\tname?: AttributeValue;\n\tdraggable?: AttributeValue;\n\tclass?: ClassType;\n\ttabindex?: ClassType;\n\tstyle?: AttributeValue;\n\ttitle?: AttributeValue;\n\trole?: AttributeValue;\n\tcontentEditable?: AttributeValue;\n\tonDblclick?: DataDrain<MouseEvent>;\n\tonClick?: DataDrain<MouseEvent>;\n\tonKeydown?: DataDrain<KeyboardEvent>;\n\tonKeyup?: DataDrain<KeyboardEvent>;\n\tonMousedown?: DataDrain<KeyboardEvent>;\n\tonMouseup?: DataDrain<KeyboardEvent>;\n\tonMouseenter?: DataDrain<KeyboardEvent>;\n\tonMouseleave?: DataDrain<KeyboardEvent>;\n\tonMousewheel?: DataDrain<WheelEvent>;\n\tonBlur?: DataDrain<FocusEvent>;\n\tonFocus?: DataDrain<FocusEvent>;\n\tonDrag?: DataDrain<DragEvent>;\n\tonDragend?: DataDrain<DragEvent>;\n\tonDragenter?: DataDrain<DragEvent>;\n\tonDragexit?: DataDrain<DragEvent>;\n\tonDragleave?: DataDrain<DragEvent>;\n\tonDragover?: DataDrain<DragEvent>;\n\tonDragstart?: DataDrain<DragEvent>;\n\tonLoad?: DataDrain<Event>;\n\tonError?: DataDrain<ErrorEvent>;\n\n\tonAttach?: Callback<T>;\n\tonDetach?: Callback<T>;\n\tonCreate?: Callback<T>;\n}\n\n/**\n * @internal\n */\nconst defaultEvents: MapLike<string> = {\n\tdrag: 'onDrag',\n\tdragstart: 'onDragStart',\n\tdragend: 'onDragEnd',\n\tdragexit: 'onDragExit',\n\tdragover: 'onDragOver',\n\tdragenter: 'onDragEnter',\n\tdragleave: 'onDragLeave',\n\tblur: 'onBlur',\n\tfocus: 'onFocus',\n\tclick: 'onClick',\n\tdblclick: 'onDblClick',\n\tkeydown: 'onKeyDown',\n\tkeyhit: 'onKeyHit',\n\tkeyup: 'onKeyUp',\n\tmousedown: 'onMouseDown',\n\tmouseup: 'onMouseUp',\n\tmousemove: 'onMouseMove',\n\tmouseenter: 'onMouseEnter',\n\tmouseleave: 'onMouseLeave',\n\tmousewheel: 'onMouseWheel',\n\tload: 'onLoad',\n\terror: 'onError'\n};\n\n/**\n * @internal\n */\nconst defaultProps: string[] = ['id', 'name', 'draggable', 'tabindex', 'style', 'role', 'contentEditable'];\n\nexport function prerender(model: any): Renderable {\n\tif (model && model[aurumElementModelIdentitiy]) {\n\t\tconst result = model.constructor(model.props, model.innerNodes);\n\t\treturn prerender(result as any);\n\t} else {\n\t\treturn model;\n\t}\n}\n\nexport type Renderable =\n\t| AurumElement\n\t| string\n\t| Promise<Renderable>\n\t| DataSource<string>\n\t| DataSource<AurumElement>\n\t| DataSource<AurumElement[]>\n\t| ArrayDataSource<AurumElement>\n\t| ChildNode[];\n\nexport type ChildNode =\n\t| AurumElementModel\n\t| string\n\t| Promise<ChildNode>\n\t| DataSource<string>\n\t| DataSource<AurumElementModel>\n\t| DataSource<AurumElementModel[]>\n\t| ArrayDataSource<AurumElementModel>\n\t| ChildNode[];\n\nexport abstract class AurumElement {\n\tprivate onAttach?: Callback<HTMLElement>;\n\tprivate onDetach?: Callback<HTMLElement>;\n\n\tprivate children: Array<AurumElement | AurumFragment | AurumTextElement>;\n\tprotected needAttach: boolean;\n\n\tpublic node: HTMLElement;\n\tprivate cleanUp: CancellationToken;\n\n\tconstructor(props: AurumElementProps<any>, children: ChildNode[], domNodeName: string) {\n\t\tthis.node = this.create(domNodeName);\n\t\tthis.children = [];\n\n\t\tif (props != null) {\n\t\t\tif (props.onAttach) {\n\t\t\t\tthis.onAttach = props.onAttach;\n\t\t\t\tthis.needAttach = true;\n\t\t\t}\n\t\t\tthis.onDetach = props.onDetach;\n\n\t\t\tthis.initialize(props);\n\t\t\tprops.onCreate?.(this.node);\n\t\t}\n\t\tif (children) {\n\t\t\tthis.addChildren(children);\n\t\t}\n\t}\n\n\tprivate initialize(props: AurumElementProps<any>) {\n\t\tthis.createEventHandlers(defaultEvents, props);\n\n\t\tconst dataProps = Object.keys(props).filter((e) => e.includes('-'));\n\t\tthis.bindProps(defaultProps, props, dataProps);\n\n\t\tif (props.class) {\n\t\t\tthis.handleClass(props.class);\n\t\t}\n\t}\n\n\tprotected bindProps(keys: string[], props: any, dynamicProps?: string[]) {\n\t\tfor (const key of keys) {\n\t\t\tif (props[key]) {\n\t\t\t\tthis.assignStringSourceToAttribute(props[key], key);\n\t\t\t}\n\t\t}\n\t\tif (dynamicProps) {\n\t\t\tfor (const key of dynamicProps) {\n\t\t\t\tif (props[key]) {\n\t\t\t\t\tthis.assignStringSourceToAttribute(props[key], key);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected createEventHandlers(events: MapLike<string>, props: any) {\n\t\tfor (const key in events) {\n\t\t\tif (props[events[key]]) {\n\t\t\t\tif (props[events[key]] instanceof DataSource) {\n\t\t\t\t\tthis.node.addEventListener(key, (e: Event) => props[events[key]].update(e));\n\t\t\t\t} else if (props[events[key]] instanceof DuplexDataSource) {\n\t\t\t\t\tthis.node.addEventListener(key, (e: Event) => props[events[key]].updateDownstream(e));\n\t\t\t\t} else if (typeof props[events[key]] === 'function') {\n\t\t\t\t\tthis.node.addEventListener(key, (e: Event) => props[events[key]](e));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected render(): void {\n\t\tlet absoluteIndex: number = 0;\n\t\tfor (let i = 0; i < this.children.length; i++, absoluteIndex++) {\n\t\t\tif (this.children[i] instanceof AurumFragment) {\n\t\t\t\tabsoluteIndex = this.renderFragment(this.children[i] as AurumFragment, absoluteIndex);\n\t\t\t} else {\n\t\t\t\tthis.renderChild(this.children[i] as AurumElement, absoluteIndex);\n\t\t\t}\n\t\t}\n\t\twhile (this.node.childNodes.length > absoluteIndex) {\n\t\t\tconst child = this.node.childNodes[this.node.childNodes.length - 1];\n\t\t\tthis.node.removeChild(child);\n\t\t\tchild[ownerSymbol]?.handleDetach?.();\n\t\t}\n\t}\n\n\tprotected renderFragment(fragment: AurumFragment, absoluteIndex: number) {\n\t\tfor (let j = 0; j < fragment.children.length; j++, absoluteIndex++) {\n\t\t\tif (fragment.children[j] instanceof AurumFragment) {\n\t\t\t\tabsoluteIndex = this.renderFragment(fragment.children[j] as AurumFragment, absoluteIndex);\n\t\t\t} else {\n\t\t\t\tthis.renderChild(fragment.children[j] as AurumElement | AurumTextElement, absoluteIndex);\n\t\t\t}\n\t\t}\n\t\tabsoluteIndex--;\n\t\treturn absoluteIndex;\n\t}\n\n\tprivate renderChild(child: AurumElement | AurumTextElement, index: number) {\n\t\tif (this.node.childNodes.length <= index) {\n\t\t\treturn this.addChildDom(child as AurumElement);\n\t\t}\n\t\tif (this.node.childNodes[index][ownerSymbol] !== child) {\n\t\t\tconst childIndex = this.getChildIndex(child.node as any);\n\t\t\tif (childIndex !== -1) {\n\t\t\t\tthis.swapChildrenDom(index, childIndex);\n\t\t\t} else {\n\t\t\t\tthis.addDomNodeAt(child.node, index);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected assignStringSourceToAttribute(data: AttributeValue, key: string) {\n\t\tif (typeof data === 'string' || typeof data === 'boolean') {\n\t\t\tif (typeof data === 'boolean') {\n\t\t\t\tif (data) {\n\t\t\t\t\tthis.node.setAttribute(key, '');\n\t\t\t\t} else {\n\t\t\t\t\tthis.node.removeAttribute(key);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t(this.node as HTMLElement).setAttribute(key, data);\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this.cleanUp) {\n\t\t\t\tthis.cleanUp = new CancellationToken();\n\t\t\t}\n\t\t\tdata.unique(this.cleanUp).listenAndRepeat((v) => {\n\t\t\t\tif (typeof v === 'boolean') {\n\t\t\t\t\tif (v) {\n\t\t\t\t\t\tthis.node.setAttribute(key, '');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.node.removeAttribute(key);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t(this.node as HTMLElement).setAttribute(key, v);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected handleAttach(parent: AurumElement) {\n\t\tif (this.needAttach) {\n\t\t\tif (parent.isConnected()) {\n\t\t\t\tthis.onAttach?.(this.node);\n\t\t\t\tfor (const child of this.node.childNodes) {\n\t\t\t\t\tchild[ownerSymbol]?.handleAttach?.(this);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tparent.needAttach = true;\n\t\t\t}\n\t\t}\n\t}\n\n\t//@ts-ignore\n\tprivate handleDetach() {\n\t\tif (this.cleanUp) {\n\t\t\tthis.cleanUp.cancel();\n\t\t}\n\t\tif (!this.node.isConnected) {\n\t\t\tthis.onDetach?.(this.node);\n\t\t\tfor (const child of this.node.childNodes) {\n\t\t\t\tif (child[ownerSymbol]) {\n\t\t\t\t\tchild[ownerSymbol].handleDetach?.();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate handleClass(data: ClassType) {\n\t\tif (typeof data === 'string') {\n\t\t\tthis.node.className = data;\n\t\t} else if (data instanceof DataSource || data instanceof DuplexDataSource) {\n\t\t\tif (!this.cleanUp) {\n\t\t\t\tthis.cleanUp = new CancellationToken();\n\t\t\t}\n\n\t\t\tif (data.value) {\n\t\t\t\tif (Array.isArray(data.value)) {\n\t\t\t\t\tthis.node.className = data.value.join(' ');\n\t\t\t\t\tdata.unique(this.cleanUp).listen(() => {\n\t\t\t\t\t\t(this.node as HTMLElement).className = (data.value as string[]).join(' ');\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.node.className = data.value;\n\t\t\t\t\tdata.unique(this.cleanUp).listen(() => {\n\t\t\t\t\t\t(this.node as HTMLElement).className = data.value as string;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tdata.unique(this.cleanUp).listen((v) => ((this.node as HTMLElement).className = v));\n\t\t} else {\n\t\t\tconst value: string = (data as Array<string | ReadOnlyDataSource<string>>).reduce<string>((p, c) => {\n\t\t\t\tif (typeof c === 'string') {\n\t\t\t\t\treturn `${p} ${c}`;\n\t\t\t\t} else {\n\t\t\t\t\tif (c.value) {\n\t\t\t\t\t\treturn `${p} ${c.value}`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn p;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, '');\n\t\t\tthis.node.className = value;\n\t\t\tfor (const i of data as Array<string | ReadOnlyDataSource<string>>) {\n\t\t\t\tif (i instanceof DataSource) {\n\t\t\t\t\tif (!this.cleanUp) {\n\t\t\t\t\t\tthis.cleanUp = new CancellationToken();\n\t\t\t\t\t}\n\n\t\t\t\t\ti.unique(this.cleanUp).listen((v) => {\n\t\t\t\t\t\tconst value: string = (data as Array<string | ReadOnlyDataSource<string>>).reduce<string>((p, c) => {\n\t\t\t\t\t\t\tif (typeof c === 'string') {\n\t\t\t\t\t\t\t\treturn `${p} ${c}`;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (c.value) {\n\t\t\t\t\t\t\t\t\treturn `${p} ${c.value}`;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn p;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, '');\n\t\t\t\t\t\t(this.node as HTMLElement).className = value;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected create(domNodeName: string): HTMLElement {\n\t\tconst node = document.createElement(domNodeName);\n\t\tnode[ownerSymbol] = this;\n\t\treturn node;\n\t}\n\n\tprotected getChildIndex(node: HTMLElement): number {\n\t\tlet i = 0;\n\t\tfor (const child of this.node.childNodes) {\n\t\t\tif (child === node) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tprotected hasChild(node: HTMLElement): boolean {\n\t\tfor (const child of node.childNodes) {\n\t\t\tif (child === node) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected addChildDom(child: AurumElement): void {\n\t\tthis.node.appendChild(child.node);\n\t\tchild.handleAttach?.(this);\n\t}\n\n\tprotected swapChildrenDom(indexA: number, indexB: number) {\n\t\tif (indexA === indexB) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst nodeA = this.node.childNodes[indexA];\n\t\tconst nodeB = this.node.childNodes[indexB];\n\t\tnodeA.remove();\n\t\tnodeB.remove();\n\t\tif (indexA < indexB) {\n\t\t\tthis.addDomNodeAt(nodeB as HTMLElement, indexA);\n\t\t\tthis.addDomNodeAt(nodeA as HTMLElement, indexB);\n\t\t} else {\n\t\t\tthis.addDomNodeAt(nodeA as HTMLElement, indexB);\n\t\t\tthis.addDomNodeAt(nodeB as HTMLElement, indexA);\n\t\t}\n\t}\n\n\tprotected addDomNodeAt(node: HTMLElement | Text, index: number): void {\n\t\tif (index >= this.node.childNodes.length) {\n\t\t\tthis.node.appendChild(node);\n\t\t\tnode[ownerSymbol].handleAttach?.(this);\n\t\t} else {\n\t\t\tthis.node.insertBefore(node, this.node.childNodes[index]);\n\t\t\tnode[ownerSymbol].handleAttach?.(this);\n\t\t}\n\t}\n\n\tpublic remove(): void {\n\t\tif (this.hasParent()) {\n\t\t\tthis.node.parentElement[ownerSymbol].removeChild(this.node);\n\t\t}\n\t}\n\n\tpublic hasParent(): boolean {\n\t\treturn !!this.node.parentElement;\n\t}\n\n\tpublic isConnected(): boolean {\n\t\treturn this.node.isConnected;\n\t}\n\n\tpublic removeChild(child: AurumElement): void {\n\t\tconst index = this.children.indexOf(child);\n\t\tif (index !== -1) {\n\t\t\tthis.children.splice(index, 1);\n\t\t}\n\t\tthis.render();\n\t}\n\n\tpublic removeChildAt(index: number): void {\n\t\tthis.children.splice(index, 1);\n\t\tthis.render();\n\t}\n\n\tpublic swapChildren(indexA: number, indexB: number): void {\n\t\tif (indexA === indexB) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst nodeA = this.children[indexA];\n\t\tconst nodeB = this.children[indexB];\n\t\tthis.children[indexA] = nodeB;\n\t\tthis.children[indexB] = nodeA;\n\t\tthis.render();\n\t}\n\n\tpublic clearChildren(): void {\n\t\tthis.children.length = 0;\n\t\tthis.render();\n\t}\n\n\tpublic addChild(child: ChildNode): void {\n\t\tif (child === undefined || child === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (child[aurumElementModelIdentitiy]) {\n\t\t\t//@ts-ignore\n\t\t\tchild = prerender(child as AurumElementModel);\n\t\t\tif (child === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (Array.isArray(child)) {\n\t\t\tfor (const subChild of child) {\n\t\t\t\tthis.addChild(subChild);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tthis.children.push(this.childNodeToAurum(child));\n\t\tthis.render();\n\t}\n\n\tprivate childNodeToAurum(child: ChildNode): AurumElement | AurumFragment | AurumTextElement {\n\t\tif (child instanceof AurumElement) {\n\t\t\treturn child;\n\t\t}\n\n\t\tif (child instanceof Promise) {\n\t\t\tconst result = new AurumFragment({});\n\t\t\t//@ts-ignore\n\t\t\tchild.then((value) => {\n\t\t\t\tresult.addChildren([value]);\n\t\t\t\tthis.render();\n\t\t\t});\n\t\t\treturn result;\n\t\t} else if (child instanceof ArrayDataSource) {\n\t\t\t//@ts-ignore\n\t\t\tconst result = new AurumFragment({ repeatModel: child });\n\t\t\tresult.onChange.subscribe(() => this.render());\n\t\t\treturn result;\n\t\t} else if (typeof child === 'string' || typeof child === 'number' || typeof child === 'boolean' || typeof child === 'bigint') {\n\t\t\treturn new AurumTextElement(child.toString());\n\t\t} else if (child instanceof DataSource) {\n\t\t\t//@ts-ignore\n\t\t\tconst result = new AurumFragment({}, [child]);\n\t\t\tresult.onChange.subscribe(() => this.render());\n\t\t\treturn result;\n\t\t} else {\n\t\t\tthrow new Error('Unsupported child type');\n\t\t}\n\t}\n\n\tpublic addChildAt(child: ChildNode, index: number): void {\n\t\tthis.children.splice(index, 0, this.childNodeToAurum(child));\n\t\tthis.render();\n\t}\n\n\tpublic addChildren(nodes: ChildNode[]): void {\n\t\tif (nodes.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const child of nodes) {\n\t\t\tthis.addChild(child);\n\t\t}\n\t}\n}\n\n/**\n * @internal\n */\nexport interface AurumFragmentProps {\n\trepeatModel?: ArrayDataSource<AurumElementModel>;\n}\n\n/**\n * @internal\n */\nexport class AurumFragment {\n\tpublic children: Array<AurumElement | AurumTextElement | AurumFragment>;\n\tpublic onChange: EventEmitter<void>;\n\n\tconstructor(props: AurumFragmentProps, children?: ChildNode[]) {\n\t\tthis.onChange = new EventEmitter();\n\t\tthis.children = [];\n\t\tif (props.repeatModel) {\n\t\t\tthis.handleRepeat(props.repeatModel);\n\t\t} else if (children) {\n\t\t\tthis.addChildren(children);\n\t\t}\n\t}\n\n\tpublic addChildren(children: ChildNode[]) {\n\t\tfor (const child of children) {\n\t\t\tlet renderable;\n\t\t\tif (child[aurumElementModelIdentitiy]) {\n\t\t\t\trenderable = prerender(child as any);\n\t\t\t} else {\n\t\t\t\trenderable = child;\n\t\t\t}\n\t\t\tif (renderable instanceof AurumElement) {\n\t\t\t\tthis.children.push(renderable);\n\t\t\t} else if (renderable instanceof DataSource) {\n\t\t\t\tlet sourceChild = undefined;\n\t\t\t\tlet wasArray: boolean;\n\t\t\t\tconst freshnessToken = { ts: undefined };\n\t\t\t\trenderable.unique().listenAndRepeat((newValue) => {\n\t\t\t\t\tfreshnessToken.ts = Date.now();\n\t\t\t\t\tif ((newValue === undefined || newValue === null) && wasArray) {\n\t\t\t\t\t\tthis.children.length = 0;\n\t\t\t\t\t\tthis.onChange.fire();\n\t\t\t\t\t\twasArray = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if (!Array.isArray(newValue) && wasArray) {\n\t\t\t\t\t\tthis.children.length = 0;\n\t\t\t\t\t\tthis.onChange.fire();\n\t\t\t\t\t\twasArray = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Array.isArray(newValue)) {\n\t\t\t\t\t\twasArray = true;\n\t\t\t\t\t\tthis.children.length = 0;\n\t\t\t\t\t\tthis.onChange.fire();\n\t\t\t\t\t\tfor (const newSubValue of newValue) {\n\t\t\t\t\t\t\tthis.handleSourceChild(newSubValue, undefined, undefined, freshnessToken, freshnessToken.ts);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsourceChild = this.handleSourceChild(newValue, sourceChild, renderable, freshnessToken, freshnessToken.ts);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthrow new Error('case not yet implemented');\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate handleSourceChild(newValue: any, sourceChild: any, dataSource, freshnessToken: { ts: number }, timestamp: number) {\n\t\tif (Array.isArray(newValue)) {\n\t\t\tfor (const item of newValue) {\n\t\t\t\tthis.handleSourceChild(item, sourceChild, dataSource, freshnessToken, timestamp);\n\t\t\t}\n\t\t}\n\n\t\tif (newValue === undefined || newValue === null) {\n\t\t\tif (sourceChild) {\n\t\t\t\tthis.children.splice(this.children.indexOf(sourceChild), 1);\n\t\t\t\tsourceChild = undefined;\n\t\t\t\tthis.onChange.fire();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (newValue[aurumElementModelIdentitiy]) {\n\t\t\tnewValue = prerender(newValue);\n\t\t}\n\n\t\tif (typeof newValue === 'string' || typeof newValue === 'bigint' || typeof newValue === 'number' || typeof newValue === 'boolean') {\n\t\t\tif (!sourceChild) {\n\t\t\t\tconst textNode = new AurumTextElement(dataSource ?? newValue);\n\t\t\t\tthis.children.push(textNode);\n\t\t\t\tsourceChild = textNode;\n\t\t\t\tthis.onChange.fire();\n\t\t\t} else if (sourceChild instanceof AurumElement) {\n\t\t\t\tconst textNode = new AurumTextElement(dataSource ?? newValue);\n\t\t\t\tthis.children.splice(this.children.indexOf(sourceChild), 1, textNode);\n\t\t\t\tsourceChild = textNode;\n\t\t\t\tthis.onChange.fire();\n\t\t\t}\n\t\t} else if (newValue instanceof AurumElement) {\n\t\t\tif (newValue !== sourceChild) {\n\t\t\t\tif (sourceChild) {\n\t\t\t\t\tthis.children.splice(this.children.indexOf(sourceChild), 1, newValue);\n\t\t\t\t} else {\n\t\t\t\t\tthis.children.push(newValue);\n\t\t\t\t}\n\t\t\t\tsourceChild = newValue;\n\t\t\t\tthis.onChange.fire();\n\t\t\t}\n\t\t} else if (newValue instanceof Promise) {\n\t\t\tnewValue.then((value) => {\n\t\t\t\tif (freshnessToken.ts === timestamp) {\n\t\t\t\t\tthis.addChildren([value]);\n\t\t\t\t\tthis.onChange.fire();\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (newValue instanceof DataSource) {\n\t\t\tif (!sourceChild) {\n\t\t\t\tconst result = new AurumFragment({}, [newValue]);\n\t\t\t\tsourceChild = result;\n\t\t\t\tthis.children.push(result);\n\t\t\t\tresult.onChange.subscribe(() => this.onChange.fire());\n\t\t\t\tthis.onChange.fire();\n\t\t\t} else if (sourceChild !== newValue) {\n\t\t\t\tconst result = new AurumFragment({}, [newValue]);\n\t\t\t\tresult.onChange.subscribe(() => this.onChange.fire());\n\t\t\t\tthis.children.splice(this.children.indexOf(sourceChild), 1, result);\n\t\t\t\tsourceChild = result;\n\t\t\t\tthis.onChange.fire();\n\t\t\t}\n\t\t} else if (newValue instanceof ArrayDataSource) {\n\t\t\tif (!sourceChild) {\n\t\t\t\tconst result = new AurumFragment({ repeatModel: newValue });\n\t\t\t\tsourceChild = result;\n\t\t\t\tthis.children.push(result);\n\t\t\t\tresult.onChange.subscribe(() => this.onChange.fire());\n\t\t\t\tthis.onChange.fire();\n\t\t\t} else if (sourceChild !== newValue) {\n\t\t\t\tconst result = new AurumFragment({ repeatModel: newValue });\n\t\t\t\tresult.onChange.subscribe(() => this.onChange.fire());\n\t\t\t\tthis.children.splice(this.children.indexOf(sourceChild), 1, result);\n\t\t\t\tsourceChild = result;\n\t\t\t\tthis.onChange.fire();\n\t\t\t}\n\t\t}\n\t\treturn sourceChild;\n\t}\n\n\tprivate handleRepeat(dataSource: ArrayDataSource<AurumElementModel>): void {\n\t\tdataSource.listenAndRepeat((change) => {\n\t\t\tswitch (change.operationDetailed) {\n\t\t\t\tcase 'replace':\n\t\t\t\t\t//@ts-ignore\n\t\t\t\t\tthis.children[change.index] = prerender(change.items[0]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'swap':\n\t\t\t\t\tconst itemA = this.children[change.index];\n\t\t\t\t\tconst itemB = this.children[change.index2];\n\t\t\t\t\tthis.children[change.index2] = itemA;\n\t\t\t\t\tthis.children[change.index] = itemB;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'merge':\n\t\t\t\t\tconst source = change.previousState.slice();\n\t\t\t\t\tfor (let i = 0; i < change.newState.length; i++) {\n\t\t\t\t\t\tif (this.children.length <= i) {\n\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\tthis.children.push(prerender(change.newState[i]));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (source[i] !== change.newState[i]) {\n\t\t\t\t\t\t\tconst index = source.indexOf(change.newState[i]);\n\t\t\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\t\t\tconst a = this.children[i];\n\t\t\t\t\t\t\t\tconst b = this.children[index];\n\t\t\t\t\t\t\t\tthis.children[i] = b;\n\t\t\t\t\t\t\t\tthis.children[index] = a;\n\t\t\t\t\t\t\t\tconst c = source[i];\n\t\t\t\t\t\t\t\tconst d = source[index];\n\t\t\t\t\t\t\t\tsource[i] = d;\n\t\t\t\t\t\t\t\tsource[index] = c;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//@ts-ignore\n\t\t\t\t\t\t\t\tthis.children.splice(i, 0, prerender(change.newState[i]));\n\t\t\t\t\t\t\t\tsource.splice(i, 0, change.newState[i]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (this.children.length > change.newState.length) {\n\t\t\t\t\t\tthis.children.length = change.newState.length;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'append':\n\t\t\t\t\t//@ts-ignore\n\t\t\t\t\tthis.children = this.children.concat(change.items.map(prerender));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'prepend':\n\t\t\t\t\t//@ts-ignore\n\t\t\t\t\tthis.children.unshift(...change.items.map(prerender));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'remove':\n\t\t\t\tcase 'removeLeft':\n\t\t\t\tcase 'removeRight':\n\t\t\t\t\tthis.children.splice(change.index, change.count);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'clear':\n\t\t\t\t\tthis.children = [];\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error('unhandled operation');\n\t\t\t}\n\t\t\tthis.onChange.fire();\n\t\t});\n\t}\n}\n","import { Callback, MapLike, AttributeValue } from '../../utilities/common';\nimport { AurumElement, AurumElementProps, ChildNode } from './aurum_element';\n\nexport interface CustomProps<T extends HTMLElement> extends AurumElementProps<T> {\n\tonAttach?: Callback<T>;\n\tonDetach?: Callback<T>;\n\tonCreate?: Callback<T>;\n\n\tattributes?: MapLike<AttributeValue>;\n\ttag: string;\n}\n\nexport class Custom<T extends HTMLElement> extends AurumElement {\n\tpublic readonly node: T;\n\n\tconstructor(props: CustomProps<T>, children: ChildNode[]) {\n\t\tsuper(props, children, props.tag);\n\t\tif (props.attributes) {\n\t\t\tif (props !== null) {\n\t\t\t\tthis.bindProps(Object.keys(props.attributes), props.attributes);\n\t\t\t}\n\t\t}\n\t}\n}\n","import { DataSource } from '../../stream/data_source';\nimport { ChildNode, prerender } from './aurum_element';\n\nconst routeIdentity = Symbol('route');\n\nexport interface RouteInstance {\n\t[routeIdentity]: boolean;\n\thref: string;\n\tdefault: boolean;\n\tcontent: ChildNode[];\n}\n\nexport function AurumRouter(props, children) {\n\tchildren = children.map(prerender);\n\tif (children.some((c) => !c[routeIdentity])) {\n\t\tthrow new Error('Aurum Router only accepts Route and DefaultRoute instances as children');\n\t}\n\tif (children.filter((c) => c.default).length > 1) {\n\t\tthrow new Error('Too many default routes only 0 or 1 allowed');\n\t}\n\n\tconst urlDataSource = new DataSource(getUrlPath());\n\n\twindow.addEventListener('hashchange', () => {\n\t\turlDataSource.update(getUrlPath());\n\t});\n\n\treturn urlDataSource.unique().map((p) => selectRoute(p, children));\n}\n\nfunction getUrlPath(): string {\n\tconst hash = location.hash.substring(1);\n\tif (hash.includes('?')) {\n\t\treturn hash.substring(0, hash.indexOf('?'));\n\t} else if (hash.includes('#')) {\n\t\treturn hash.substring(0, hash.indexOf('#'));\n\t} else {\n\t\treturn hash;\n\t}\n}\n\nfunction selectRoute(url: string, routes: RouteInstance[]): ChildNode[] {\n\tif (url === undefined || url === null) {\n\t\treturn routes.find((r) => r.default)?.content;\n\t} else {\n\t\tif (routes.find((r) => r.href === url)) {\n\t\t\treturn routes.find((r) => r.href === url).content;\n\t\t} else {\n\t\t\tconst segments = url.split('/');\n\t\t\tsegments.pop();\n\t\t\twhile (segments.length) {\n\t\t\t\tconst path = segments.join('/');\n\t\t\t\tif (routes.find((r) => r.href === path)) {\n\t\t\t\t\treturn routes.find((r) => r.href === path).content;\n\t\t\t\t}\n\t\t\t\tsegments.pop();\n\t\t\t}\n\t\t\treturn routes.find((r) => r.default)?.content;\n\t\t}\n\t}\n}\n\nexport interface RouteProps {\n\thref: string;\n}\n\nexport function Route(props: RouteProps, children): RouteInstance {\n\treturn {\n\t\t[routeIdentity]: true,\n\t\tcontent: children,\n\t\tdefault: false,\n\t\thref: props.href\n\t};\n}\n\nexport function DefaultRoute(props: {}, children): RouteInstance {\n\treturn {\n\t\t[routeIdentity]: true,\n\t\tcontent: children,\n\t\tdefault: true,\n\t\thref: undefined\n\t};\n}\n","import { DataSource } from '../../stream/data_source';\nimport { ChildNode, prerender } from './aurum_element';\n\nexport interface SuspenseProps {\n\tfallback?: ChildNode;\n}\n\nexport function Suspense(props: SuspenseProps, children: ChildNode[]) {\n\tconst data = new DataSource<ChildNode>(props?.fallback);\n\tPromise.all(children.map(prerender)).then((res) => {\n\t\tdata.update(res as ChildNode[]);\n\t});\n\n\treturn data;\n}\n","import { ReadOnlyDataSource } from '../../stream/data_source';\nimport { ChildNode, prerender } from './aurum_element';\n\nexport interface SwitchProps<T = boolean> {\n\tstate: ReadOnlyDataSource<T>;\n}\n\nconst switchCaseIdentity = Symbol('switchCase');\n\nexport interface SwitchCaseInstance<T> {\n\t[switchCaseIdentity]: boolean;\n\tvalue: T;\n\tdefault: boolean;\n\tcontent: ChildNode[];\n}\n\nexport function Switch<T = boolean>(props: SwitchProps<T>, children) {\n\tchildren = children.map(prerender);\n\tif (children.some((c) => !c[switchCaseIdentity])) {\n\t\tthrow new Error('Switch only accepts SwitchCase as children');\n\t}\n\tif (children.filter((c) => c.default).length > 1) {\n\t\tthrow new Error('Too many default switch cases only 0 or 1 allowed');\n\t}\n\n\tconst u = props.state.unique();\n\t//HACK: Force initial mapping. Need to find a better solution for this\n\t///@ts-ignore\n\tu.primed = true;\n\treturn u.map((state) => selectCase(state, children));\n}\n\nfunction selectCase<T>(state: T, children: SwitchCaseInstance<T>[]) {\n\treturn children.find((c) => c.value === state)?.content ?? children.find((p) => p.default)?.content;\n}\n\nexport interface SwitchCaseProps<T> {\n\twhen: T;\n}\n\nexport function SwitchCase<T>(props: SwitchCaseProps<T>, children): SwitchCaseInstance<T> {\n\treturn {\n\t\t[switchCaseIdentity]: true,\n\t\tcontent: children,\n\t\tdefault: false,\n\t\tvalue: props.when\n\t};\n}\n\nexport function DefaultSwitchCase(props: {}, children): SwitchCaseInstance<any> {\n\treturn {\n\t\t[switchCaseIdentity]: true,\n\t\tcontent: children,\n\t\tdefault: true,\n\t\tvalue: undefined\n\t};\n}\n","import { DataSource } from './data_source';\nimport { Callback } from '../utilities/common';\nimport { CancellationToken } from '../utilities/cancellation_token';\nimport { EventEmitter } from '../utilities/event_emitter';\n\nexport interface ObjectChange<T, K extends keyof T> {\n\tkey: K;\n\toldValue: T[K];\n\tnewValue: T[K];\n\tdeleted?: boolean;\n}\n\nexport class ObjectDataSource<T> {\n\tprotected data: T;\n\tprivate updateEvent: EventEmitter<ObjectChange<T, keyof T>>;\n\tprivate updateEventOnKey: Map<keyof T, EventEmitter<ObjectChange<T, keyof T>>>;\n\n\tconstructor(initialData: T) {\n\t\tif (initialData) {\n\t\t\tthis.data = initialData;\n\t\t}\n\n\t\tthis.updateEvent = new EventEmitter();\n\t\tthis.updateEventOnKey = new Map();\n\t}\n\n\t/**\n\t * Creates a datasource for a single key of the object\n\t * @param key\n\t * @param cancellationToken\n\t */\n\tpublic pick(key: keyof T, cancellationToken?: CancellationToken): DataSource<T[typeof key]> {\n\t\tconst subDataSource: DataSource<T[typeof key]> = new DataSource(this.data?.[key]);\n\n\t\tthis.listenOnKey(\n\t\t\tkey,\n\t\t\t(v) => {\n\t\t\t\tsubDataSource.update(v.newValue);\n\t\t\t},\n\t\t\tcancellationToken\n\t\t);\n\n\t\treturn subDataSource;\n\t}\n\n\t/**\n\t * Listen to changes of the object\n\t */\n\tpublic listen(callback: Callback<ObjectChange<T, keyof T>>, cancellationToken?: CancellationToken): Callback<void> {\n\t\treturn this.updateEvent.subscribe(callback, cancellationToken).cancel;\n\t}\n\n\t/**\n\t * Same as listenOnKey but will immediately call the callback with the current value first\n\t */\n\tpublic listenOnKeyAndRepeat<K extends keyof T>(\n\t\tkey: K,\n\t\tcallback: Callback<ObjectChange<T, keyof T>>,\n\t\tcancellationToken?: CancellationToken\n\t): Callback<void> {\n\t\tcallback({\n\t\t\tkey,\n\t\t\tnewValue: this.data[key],\n\t\t\toldValue: undefined\n\t\t});\n\n\t\treturn this.listenOnKey(key, callback, cancellationToken);\n\t}\n\n\t/**\n\t * Listen to changes of a single key of the object\n\t */\n\tpublic listenOnKey<K extends keyof T>(key: K, callback: Callback<ObjectChange<T, keyof T>>, cancellationToken?: CancellationToken): Callback<void> {\n\t\tif (!this.updateEventOnKey.has(key)) {\n\t\t\tthis.updateEventOnKey.set(key, new EventEmitter());\n\t\t}\n\t\tconst event = this.updateEventOnKey.get(key);\n\t\treturn event.subscribe(callback, cancellationToken).cancel;\n\t}\n\n\t/**\n\t * Returns all the keys of the object in the source\n\t */\n\tpublic keys(): string[] {\n\t\treturn Object.keys(this.data);\n\t}\n\n\t/**\n\t * Returns all the values of the object in the source\n\t */\n\tpublic values(): any {\n\t\treturn Object.values(this.data);\n\t}\n\n\t/**\n\t * get the current value of a key of the object\n\t * @param key\n\t */\n\tpublic get<K extends keyof T>(key: K): T[K] {\n\t\treturn this.data[key];\n\t}\n\n\t/**\n\t * delete a key from the object\n\t * @param key\n\t * @param value\n\t */\n\tpublic delete<K extends keyof T>(key: K): void {\n\t\tconst old = this.data[key];\n\t\tdelete this.data[key];\n\t\tthis.updateEvent.fire({ oldValue: old, key, newValue: undefined, deleted: true });\n\t}\n\n\t/**\n\t * set the value for a key of the object\n\t * @param key\n\t * @param value\n\t */\n\tpublic set<K extends keyof T>(key: K, value: T[K]): void {\n\t\tif (this.data[key] === value) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst old = this.data[key];\n\t\tthis.data[key] = value;\n\t\tthis.updateEvent.fire({ oldValue: old, key, newValue: this.data[key] });\n\t\tif (this.updateEventOnKey.has(key)) {\n\t\t\tthis.updateEventOnKey.get(key).fire({ oldValue: old, key, newValue: this.data[key] });\n\t\t}\n\t}\n\n\t/**\n\t * Merge the key value pairs of an object into this object non recursively\n\t * @param newData\n\t */\n\tpublic assign(newData: Partial<T> | ObjectDataSource<T>): void {\n\t\tif (newData instanceof ObjectDataSource) {\n\t\t\tfor (const key of newData.keys()) {\n\t\t\t\tthis.set(key as keyof T, newData.data[key]);\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const key of Object.keys(newData)) {\n\t\t\t\tthis.set(key as keyof T, newData[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns a shallow copy of the object\n\t */\n\tpublic toObject(): T {\n\t\treturn { ...this.data };\n\t}\n\n\t/**\n\t * Returns a simplified version of this datasource\n\t */\n\tpublic toDataSource(): DataSource<T> {\n\t\tconst stream = new DataSource(this.data);\n\t\tthis.listen((s) => {\n\t\t\tstream.update(this.data);\n\t\t});\n\t\treturn stream;\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface DivProps extends AurumElementProps<HTMLDivElement> {\n\tonAttach?: Callback<HTMLDivElement>;\n\tonDetach?: Callback<HTMLDivElement>;\n\tonCreate?: Callback<HTMLDivElement>;\n}\n\n/**\n * @internal\n */\nexport class Div extends AurumElement {\n\tpublic readonly node: HTMLDivElement;\n\n\tconstructor(props: DivProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'div');\n\t}\n}\n","import { AurumElement, ChildNode, AurumElementProps } from './special/aurum_element';\nimport { Callback, AttributeValue } from '../utilities/common';\n\nexport interface ButtonProps extends AurumElementProps<HTMLButtonElement> {\n\tdisabled?: AttributeValue;\n\tonAttach?: Callback<HTMLButtonElement>;\n\tonDetach?: Callback<HTMLButtonElement>;\n\tonCreate?: Callback<HTMLButtonElement>;\n}\n\n/**\n * @internal\n */\nexport class Button extends AurumElement {\n\tpublic readonly node: HTMLButtonElement;\n\n\tconstructor(props: ButtonProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'button');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['disabled'], props);\n\t\t}\n\t}\n}\n","import { AttributeValue, Callback, DataDrain } from '../utilities/common';\nimport { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { DataSource } from '../stream/data_source';\nimport { DuplexDataSource } from '../stream/duplex_data_source';\n\nexport interface InputProps extends AurumElementProps<HTMLInputElement> {\n\tonAttach?: Callback<HTMLInputElement>;\n\tonDetach?: Callback<HTMLInputElement>;\n\tonCreate?: Callback<HTMLInputElement>;\n\n\tplaceholder?: AttributeValue;\n\treadonly?: AttributeValue;\n\tdisabled?: AttributeValue;\n\tonChange?: DataDrain<InputEvent>;\n\tonInput?: DataDrain<InputEvent>;\n\tvalue?: DataSource<string> | DuplexDataSource<string> | string;\n\taccept?: AttributeValue;\n\talt?: AttributeValue;\n\tautocomplete?: AttributeValue;\n\tautofocus?: AttributeValue;\n\tchecked?: DataSource<boolean> | DuplexDataSource<boolean> | boolean;\n\tdefaultChecked?: AttributeValue;\n\tformAction?: AttributeValue;\n\tformEnctype?: AttributeValue;\n\tformMethod?: AttributeValue;\n\tformNoValidate?: AttributeValue;\n\tformTarget?: AttributeValue;\n\tmax?: AttributeValue;\n\tmaxLength?: AttributeValue;\n\tmin?: AttributeValue;\n\tminLength?: AttributeValue;\n\tpattern?: AttributeValue;\n\tmultiple?: AttributeValue;\n\trequired?: AttributeValue;\n\ttype?: AttributeValue;\n}\n\n/**\n * @internal\n */\nconst inputEvents = { input: 'onInput', change: 'onChange' };\n\n/**\n * @internal\n */\nconst inputProps = [\n\t'placeholder',\n\t'readonly',\n\t'disabled',\n\t'accept',\n\t'alt',\n\t'autocomplete',\n\t'autofocus',\n\t'checked',\n\t'defaultChecked',\n\t'formAction',\n\t'formEnctype',\n\t'formMethod',\n\t'formNoValidate',\n\t'formTarget',\n\t'max',\n\t'maxLength',\n\t'min',\n\t'minLength',\n\t'pattern',\n\t'multiple',\n\t'required',\n\t'type'\n];\n\n/**\n * @internal\n */\nexport class Input extends AurumElement {\n\tpublic node: HTMLInputElement;\n\n\tconstructor(props: InputProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'input');\n\t\tif (props !== null) {\n\t\t\tif (props.value instanceof DataSource || props.value instanceof DuplexDataSource) {\n\t\t\t\tprops.value.unique().listenAndRepeat((value) => (this.node.value = value));\n\t\t\t\tthis.node.addEventListener('input', () => {\n\t\t\t\t\tif (props.value instanceof DataSource) {\n\t\t\t\t\t\tprops.value.update(this.node.value);\n\t\t\t\t\t} else if (props.value instanceof DuplexDataSource) {\n\t\t\t\t\t\tprops.value.updateUpstream(this.node.value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.node.value = props.value ?? '';\n\t\t\t}\n\n\t\t\tif (props.checked instanceof DataSource || props.checked instanceof DuplexDataSource) {\n\t\t\t\tprops.checked.unique().listenAndRepeat((value) => (this.node.checked = value));\n\t\t\t\tthis.node.addEventListener('change', () => {\n\t\t\t\t\tif (props.checked instanceof DataSource) {\n\t\t\t\t\t\tprops.checked.update(this.node.checked);\n\t\t\t\t\t} else if (props.checked instanceof DuplexDataSource) {\n\t\t\t\t\t\tprops.checked.updateUpstream(this.node.checked);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.node.checked = props.checked ?? false;\n\t\t\t}\n\t\t\tthis.bindProps(inputProps, props);\n\t\t\tthis.createEventHandlers(inputEvents, props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface LiProps extends AurumElementProps<HTMLLIElement> {\n\tonAttach?: Callback<HTMLLIElement>;\n\tonDetach?: Callback<HTMLLIElement>;\n\tonCreate?: Callback<HTMLLIElement>;\n}\n\n/**\n * @internal\n */\nexport class Li extends AurumElement {\n\tpublic node: HTMLLIElement;\n\n\tconstructor(props: LiProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'li');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface SpanProps extends AurumElementProps<HTMLSpanElement> {\n\tonAttach?: Callback<HTMLSpanElement>;\n\tonDetach?: Callback<HTMLSpanElement>;\n\tonCreate?: Callback<HTMLSpanElement>;\n}\n\n/**\n * @internal\n */\nexport class Span extends AurumElement {\n\tpublic node: HTMLSpanElement;\n\n\tconstructor(props: SpanProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'span');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback, AttributeValue } from '../utilities/common';\n\nexport interface StyleProps extends AurumElementProps<HTMLStyleElement> {\n\tonAttach?: Callback<HTMLStyleElement>;\n\tonDetach?: Callback<HTMLStyleElement>;\n\tonCreate?: Callback<HTMLStyleElement>;\n\tmedia?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Style extends AurumElement {\n\tpublic node: HTMLStyleElement;\n\n\tconstructor(props: StyleProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'style');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['media'], props);\n\t\t}\n\t}\n}\n","import { Callback, AttributeValue } from '../utilities/common';\nimport { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\nexport interface AudioProps extends AurumElementProps<HTMLAudioElement> {\n\tonAttach?: Callback<HTMLAudioElement>;\n\tonDetach?: Callback<HTMLAudioElement>;\n\tonCreate?: Callback<HTMLAudioElement>;\n\tcontrols?: AttributeValue;\n\tautoplay?: AttributeValue;\n\tloop?: AttributeValue;\n\tmuted?: AttributeValue;\n\tpreload?: AttributeValue;\n\tsrc?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Audio extends AurumElement {\n\tpublic readonly node: HTMLAudioElement;\n\n\tconstructor(props: AudioProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'audio');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['controls', 'autoplay', 'loop', 'muted', 'preload', 'src'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface UlProps extends AurumElementProps<HTMLUListElement> {\n\tonAttach?: Callback<HTMLUListElement>;\n\tonDetach?: Callback<HTMLUListElement>;\n\tonCreate?: Callback<HTMLUListElement>;\n}\n\n/**\n * @internal\n */\nexport class Ul extends AurumElement {\n\tpublic node: HTMLUListElement;\n\n\tconstructor(props: UlProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'ul');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface PProps extends AurumElementProps<HTMLParagraphElement> {\n\tonAttach?: Callback<HTMLParagraphElement>;\n\tonDetach?: Callback<HTMLParagraphElement>;\n\tonCreate?: Callback<HTMLParagraphElement>;\n}\n\n/**\n * @internal\n */\nexport class P extends AurumElement {\n\tpublic node: HTMLParagraphElement;\n\n\tconstructor(props: PProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'p');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback, AttributeValue } from '../utilities/common';\n\nexport interface ImgProps extends AurumElementProps<HTMLImageElement> {\n\tonAttach?: Callback<HTMLImageElement>;\n\tonDetach?: Callback<HTMLImageElement>;\n\tonCreate?: Callback<HTMLImageElement>;\n\tsrc?: AttributeValue;\n\talt?: AttributeValue;\n\twidth?: AttributeValue;\n\theight?: AttributeValue;\n\treferrerPolicy?: AttributeValue;\n\tsizes?: AttributeValue;\n\tsrcset?: AttributeValue;\n\tuseMap?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Img extends AurumElement {\n\tpublic readonly node: HTMLImageElement;\n\n\tconstructor(props: ImgProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'img');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['src', 'alt', 'width', 'height', 'referrerPolicy', 'sizes', 'srcset', 'useMap'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback, AttributeValue } from '../utilities/common';\n\nexport interface LinkProps extends AurumElementProps<HTMLLinkElement> {\n\tonAttach?: Callback<HTMLLinkElement>;\n\tonDetach?: Callback<HTMLLinkElement>;\n\tonCreate?: Callback<HTMLLinkElement>;\n\thref?: AttributeValue;\n\trel?: AttributeValue;\n\tmedia?: AttributeValue;\n\tas?: AttributeValue;\n\tdisabled?: AttributeValue;\n\ttype?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Link extends AurumElement {\n\tpublic node: HTMLLinkElement;\n\n\tconstructor(props: LinkProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'link');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['href', 'rel', 'media', 'as', 'disabled', 'type'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, ChildNode, AurumElementProps } from './special/aurum_element';\nimport { Callback, AttributeValue } from '../utilities/common';\n\nexport interface CanvasProps extends AurumElementProps<HTMLCanvasElement> {\n\tonAttach?: Callback<HTMLCanvasElement>;\n\tonDetach?: Callback<HTMLCanvasElement>;\n\tonCreate?: Callback<HTMLCanvasElement>;\n\twidth?: AttributeValue;\n\theight?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Canvas extends AurumElement {\n\tpublic readonly node: HTMLCanvasElement;\n\n\tconstructor(props: CanvasProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'canvas');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['width', 'height'], props);\n\t\t}\n\t}\n}\n","import { Callback, AttributeValue } from '../utilities/common';\nimport { AurumElement, ChildNode, AurumElementProps } from './special/aurum_element';\n\nexport interface AProps extends AurumElementProps<HTMLAnchorElement> {\n\tonAttach?: Callback<HTMLAnchorElement>;\n\tonDetach?: Callback<HTMLAnchorElement>;\n\tonCreate?: Callback<HTMLAnchorElement>;\n\thref?: AttributeValue;\n\ttarget?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class A extends AurumElement {\n\tpublic readonly node: HTMLAnchorElement;\n\n\tconstructor(props: AProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'a');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['href', 'target'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Article extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'article');\n\t}\n}\n","import { AurumElement, ChildNode, AurumElementProps } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface BrProps extends AurumElementProps<HTMLBRElement> {\n\tonAttach?: Callback<HTMLBRElement>;\n\tonDetach?: Callback<HTMLBRElement>;\n\tonCreate?: Callback<HTMLBRElement>;\n}\n\n/**\n * @internal\n */\nexport class Br extends AurumElement {\n\tpublic readonly node: HTMLBRElement;\n\n\tconstructor(props: BrProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'br');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface FormProps extends AurumElementProps<HTMLFormElement> {\n\tonAttach?: Callback<HTMLFormElement>;\n\tonDetach?: Callback<HTMLFormElement>;\n\tonCreate?: Callback<HTMLFormElement>;\n}\n\n/**\n * @internal\n */\nexport class Form extends AurumElement {\n\tpublic readonly node: HTMLFormElement;\n\n\tconstructor(props: FormProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'form');\n\t}\n}\n","import { AurumElement, ChildNode, AurumElementProps } from './special/aurum_element';\nimport { Callback, AttributeValue } from '../utilities/common';\n\nexport interface LabelProps extends AurumElementProps<HTMLLabelElement> {\n\tonAttach?: Callback<HTMLLabelElement>;\n\tonDetach?: Callback<HTMLLabelElement>;\n\tonCreate?: Callback<HTMLLabelElement>;\n\tfor?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Label extends AurumElement {\n\tpublic node: HTMLLabelElement;\n\n\tconstructor(props: LabelProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'label');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['for'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface OlProps extends AurumElementProps<HTMLOListElement> {\n\tonAttach?: Callback<HTMLOListElement>;\n\tonDetach?: Callback<HTMLOListElement>;\n\tonCreate?: Callback<HTMLOListElement>;\n}\n\n/**\n * @internal\n */\nexport class Ol extends AurumElement {\n\tpublic node: HTMLOListElement;\n\n\tconstructor(props: OlProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'ol');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface PreProps extends AurumElementProps<HTMLPreElement> {\n\tonAttach?: Callback<HTMLPreElement>;\n\tonDetach?: Callback<HTMLPreElement>;\n\tonCreate?: Callback<HTMLPreElement>;\n}\n\n/**\n * @internal\n */\nexport class Pre extends AurumElement {\n\tpublic node: HTMLPreElement;\n\n\tconstructor(props: PreProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'pre');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback, AttributeValue } from '../utilities/common';\n\nexport interface ProgressProps extends AurumElementProps<HTMLProgressElement> {\n\tonAttach?: Callback<HTMLProgressElement>;\n\tonDetach?: Callback<HTMLProgressElement>;\n\tonCreate?: Callback<HTMLProgressElement>;\n\n\tmax?: AttributeValue;\n\tvalue?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Progress extends AurumElement {\n\tpublic node: HTMLProgressElement;\n\n\tconstructor(props: ProgressProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'progress');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['max', 'value'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface TableProps extends AurumElementProps<HTMLTableElement> {\n\tonAttach?: Callback<HTMLTableElement>;\n\tonDetach?: Callback<HTMLTableElement>;\n\tonCreate?: Callback<HTMLTableElement>;\n}\n\n/**\n * @internal\n */\nexport class Table extends AurumElement {\n\tpublic node: HTMLTableElement;\n\n\tconstructor(props: TableProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'table');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface TdProps extends AurumElementProps<HTMLTableColElement> {\n\tonAttach?: Callback<HTMLTableColElement>;\n\tonDetach?: Callback<HTMLTableColElement>;\n\tonCreate?: Callback<HTMLTableColElement>;\n}\n\n/**\n * @internal\n */\nexport class Td extends AurumElement {\n\tpublic node: HTMLTableColElement;\n\n\tconstructor(props: TdProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'td');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface TrProps extends AurumElementProps<HTMLTableRowElement> {\n\tonAttach?: Callback<HTMLTableRowElement>;\n\tonDetach?: Callback<HTMLTableRowElement>;\n\tonCreate?: Callback<HTMLTableRowElement>;\n}\n\n/**\n * @internal\n */\nexport class Tr extends AurumElement {\n\tpublic node: HTMLTableRowElement;\n\n\tconstructor(props: TrProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'tr');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface ThProps extends AurumElementProps<HTMLTableHeaderCellElement> {\n\tonAttach?: Callback<HTMLTableHeaderCellElement>;\n\tonDetach?: Callback<HTMLTableHeaderCellElement>;\n\tonCreate?: Callback<HTMLTableHeaderCellElement>;\n}\n\n/**\n * @internal\n */\nexport class Th extends AurumElement {\n\tpublic node: HTMLTableHeaderCellElement;\n\n\tconstructor(props: ThProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'th');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { DataSource } from '../stream/data_source';\nimport { DataDrain, Callback, AttributeValue } from '../utilities/common';\n\nexport interface TextAreaProps extends AurumElementProps<HTMLTextAreaElement> {\n\tonAttach?: Callback<HTMLTextAreaElement>;\n\tonDetach?: Callback<HTMLTextAreaElement>;\n\tonCreate?: Callback<HTMLTextAreaElement>;\n\n\tplaceholder?: AttributeValue;\n\treadonly?: AttributeValue;\n\tdisabled?: AttributeValue;\n\tonChange?: DataDrain<InputEvent>;\n\tonInput?: DataDrain<InputEvent>;\n\tinputValueSource?: DataSource<string>;\n\tinitialValue?: string;\n\n\trows?: AttributeValue;\n\twrap?: AttributeValue;\n\tautocomplete?: AttributeValue;\n\tautofocus?: AttributeValue;\n\tmax?: AttributeValue;\n\tmaxLength?: AttributeValue;\n\tmin?: AttributeValue;\n\tminLength?: AttributeValue;\n\trequired?: AttributeValue;\n\ttype?: AttributeValue;\n}\n\n/**\n * @internal\n */\nconst textAreaEvents = { input: 'onInput', change: 'onChange' };\n\n/**\n * @internal\n */\nconst textAreaProps = [\n\t'placeholder',\n\t'readonly',\n\t'disabled',\n\t'rows',\n\t'wrap',\n\t'autocomplete',\n\t'autofocus',\n\t'max',\n\t'maxLength',\n\t'min',\n\t'minLength',\n\t'required',\n\t'type'\n];\n\n/**\n * @internal\n */\nexport class TextArea extends AurumElement {\n\tpublic node: HTMLTextAreaElement;\n\n\tconstructor(props: TextAreaProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'textArea');\n\t\tif (props !== null) {\n\t\t\tif (props.inputValueSource) {\n\t\t\t\tthis.node.value = props.initialValue ?? props.inputValueSource.value ?? '';\n\t\t\t\tprops.inputValueSource.unique().listen((value) => (this.node.value = value));\n\t\t\t} else {\n\t\t\t\tthis.node.value = props.initialValue ?? '';\n\t\t\t}\n\t\t\tthis.bindProps(textAreaProps, props);\n\t\t\tthis.createEventHandlers(textAreaEvents, props);\n\n\t\t\tif (props.inputValueSource) {\n\t\t\t\tthis.node.addEventListener('input', () => {\n\t\t\t\t\tprops.inputValueSource.update(this.node.value);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class H1 extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'h1');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class H2 extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'h2');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class H3 extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'h3');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class H4 extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'h4');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class H5 extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'h5');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class H6 extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'h6');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Header extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'header');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Footer extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'footer');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Nav extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'nav');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class B extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'b');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class I extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'i');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback, AttributeValue } from '../utilities/common';\n\nexport interface ScriptProps extends AurumElementProps<HTMLScriptElement> {\n\tonAttach?: Callback<HTMLScriptElement>;\n\tonDetach?: Callback<HTMLScriptElement>;\n\tonCreate?: Callback<HTMLScriptElement>;\n\tsrc?: AttributeValue;\n\tasync?: AttributeValue;\n\tdefer?: AttributeValue;\n\tintegrity?: AttributeValue;\n\tnoModule?: AttributeValue;\n\ttype?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Script extends AurumElement {\n\tpublic node: HTMLScriptElement;\n\n\tconstructor(props: ScriptProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'script');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['src', 'async', 'defer', 'integrity', 'noModule', 'type'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Abbr extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'abbr');\n\t}\n}\n","import { Callback } from '../utilities/common';\nimport { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\nexport interface AreaProps extends AurumElementProps<HTMLAreaElement> {\n\tonAttach?: Callback<HTMLAreaElement>;\n\tonDetach?: Callback<HTMLAreaElement>;\n\tonCreate?: Callback<HTMLAreaElement>;\n}\n\n/**\n * @internal\n */\nexport class Area extends AurumElement {\n\tpublic readonly node: HTMLAreaElement;\n\n\tconstructor(props: AreaProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'area');\n\t}\n}\n","import { AurumElement, ChildNode, AurumElementProps } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Aside extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'aside');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Em extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'em');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface HeadingProps extends AurumElementProps<HTMLHeadingElement> {\n\tonAttach?: Callback<HTMLHeadingElement>;\n\tonDetach?: Callback<HTMLHeadingElement>;\n\tonCreate?: Callback<HTMLHeadingElement>;\n}\n\n/**\n * @internal\n */\nexport class Heading extends AurumElement {\n\tpublic readonly node: HTMLHeadingElement;\n\n\tconstructor(props: HeadingProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'heading');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback, AttributeValue } from '../utilities/common';\n\nexport interface IFrameProps extends AurumElementProps<HTMLIFrameElement> {\n\tonAttach?: Callback<HTMLIFrameElement>;\n\tonDetach?: Callback<HTMLIFrameElement>;\n\tonCreate?: Callback<HTMLIFrameElement>;\n\tsrc?: AttributeValue;\n\tallow?: AttributeValue;\n\tallowFullscreen?: AttributeValue;\n\tallowPaymentRequest?: AttributeValue;\n\twidth?: AttributeValue;\n\theight?: AttributeValue;\n\tsrcdoc?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class IFrame extends AurumElement {\n\tpublic readonly node: HTMLIFrameElement;\n\n\tconstructor(props: IFrameProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'iframe');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['src', 'srcdoc', 'width', 'height', 'allow', 'allowFullscreen', 'allowPaymentRequest'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class NoScript extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'noscript');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface QProps extends AurumElementProps<HTMLQuoteElement> {\n\tonAttach?: Callback<HTMLQuoteElement>;\n\tonDetach?: Callback<HTMLQuoteElement>;\n\tonCreate?: Callback<HTMLQuoteElement>;\n}\n\n/**\n * @internal\n */\nexport class Q extends AurumElement {\n\tpublic node: HTMLQuoteElement;\n\n\tconstructor(props: QProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'q');\n\t}\n}\n","import { DataSource } from '../stream/data_source';\nimport { Callback, DataDrain } from '../utilities/common';\nimport { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\nexport interface SelectProps extends AurumElementProps<HTMLSelectElement> {\n\tonAttach?: Callback<HTMLSelectElement>;\n\tonDetach?: Callback<HTMLSelectElement>;\n\tonCreate?: Callback<HTMLSelectElement>;\n\tonChange?: DataDrain<Event>;\n\tinitialSelection?: number;\n\tselectedIndexSource?: DataSource<number>;\n}\n\n/**\n * @internal\n */\nconst selectEvents = { change: 'onChange' };\n\n/**\n * @internal\n */\nexport class Select extends AurumElement {\n\tpublic readonly node: HTMLSelectElement;\n\tprivate selectedIndexSource: DataSource<number>;\n\tprivate initialSelection: number;\n\n\tconstructor(props: SelectProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'select');\n\t\tif (props !== null) {\n\t\t\tthis.createEventHandlers(selectEvents, props);\n\t\t\tthis.initialSelection = props.initialSelection;\n\n\t\t\tif (props.selectedIndexSource) {\n\t\t\t\tthis.selectedIndexSource = props.selectedIndexSource;\n\t\t\t\tprops.selectedIndexSource.unique().listenAndRepeat((value) => (this.node.selectedIndex = value));\n\t\t\t} else {\n\t\t\t\tthis.node.selectedIndex = props.initialSelection ?? -1;\n\t\t\t}\n\n\t\t\tif (props.selectedIndexSource) {\n\t\t\t\tthis.needAttach = true;\n\t\t\t\tthis.node.addEventListener('change', () => {\n\t\t\t\t\tprops.selectedIndexSource.update(this.node.selectedIndex);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected handleAttach(parent: AurumElement) {\n\t\tsuper.handleAttach(parent);\n\t\tif (this.node.isConnected) {\n\t\t\tif (this.selectedIndexSource) {\n\t\t\t\tthis.node.selectedIndex = this.selectedIndexSource.value;\n\t\t\t} else if (this.initialSelection !== undefined) {\n\t\t\t\tthis.node.selectedIndex = this.initialSelection;\n\t\t\t}\n\t\t}\n\t}\n}\n","import { Callback, AttributeValue } from '../utilities/common';\nimport { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\nexport interface SourceProps extends AurumElementProps<HTMLSourceElement> {\n\tonAttach?: Callback<HTMLSourceElement>;\n\tonDetach?: Callback<HTMLSourceElement>;\n\tonCreate?: Callback<HTMLSourceElement>;\n\tsrc?: AttributeValue;\n\tsrcSet?: AttributeValue;\n\tmedia?: AttributeValue;\n\tsizes?: AttributeValue;\n\ttype?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Source extends AurumElement {\n\tpublic readonly node: HTMLSourceElement;\n\n\tconstructor(props: SourceProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'source');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['src', 'srcSet', 'media', 'sizes', 'type'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface TitleProps extends AurumElementProps<HTMLTitleElement> {\n\tonAttach?: Callback<HTMLTitleElement>;\n\tonDetach?: Callback<HTMLTitleElement>;\n\tonCreate?: Callback<HTMLTitleElement>;\n}\n\n/**\n * @internal\n */\nexport class Title extends AurumElement {\n\tpublic node: HTMLTitleElement;\n\n\tconstructor(props: TitleProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'title');\n\t}\n}\n","import { Callback, AttributeValue } from '../utilities/common';\nimport { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\nexport interface VideoProps extends AurumElementProps<HTMLVideoElement> {\n\tonAttach?: Callback<HTMLVideoElement>;\n\tonDetach?: Callback<HTMLVideoElement>;\n\tonCreate?: Callback<HTMLVideoElement>;\n\tcontrols?: AttributeValue;\n\tautoplay?: AttributeValue;\n\tloop?: AttributeValue;\n\tmuted?: AttributeValue;\n\tpreload?: AttributeValue;\n\tsrc?: AttributeValue;\n\tposter?: AttributeValue;\n\twidth?: AttributeValue;\n\theight?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Video extends AurumElement {\n\tpublic readonly node: HTMLVideoElement;\n\n\tconstructor(props: VideoProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'video');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['controls', 'autoplay', 'loop', 'muted', 'preload', 'src', 'poster', 'width', 'height'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Tbody extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'tbody');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Tfoot extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'tfoot');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Thead extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'thead');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Summary extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'summary');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface DetailsProps extends AurumElementProps<HTMLDetailsElement> {\n\tonAttach?: Callback<HTMLDetailsElement>;\n\tonDetach?: Callback<HTMLDetailsElement>;\n\tonCreate?: Callback<HTMLDetailsElement>;\n}\n\n/**\n * @internal\n */\nexport class Details extends AurumElement {\n\tpublic readonly node: HTMLDetailsElement;\n\n\tconstructor(props: DetailsProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'details');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Sub extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'sub');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Sup extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'sup');\n\t}\n}\n","import { Callback, AttributeValue } from '../utilities/common';\nimport { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\nexport interface SvgProps extends AurumElementProps<HTMLElement> {\n\tonAttach?: Callback<HTMLOrSVGElement>;\n\tonDetach?: Callback<HTMLOrSVGElement>;\n\tonCreate?: Callback<HTMLOrSVGElement>;\n\twidth?: AttributeValue;\n\theight?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Svg extends AurumElement {\n\tconstructor(props: SvgProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'svg');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['width', 'height'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback, AttributeValue } from '../utilities/common';\n\nexport interface DataProps extends AurumElementProps<HTMLDataElement> {\n\tonAttach?: Callback<HTMLDataElement>;\n\tonDetach?: Callback<HTMLDataElement>;\n\tonCreate?: Callback<HTMLDataElement>;\n\tvalue?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Data extends AurumElement {\n\tpublic node: HTMLDataElement;\n\n\tconstructor(props: DataProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'data');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['datalue'], props);\n\t\t}\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback, AttributeValue } from '../utilities/common';\n\nexport interface TimeProps extends AurumElementProps<HTMLTimeElement> {\n\tonAttach?: Callback<HTMLTimeElement>;\n\tonDetach?: Callback<HTMLTimeElement>;\n\tonCreate?: Callback<HTMLTimeElement>;\n\tdatetime?: AttributeValue;\n}\n\n/**\n * @internal\n */\nexport class Time extends AurumElement {\n\tpublic node: HTMLTimeElement;\n\n\tconstructor(props: TimeProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'time');\n\t\tif (props !== null) {\n\t\t\tthis.bindProps(['datetime'], props);\n\t\t}\n\t}\n}\n","import { Callback } from '../utilities/common';\nimport { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\nexport interface OptionProps extends AurumElementProps<HTMLOptionElement> {\n\tonAttach?: Callback<HTMLOptionElement>;\n\tonDetach?: Callback<HTMLOptionElement>;\n\tonCreate?: Callback<HTMLOptionElement>;\n}\n\n/**\n * @internal\n */\nexport class Option extends AurumElement {\n\tpublic readonly node: HTMLOptionElement;\n\n\tconstructor(props: OptionProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'option');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface TemplateProps extends AurumElementProps<HTMLTemplateElement> {\n\tonAttach?: Callback<HTMLTemplateElement>;\n\tonDetach?: Callback<HTMLTemplateElement>;\n\tonCreate?: Callback<HTMLTemplateElement>;\n}\n\n/**\n * @internal\n */\nexport class Template extends AurumElement {\n\tconstructor(props: TemplateProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'template');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface BodyProps extends AurumElementProps<HTMLBodyElement> {\n\tonAttach?: Callback<HTMLBodyElement>;\n\tonDetach?: Callback<HTMLBodyElement>;\n\tonCreate?: Callback<HTMLBodyElement>;\n}\n\n/**\n * @internal\n */\nexport class Body extends AurumElement {\n\tpublic readonly node: HTMLBodyElement;\n\n\tconstructor(props: BodyProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'body');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface HeadProps extends AurumElementProps<HTMLHeadElement> {\n\tonAttach?: Callback<HTMLHeadElement>;\n\tonDetach?: Callback<HTMLHeadElement>;\n\tonCreate?: Callback<HTMLHeadElement>;\n}\n\n/**\n * @internal\n */\nexport class Head extends AurumElement {\n\tpublic readonly node: HTMLHeadElement;\n\n\tconstructor(props: HeadProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'head');\n\t}\n}\n","import { AurumElement, AurumElementModel, prerender, aurumElementModelIdentitiy, AurumElementProps } from '../nodes/special/aurum_element';\nimport { ownerSymbol } from './owner_symbol';\nimport { Constructor, MapLike } from './common';\nimport { Div, DivProps } from '../nodes/div';\nimport { Button, ButtonProps } from '../nodes/button';\nimport { Input, InputProps } from '../nodes/input';\nimport { Li, LiProps } from '../nodes/li';\nimport { Span, SpanProps } from '../nodes/span';\nimport { Style, StyleProps } from '../nodes/style';\nimport { Audio, AudioProps } from '../nodes/audio';\nimport { Ul, UlProps } from '../nodes/ul';\nimport { P, PProps } from '../nodes/p';\nimport { Img, ImgProps } from '../nodes/img';\nimport { Link, LinkProps } from '../nodes/link';\nimport { Canvas, CanvasProps } from '../nodes/canvas';\nimport { A, AProps } from '../nodes/a';\nimport { Article } from '../nodes/article';\nimport { Br, BrProps } from '../nodes/br';\nimport { Form, FormProps } from '../nodes/form';\nimport { Label, LabelProps } from '../nodes/label';\nimport { Ol, OlProps } from '../nodes/ol';\nimport { Pre, PreProps } from '../nodes/pre';\nimport { Progress, ProgressProps } from '../nodes/progress';\nimport { Table, TableProps } from '../nodes/table';\nimport { Td, TdProps } from '../nodes/td';\nimport { Tr, TrProps } from '../nodes/tr';\nimport { Th, ThProps } from '../nodes/th';\nimport { TextArea, TextAreaProps } from '../nodes/textarea';\nimport { H1 } from '../nodes/h1';\nimport { H2 } from '../nodes/h2';\nimport { H3 } from '../nodes/h3';\nimport { H4 } from '../nodes/h4';\nimport { H5 } from '../nodes/h5';\nimport { H6 } from '../nodes/h6';\nimport { Header } from '../nodes/header';\nimport { Footer } from '../nodes/footer';\nimport { Nav } from '../nodes/nav';\nimport { B } from '../nodes/b';\nimport { I } from '../nodes/i';\nimport { Script, ScriptProps } from '../nodes/script';\nimport { Abbr } from '../nodes/abbr';\nimport { Area, AreaProps } from '../nodes/area';\nimport { Aside } from '../nodes/aside';\nimport { Em } from '../nodes/em';\nimport { Heading, HeadingProps } from '../nodes/heading';\nimport { IFrame, IFrameProps } from '../nodes/iframe';\nimport { NoScript } from '../nodes/noscript';\nimport { Q, QProps } from '../nodes/q';\nimport { Select, SelectProps } from '../nodes/select';\nimport { Source, SourceProps } from '../nodes/source';\nimport { Title, TitleProps } from '../nodes/title';\nimport { Video, VideoProps } from '../nodes/video';\nimport { Tbody } from '../nodes/tbody';\nimport { Tfoot } from '../nodes/tfoot';\nimport { Thead } from '../nodes/thead';\nimport { Summary } from '../nodes/summary';\nimport { Details, DetailsProps } from '../nodes/details';\nimport { Sub } from '../nodes/sub';\nimport { Sup } from '../nodes/sup';\nimport { Svg, SvgProps } from '../nodes/svg';\nimport { Data, DataProps } from '../nodes/data';\nimport { Time, TimeProps } from '../nodes/time';\nimport { Option, OptionProps } from '../nodes/option';\nimport { Template, TemplateProps } from '../nodes/template';\nimport { BodyProps } from '../nodes/body';\nimport { HeadProps } from '../nodes/head';\n\nconst nodeMap = {\n\tbutton: Button,\n\tdiv: Div,\n\tinput: Input,\n\tli: Li,\n\tspan: Span,\n\tstyle: Style,\n\tul: Ul,\n\tp: P,\n\timg: Img,\n\tlink: Link,\n\tcanvas: Canvas,\n\ta: A,\n\tarticle: Article,\n\tbr: Br,\n\tform: Form,\n\tlabel: Label,\n\tol: Ol,\n\tpre: Pre,\n\tprogress: Progress,\n\ttable: Table,\n\ttd: Td,\n\ttr: Tr,\n\tth: Th,\n\ttextarea: TextArea,\n\th1: H1,\n\th2: H2,\n\th3: H3,\n\th4: H4,\n\th5: H5,\n\th6: H6,\n\theader: Header,\n\tfooter: Footer,\n\tnav: Nav,\n\tb: B,\n\ti: I,\n\tscript: Script,\n\tabbr: Abbr,\n\tarea: Area,\n\taside: Aside,\n\taudio: Audio,\n\tem: Em,\n\theading: Heading,\n\tiframe: IFrame,\n\tnoscript: NoScript,\n\toption: Option,\n\tq: Q,\n\tselect: Select,\n\tsource: Source,\n\ttitle: Title,\n\tvideo: Video,\n\ttbody: Tbody,\n\ttfoot: Tfoot,\n\tthead: Thead,\n\tsummary: Summary,\n\tdetails: Details,\n\tsub: Sub,\n\tsup: Sup,\n\tsvg: Svg,\n\tdata: Data,\n\ttime: Time,\n\ttemplate: Template\n};\n\nexport class Aurum {\n\tpublic static attach(aurumElementModel: AurumElementModel, dom: HTMLElement) {\n\t\tconst aurumElement = prerender(aurumElementModel);\n\t\tif (dom[ownerSymbol]) {\n\t\t\tthrow new Error('This node is already managed by aurum and cannot be used');\n\t\t}\n\n\t\tif (aurumElement instanceof AurumElement) {\n\t\t\tdom.appendChild(aurumElement.node);\n\t\t\taurumElement['handleAttach'](aurumElement);\n\t\t\tdom[ownerSymbol] = aurumElement;\n\t\t} else {\n\t\t\tthrow new Error('Root node of aurum application must be a single dom node');\n\t\t}\n\t}\n\n\tpublic static isAttached(dom: HTMLElement) {\n\t\treturn dom[ownerSymbol] !== undefined;\n\t}\n\n\tpublic static detach(domNode: HTMLElement): void {\n\t\tif (domNode[ownerSymbol]) {\n\t\t\tdomNode[ownerSymbol].node.remove();\n\t\t\tdomNode[ownerSymbol].handleDetach();\n\t\t\tdomNode[ownerSymbol] = undefined;\n\t\t}\n\t}\n\n\tpublic static factory(\n\t\tnode: string | Constructor<AurumElement> | ((...args: any[]) => AurumElement),\n\t\targs: MapLike<any>,\n\t\t...innerNodes: AurumElementModel[]\n\t): AurumElementModel {\n\t\tif (typeof node === 'string') {\n\t\t\tconst type = node;\n\t\t\tnode = nodeMap[node];\n\t\t\tif (node === undefined) {\n\t\t\t\tthrow new Error(`Node ${type} does not exist or is not supported`);\n\t\t\t}\n\t\t}\n\n\t\tif (Object.getPrototypeOf(node as Constructor<AurumElement>) === AurumElement) {\n\t\t\treturn {\n\t\t\t\t[aurumElementModelIdentitiy]: true,\n\t\t\t\t//@ts-ignore\n\t\t\t\tconstructor: (args, innerNodes) => new node(args, innerNodes),\n\t\t\t\tprops: args,\n\t\t\t\tinnerNodes: innerNodes\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\t[aurumElementModelIdentitiy]: true,\n\t\t\t\t//@ts-ignore\n\t\t\t\tconstructor: node,\n\t\t\t\tprops: args,\n\t\t\t\tinnerNodes: innerNodes\n\t\t\t};\n\t\t}\n\t}\n}\n\nexport namespace Aurum {\n\texport namespace JSX {\n\t\texport interface IntrinsicElements {\n\t\t\tbutton: ButtonProps;\n\t\t\tdiv: DivProps;\n\t\t\tinput: InputProps;\n\t\t\tli: LiProps;\n\t\t\tspan: SpanProps;\n\t\t\tstyle: StyleProps;\n\t\t\tul: UlProps;\n\t\t\tp: PProps;\n\t\t\timg: ImgProps;\n\t\t\tlink: LinkProps;\n\t\t\tcanvas: CanvasProps;\n\t\t\ta: AProps;\n\t\t\tarticle: AurumElementProps<HTMLElement>;\n\t\t\tbr: BrProps;\n\t\t\tform: FormProps;\n\t\t\tlabel: LabelProps;\n\t\t\tol: OlProps;\n\t\t\tpre: PreProps;\n\t\t\tprogress: ProgressProps;\n\t\t\ttable: TableProps;\n\t\t\ttd: TdProps;\n\t\t\ttr: TrProps;\n\t\t\tth: ThProps;\n\t\t\ttextarea: TextAreaProps;\n\t\t\th1: AurumElementProps<HTMLElement>;\n\t\t\th2: AurumElementProps<HTMLElement>;\n\t\t\th3: AurumElementProps<HTMLElement>;\n\t\t\th4: AurumElementProps<HTMLElement>;\n\t\t\th5: AurumElementProps<HTMLElement>;\n\t\t\th6: AurumElementProps<HTMLElement>;\n\t\t\theader: AurumElementProps<HTMLElement>;\n\t\t\tfooter: AurumElementProps<HTMLElement>;\n\t\t\tnav: AurumElementProps<HTMLElement>;\n\t\t\tb: AurumElementProps<HTMLElement>;\n\t\t\ti: AurumElementProps<HTMLElement>;\n\t\t\tscript: ScriptProps;\n\t\t\tabbr: AurumElementProps<HTMLElement>;\n\t\t\tarea: AreaProps;\n\t\t\taside: AurumElementProps<HTMLElement>;\n\t\t\taudio: AudioProps;\n\t\t\tem: AurumElementProps<HTMLElement>;\n\t\t\theading: HeadingProps;\n\t\t\tiframe: IFrameProps;\n\t\t\tnoscript: AurumElementProps<HTMLElement>;\n\t\t\toption: OptionProps;\n\t\t\tq: QProps;\n\t\t\tselect: SelectProps;\n\t\t\tsource: SourceProps;\n\t\t\ttitle: TitleProps;\n\t\t\tvideo: VideoProps;\n\t\t\ttbody: AurumElementProps<HTMLElement>;\n\t\t\ttfoot: AurumElementProps<HTMLElement>;\n\t\t\tthead: AurumElementProps<HTMLElement>;\n\t\t\tsummary: AurumElementProps<HTMLElement>;\n\t\t\tdetails: DetailsProps;\n\t\t\tsub: AurumElementProps<HTMLElement>;\n\t\t\tsup: AurumElementProps<HTMLElement>;\n\t\t\tsvg: SvgProps;\n\t\t\tdata: DataProps;\n\t\t\ttime: TimeProps;\n\t\t\tbody: BodyProps;\n\t\t\thead: HeadProps;\n\t\t\ttemplate: TemplateProps;\n\t\t}\n\t}\n}\n","import { ReadOnlyDataSource, DataSource } from '../stream/data_source';\nimport { DuplexDataSource } from '../stream/duplex_data_source';\nimport { CancellationToken } from './cancellation_token';\n\nexport function aurumClassName(\n\tdata: { [key: string]: boolean | ReadOnlyDataSource<boolean> },\n\tcancellationToken?: CancellationToken\n): Array<string | ReadOnlyDataSource<string>> {\n\tconst result = [];\n\tfor (const key in data) {\n\t\tif (data[key]) {\n\t\t\tif (data[key] instanceof DataSource || data[key] instanceof DuplexDataSource) {\n\t\t\t\tconst source = data[key] as ReadOnlyDataSource<boolean>;\n\t\t\t\tconst mappedSource = new DataSource<string>(source.value ? key : '');\n\t\t\t\tsource.listen((value) => {\n\t\t\t\t\tmappedSource.update(source.value ? key : '');\n\t\t\t\t}, cancellationToken);\n\n\t\t\t\tresult.push(mappedSource);\n\t\t\t} else {\n\t\t\t\tresult.push(key);\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n","export * from './nodes/special/aurum_element';\nexport * from './nodes/special/custom';\nexport * from './nodes/special/router';\nexport * from './nodes/special/suspense';\nexport * from './nodes/special/switch';\nexport * from './stream/data_source';\nexport * from './stream/duplex_data_source';\nexport * from './stream/object_data_source';\nexport * from './utilities/aurum';\nexport * from './utilities/cancellation_token';\nexport * from './utilities/classname';\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\n\n/**\n * @internal\n */\nexport class Address extends AurumElement {\n\tconstructor(props: AurumElementProps<HTMLElement>, children: ChildNode[]) {\n\t\tsuper(props, children, 'address');\n\t}\n}\n","import { AurumElement, AurumElementProps, ChildNode } from './special/aurum_element';\nimport { Callback } from '../utilities/common';\n\nexport interface HrProps extends AurumElementProps<HTMLHRElement> {\n\tonAttach?: Callback<HTMLHRElement>;\n\tonDetach?: Callback<HTMLHRElement>;\n\tonCreate?: Callback<HTMLHRElement>;\n}\n\n/**\n * @internal\n */\nexport class Hr extends AurumElement {\n\tpublic readonly node: HTMLHRElement;\n\n\tconstructor(props: HrProps, children: ChildNode[]) {\n\t\tsuper(props, children, 'hr');\n\t}\n}\n"]}